<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>OpenRHCE</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="header">
RHCE Preparation (RHEL6)
<hr class="header"/>
</div>
<div class="document" id="openrhce">
<h1 class="title">OpenRHCE</h1>
<h2 class="subtitle" id="a-creative-commons-courseware-for-rhce-preparation">A Creative Commons Courseware for RHCE Preparation</h2>

<!-- Sequence of section adornments: -->
<!-- ==- - -->
<!-- ==- -==- -__++~~^^ -->
<div class="section" id="course-outline">
<h1><a class="toc-backref" href="#id7">Course Outline</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#course-outline" id="id7">Course Outline</a></li>
<li><a class="reference internal" href="#session-one-introduction" id="id8">Session One: Introduction</a><ul>
<li><a class="reference internal" href="#introductions-your-instructor" id="id9">Introductions: Your Instructor</a></li>
<li><a class="reference internal" href="#id1" id="id10">Introductions: Your Instructor</a><ul>
<li><a class="reference internal" href="#qualifications" id="id11">Qualifications:</a></li>
<li><a class="reference internal" href="#personal" id="id12">Personal:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introductions-fellow-students" id="id13">Introductions: Fellow Students</a><ul>
<li><a class="reference internal" href="#please-introduce-yourselves" id="id14">Please Introduce Yourselves</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introductions-the-course" id="id15">Introductions: The Course</a><ul>
<li><a class="reference internal" href="#expectations" id="id16">Expectations</a></li>
<li><a class="reference internal" href="#preparation-recommendations" id="id17">Preparation Recommendations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#red-hat-enterprise-linux" id="id18">Red Hat Enterprise Linux</a></li>
<li><a class="reference internal" href="#the-red-hat-certification-landscape" id="id19">The Red Hat Certification Landscape</a></li>
<li><a class="reference internal" href="#rhcsa-objectives" id="id20">RHCSA Objectives</a><ul>
<li><a class="reference internal" href="#rhcsa-objectives-understand-use-essential-tools" id="id21">RHCSA Objectives: Understand &amp; Use Essential Tools</a></li>
<li><a class="reference internal" href="#rhcsa-essential-tools-cont" id="id22">RHCSA: ...Essential Tools... (cont)</a></li>
<li><a class="reference internal" href="#rhcsa-operate-running-systems" id="id23">RHCSA: Operate Running Systems</a></li>
<li><a class="reference internal" href="#rhcsa-configure-local-storage" id="id24">RHCSA: Configure Local Storage</a></li>
<li><a class="reference internal" href="#rhcsa-create-and-configure-file-systems" id="id25">RHCSA: Create and Configure File Systems</a></li>
<li><a class="reference internal" href="#rhcsa-deploy-configure-maintain" id="id26">RHCSA: Deploy, Configure &amp; Maintain</a></li>
<li><a class="reference internal" href="#rhcsa-manage-users-and-groups" id="id27">RHCSA: Manage Users and Groups</a></li>
<li><a class="reference internal" href="#rhcsa-manage-security" id="id28">RHCSA: Manage Security</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rhce-objectives" id="id29">RHCE Objectives</a><ul>
<li><a class="reference internal" href="#rhce-system-configuration-and-management" id="id30">RHCE: System Configuration and Management</a></li>
<li><a class="reference internal" href="#rhce-network-services" id="id31">RHCE: Network Services</a></li>
<li><a class="reference internal" href="#rhce-http-https" id="id32">RHCE: HTTP/HTTPS</a></li>
<li><a class="reference internal" href="#rhce-dns" id="id33">RHCE: DNS</a></li>
<li><a class="reference internal" href="#rhce-ftp" id="id34">RHCE: FTP</a></li>
<li><a class="reference internal" href="#rhce-nfs" id="id35">RHCE: NFS</a></li>
<li><a class="reference internal" href="#rhce-smb" id="id36">RHCE: SMB</a></li>
<li><a class="reference internal" href="#rhce-smtp" id="id37">RHCE: SMTP</a></li>
<li><a class="reference internal" href="#rhce-ssh" id="id38">RHCE: SSH</a></li>
<li><a class="reference internal" href="#rhce-ntp" id="id39">RHCE: NTP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#boot-reboot-shutdown" id="id40">Boot, Reboot, Shutdown</a></li>
<li><a class="reference internal" href="#runlevels" id="id41">Runlevels</a></li>
<li><a class="reference internal" href="#single-user-mode" id="id42">Single User Mode</a></li>
<li><a class="reference internal" href="#log-files" id="id43">Log Files</a></li>
<li><a class="reference internal" href="#start-stop-virtual-machines" id="id44">Start/Stop Virtual Machines</a></li>
<li><a class="reference internal" href="#virtual-machine-consoles" id="id45">Virtual Machine Consoles</a></li>
<li><a class="reference internal" href="#virtual-machine-text-console" id="id46">Virtual Machine Text Console</a></li>
<li><a class="reference internal" href="#virtual-machine-text-console-caveat" id="id47">Virtual Machine Text Console Caveat</a></li>
<li><a class="reference internal" href="#start-stop-and-check-the-status-of-network-services" id="id48">Start, stop, and check the status of network services</a></li>
<li><a class="reference internal" href="#modify-the-system-bootloader" id="id49">Modify the system bootloader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-2-storage-and-filesystems" id="id50">Session 2 Storage and filesystems</a><ul>
<li><a class="reference internal" href="#filesystem-disambiguation" id="id51">&quot;Filesystem&quot; - Disambiguation</a></li>
<li><a class="reference internal" href="#linux-filesystem-hierarchy" id="id52">Linux Filesystem Hierarchy</a></li>
<li><a class="reference internal" href="#disk-and-filesystem-tools" id="id53">Disk and Filesystem tools</a></li>
<li><a class="reference internal" href="#working-with-partitions" id="id54">Working with Partitions</a></li>
<li><a class="reference internal" href="#working-with-logical-volume-management" id="id55">Working with Logical Volume Management</a></li>
<li><a class="reference internal" href="#removing-logical-volume-structures" id="id56">Removing Logical Volume structures</a></li>
<li><a class="reference internal" href="#commands-to-know" id="id57">Commands to Know</a></li>
<li><a class="reference internal" href="#working-with-luks-encrypted-storage" id="id58">Working with LUKS encrypted storage</a></li>
<li><a class="reference internal" href="#persistent-mounting-of-luks-devices" id="id59">Persistent mounting of LUKS devices</a></li>
<li><a class="reference internal" href="#working-with-swap" id="id60">Working with SWAP</a></li>
<li><a class="reference internal" href="#using-a-file-for-swap" id="id61">Using a file for SWAP</a></li>
<li><a class="reference internal" href="#mounting-using-uuids-and-filesystem-labels" id="id62">Mounting Using UUIDs and Filesystem Labels</a></li>
<li><a class="reference internal" href="#local-storage-adding-new-storage" id="id63">Local Storage: Adding New Storage</a></li>
<li><a class="reference internal" href="#file-systems-working-with-common-linux-filesystems" id="id64">File systems: Working with Common Linux Filesystems</a></li>
<li><a class="reference internal" href="#filesystem-permissions-basic-permissions" id="id65">Filesystem Permissions: Basic Permissions</a></li>
<li><a class="reference internal" href="#three-sets-of-permissions" id="id66">Three Sets of Permissions:</a></li>
<li><a class="reference internal" href="#three-types-of-permissions" id="id67">Three Types of Permissions:</a></li>
<li><a class="reference internal" href="#three-extended-attributes" id="id68">Three Extended Attributes:</a></li>
<li><a class="reference internal" href="#viewing-permissions" id="id69">Viewing Permissions</a></li>
<li><a class="reference internal" href="#setting-permissions" id="id70">Setting Permissions</a></li>
<li><a class="reference internal" href="#setting-permissions-with-numeric-options" id="id71">Setting Permissions with Numeric Options</a></li>
<li><a class="reference internal" href="#setting-extended-attributes-with-numeric-options" id="id72">Setting Extended Attributes with Numeric Options</a></li>
<li><a class="reference internal" href="#setting-extended-attributes-with-symbolic-values" id="id73">Setting Extended Attributes with Symbolic Values:</a></li>
<li><a class="reference internal" href="#extended-attributes-in-directory-listings" id="id74">Extended Attributes in Directory Listings</a></li>
<li><a class="reference internal" href="#umask" id="id75">Umask</a></li>
<li><a class="reference internal" href="#umask-examples" id="id76">Umask Examples</a></li>
<li><a class="reference internal" href="#sgid-and-stickybit-use-case-collaborative-directories" id="id77">SGID and Stickybit Use Case -- Collaborative Directories</a></li>
<li><a class="reference internal" href="#file-access-control-lists" id="id78">File Access Control Lists</a></li>
<li><a class="reference internal" href="#getfacl" id="id79">getfacl</a></li>
<li><a class="reference internal" href="#working-with-cifs-network-file-systems" id="id80">Working with CIFS network file systems</a></li>
<li><a class="reference internal" href="#working-with-nfs-file-systems" id="id81">Working with NFS file systems</a></li>
<li><a class="reference internal" href="#iscsi-devices" id="id82">iSCSI Devices</a></li>
<li><a class="reference internal" href="#accessing-iscsi-devices" id="id83">Accessing iSCSI Devices</a></li>
<li><a class="reference internal" href="#disconnecting-from-iscsi-devices" id="id84">Disconnecting from iSCSI Devices</a></li>
<li><a class="reference internal" href="#additional-references" id="id85">Additional References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-3-managing-software-processes-kernel-attributes-and-users-and-groups" id="id86">Session 3 Managing software, processes, kernel attributes, and users and groups</a><ul>
<li><a class="reference internal" href="#the-red-hat-network-rhn" id="id87">The Red Hat Network (RHN)</a></li>
<li><a class="reference internal" href="#rhn-subscription-activation" id="id88">RHN Subscription Activation</a></li>
<li><a class="reference internal" href="#rd-party-yum-repositories" id="id89">3rd Party Yum Repositories</a></li>
<li><a class="reference internal" href="#yum-repository-mandatory-configuration-items" id="id90">Yum Repository Mandatory Configuration Items</a></li>
<li><a class="reference internal" href="#yum-repository-common-optional-configuration-items" id="id91">Yum Repository Common Optional Configuration Items</a></li>
<li><a class="reference internal" href="#managing-software-using-yum" id="id92">Managing Software: Using yum</a></li>
<li><a class="reference internal" href="#yum-related-man-pages" id="id93">Yum-related man pages</a></li>
<li><a class="reference internal" href="#rpm-architecture" id="id94">RPM Architecture</a></li>
<li><a class="reference internal" href="#rpm-package-naming" id="id95">RPM Package Naming</a></li>
<li><a class="reference internal" href="#package-naming-example" id="id96">Package Naming Example</a></li>
<li><a class="reference internal" href="#installing-and-upgrading-packages" id="id97">Installing and Upgrading Packages</a></li>
<li><a class="reference internal" href="#upgrading-a-kernel" id="id98">Upgrading a Kernel</a></li>
<li><a class="reference internal" href="#rpm-and-modified-config-files" id="id99">RPM and Modified Config Files</a></li>
<li><a class="reference internal" href="#uninstalling" id="id100">Uninstalling</a></li>
<li><a class="reference internal" href="#rpm-over-a-network" id="id101">RPM over a Network</a></li>
<li><a class="reference internal" href="#common-rpm-queries" id="id102">Common RPM Queries</a></li>
<li><a class="reference internal" href="#rpm-verification" id="id103">RPM Verification</a></li>
<li><a class="reference internal" href="#validate-package-signatures" id="id104">Validate Package Signatures</a></li>
<li><a class="reference internal" href="#rpm-checksig-sample-output" id="id105">RPM Checksig Sample Output</a></li>
<li><a class="reference internal" href="#verify-installed-files" id="id106">Verify Installed Files</a></li>
<li><a class="reference internal" href="#change-codes-from-rpm-verify" id="id107">Change Codes from rpm --verify</a></li>
<li><a class="reference internal" href="#rpm-verify-sample-output" id="id108">RPM Verify Sample Output</a></li>
<li><a class="reference internal" href="#identifying-installed-packages" id="id109">Identifying Installed Packages</a></li>
<li><a class="reference internal" href="#managing-software-building-rpms" id="id110">Managing Software:  Building RPMs</a></li>
<li><a class="reference internal" href="#inside-an-rpm-package" id="id111">Inside an RPM package</a></li>
<li><a class="reference internal" href="#main-contents-of-a-spec-file" id="id112">Main contents of a .spec file</a></li>
<li><a class="reference internal" href="#preamble-directives" id="id113">Preamble directives</a></li>
<li><a class="reference internal" href="#required-spec-file-sections" id="id114">Required Spec file sections</a></li>
<li><a class="reference internal" href="#package-building-tools" id="id115">Package Building Tools</a></li>
<li><a class="reference internal" href="#setting-up-a-build-environment" id="id116">Setting up a Build Environment</a></li>
<li><a class="reference internal" href="#viewing-the-build-environment" id="id117">Viewing the Build Environment</a></li>
<li><a class="reference internal" href="#building-the-rpm" id="id118">Building the RPM</a></li>
<li><a class="reference internal" href="#rpm-building-exercise" id="id119">RPM Building Exercise</a></li>
<li><a class="reference internal" href="#signing-your-rpms" id="id120">Signing Your RPMs</a></li>
<li><a class="reference internal" href="#create-a-repo-with-your-files" id="id121">Create a Repo with your files</a></li>
<li><a class="reference internal" href="#rpm-packaging-other-documentation" id="id122">RPM Packaging, Other Documentation:</a></li>
<li><a class="reference internal" href="#manage-processes-and-services" id="id123">Manage Processes and Services</a></li>
<li><a class="reference internal" href="#persistent-configuration-of-services" id="id124">Persistent Configuration of Services</a></li>
<li><a class="reference internal" href="#manage-processes-and-services-configure-systems-to-boot-into-a-specific-runlevel-automatically" id="id125">Manage Processes and Services: Configure systems to boot into a specific runlevel automatically</a></li>
<li><a class="reference internal" href="#monitoring-processes" id="id126">Monitoring Processes</a></li>
<li><a class="reference internal" href="#killing-processes" id="id127">Killing Processes</a></li>
<li><a class="reference internal" href="#prioritizing-processes" id="id128">Prioritizing Processes</a></li>
<li><a class="reference internal" href="#nice-and-renice-commands" id="id129"><tt class="docutils literal"><span class="pre">nice</span></tt> and <tt class="docutils literal"><span class="pre">renice</span></tt> commands</a></li>
<li><a class="reference internal" href="#manage-system-performance" id="id130">Manage system performance</a></li>
<li><a class="reference internal" href="#manage-users-and-groups" id="id131">Manage Users and Groups</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-4-networking-and-routing" id="id132">Session 4 Networking and Routing</a><ul>
<li><a class="reference internal" href="#network-configuration-and-troubleshooting" id="id133">Network Configuration and Troubleshooting</a></li>
<li><a class="reference internal" href="#ip-address-and-subnet-mask" id="id134">IP Address and Subnet Mask</a></li>
<li><a class="reference internal" href="#routing-and-default-gateway" id="id135">Routing and Default Gateway</a></li>
<li><a class="reference internal" href="#hostname" id="id136">Hostname</a></li>
<li><a class="reference internal" href="#name-resolution" id="id137">Name Resolution</a></li>
<li><a class="reference internal" href="#two-controlling-services" id="id138">Two Controlling Services</a></li>
<li><a class="reference internal" href="#switching-between-controlling-services" id="id139">Switching between Controlling Services</a></li>
<li><a class="reference internal" href="#network-configuration-files" id="id140">Network Configuration Files</a></li>
<li><a class="reference internal" href="#reference" id="id141">Reference</a></li>
<li><a class="reference internal" href="#future-near-network-device-naming-scheme" id="id142">Future (Near!) Network Device Naming Scheme</a></li>
<li><a class="reference internal" href="#troubleshooting-toolkit" id="id143">Troubleshooting Toolkit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-5-firewalls-and-selinux" id="id144">Session 5 Firewalls and SELinux</a><ul>
<li><a class="reference internal" href="#firewalling-in-rhel6" id="id145">Firewalling in RHEL6</a></li>
<li><a class="reference internal" href="#iptables-built-in-chains" id="id146">iptables Built-in Chains</a></li>
<li><a class="reference internal" href="#iptables-targets" id="id147">iptables Targets</a></li>
<li><a class="reference internal" href="#connection-tracking-states" id="id148">Connection Tracking States</a></li>
<li><a class="reference internal" href="#iptables-command-options" id="id149">Iptables Command Options</a></li>
<li><a class="reference internal" href="#matching-packets" id="id150">Matching packets</a></li>
<li><a class="reference internal" href="#iptables-tips" id="id151">Iptables Tips</a></li>
<li><a class="reference internal" href="#selinux" id="id152">SELinux</a></li>
<li><a class="reference internal" href="#selinux-in-action" id="id153">SELinux in Action</a></li>
<li><a class="reference internal" href="#selinux-enforcement-modes" id="id154">SELinux Enforcement Modes</a></li>
<li><a class="reference internal" href="#important-selinux-filesystem-locations" id="id155">Important SELinux Filesystem locations</a></li>
<li><a class="reference internal" href="#related-packages" id="id156">Related Packages</a></li>
<li><a class="reference internal" href="#useful-commands" id="id157">Useful Commands</a></li>
<li><a class="reference internal" href="#additional-documentation" id="id158">Additional Documentation</a></li>
<li><a class="reference internal" href="#setting-the-selinux-enforcement-mode" id="id159">Setting the SELinux Enforcement Mode</a></li>
<li><a class="reference internal" href="#selinux-policy-types" id="id160">SELinux Policy Types</a></li>
<li><a class="reference internal" href="#selinux-contexts" id="id161">SELinux Contexts</a></li>
<li><a class="reference internal" href="#setting-selinux-file-contexts" id="id162">Setting SELinux file contexts</a></li>
<li><a class="reference internal" href="#selinux-booleans" id="id163">SELinux Booleans</a></li>
<li><a class="reference internal" href="#modifying-selinux-booleans" id="id164">Modifying SELinux Booleans</a></li>
<li><a class="reference internal" href="#help-for-selinux-with-regard-to-specific-services" id="id165">Help for SELinux with regard to specific services</a></li>
<li><a class="reference internal" href="#monitor-selinux-violations" id="id166">Monitor SELinux Violations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-6-virtualization" id="id167">Session 6 Virtualization</a><ul>
<li><a class="reference internal" href="#virtualization-terms" id="id168">Virtualization Terms</a></li>
<li><a class="reference internal" href="#rhel6-kvm-requirements" id="id169">RHEL6 KVM requirements</a></li>
<li><a class="reference internal" href="#kvm-virtualization-components" id="id170">KVM Virtualization Components</a></li>
<li><a class="reference internal" href="#installing-virtualization-capabilities" id="id171">Installing Virtualization Capabilities</a></li>
<li><a class="reference internal" href="#virsh-commands" id="id172">Virsh Commands</a></li>
<li><a class="reference internal" href="#creating-virtual-machines-with-virt-manager" id="id173">Creating Virtual Machines with Virt-Manager</a></li>
<li><a class="reference internal" href="#creating-virtual-machines-with-virt-install" id="id174">Creating Virtual Machines with virt-install</a></li>
<li><a class="reference internal" href="#selinux-considerations" id="id175">SELinux considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-7-logging-and-remote-access" id="id176">Session 7 Logging and remote access</a><ul>
<li><a class="reference internal" href="#rhel-6-logging-with-rsyslog" id="id177">RHEL 6 Logging with Rsyslog</a></li>
<li><a class="reference internal" href="#accepting-remote-logs" id="id178">Accepting Remote Logs</a></li>
<li><a class="reference internal" href="#rsyslog-configuration-message-selection" id="id179">Rsyslog Configuration: Message Selection</a></li>
<li><a class="reference internal" href="#rsyslog-configuration-actions" id="id180">Rsyslog Configuration: Actions</a></li>
<li><a class="reference internal" href="#practice" id="id181">Practice</a></li>
<li><a class="reference internal" href="#remote-access-via-ssh" id="id182">Remote Access via SSH</a></li>
<li><a class="reference internal" href="#investigate-selinux-implications-for-ssh" id="id183">Investigate SELinux implications for SSH</a></li>
<li><a class="reference internal" href="#ssh-key-based-authentication" id="id184">SSH key-based authentication</a></li>
<li><a class="reference internal" href="#ssh-security-considerations" id="id185">SSH Security Considerations</a></li>
<li><a class="reference internal" href="#remote-access-via-vnc" id="id186">Remote Access via VNC</a></li>
<li><a class="reference internal" href="#configuring-a-vnc-remote-display" id="id187">Configuring a VNC remote display</a></li>
<li><a class="reference internal" href="#investigate-selinux-implications-for-vnc" id="id188">Investigate SELinux implications for VNC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-8-network-time-protocol-and-system-performance-reports" id="id189">Session 8 Network Time Protocol and System Performance Reports</a><ul>
<li><a class="reference internal" href="#ntp-overview" id="id190">NTP Overview</a></li>
<li><a class="reference internal" href="#ntp-packages" id="id191">NTP Packages</a></li>
<li><a class="reference internal" href="#ntp-documentation" id="id192">NTP Documentation</a></li>
<li><a class="reference internal" href="#installing-starting-and-configuring-persistence" id="id193">Installing, Starting, and Configuring Persistence</a></li>
<li><a class="reference internal" href="#defining-ntp-terms" id="id194">Defining NTP Terms</a></li>
<li><a class="reference internal" href="#configuration-of-ntp" id="id195">Configuration of NTP</a></li>
<li><a class="reference internal" href="#ntp-restrict-options" id="id196">NTP &quot;restrict&quot; options</a></li>
<li><a class="reference internal" href="#configure-as-a-client" id="id197">Configure as a Client</a></li>
<li><a class="reference internal" href="#configure-as-a-server" id="id198">Configure as a Server</a></li>
<li><a class="reference internal" href="#configure-as-a-peer" id="id199">Configure as a Peer</a></li>
<li><a class="reference internal" href="#investigate-selinux-implications-for-ntp" id="id200">Investigate SELinux implications for NTP</a></li>
<li><a class="reference internal" href="#investigate-firewall-implications-for-ntp" id="id201">Investigate Firewall Implications for NTP</a></li>
<li><a class="reference internal" href="#reporting-on-system-performance" id="id202">Reporting on System Performance</a></li>
<li><a class="reference internal" href="#tools-for-system-utilization-reporting" id="id203">Tools for System Utilization Reporting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-9-http-and-ftp" id="id204">Session 9 HTTP and FTP</a><ul>
<li><a class="reference internal" href="#apache-web-server" id="id205">Apache Web Server</a></li>
<li><a class="reference internal" href="#installation-and-basic-configuration" id="id206">Installation and Basic Configuration</a></li>
<li><a class="reference internal" href="#installing-a-signed-ssl-certificate" id="id207">Installing a Signed SSL Certificate</a></li>
<li><a class="reference internal" href="#virtual-host-configuration" id="id208">Virtual Host Configuration</a></li>
<li><a class="reference internal" href="#name-virtual-host-configuration" id="id209">Name Virtual Host Configuration</a></li>
<li><a class="reference internal" href="#example-virtual-host-configuration" id="id210">Example Virtual Host Configuration</a></li>
<li><a class="reference internal" href="#configuring-for-cgi-bin-scripts" id="id211">Configuring for CGI-BIN scripts</a></li>
<li><a class="reference internal" href="#apache-access-control" id="id212">Apache Access Control</a></li>
<li><a class="reference internal" href="#host-based-security-directive-formats" id="id213">Host Based Security directive formats</a></li>
<li><a class="reference internal" href="#access-control-with-htaccess-files" id="id214">Access Control with .htaccess files</a></li>
<li><a class="reference internal" href="#user-based-security-with-htpasswd-flat-file" id="id215">User Based Security with htpasswd flat file</a></li>
<li><a class="reference internal" href="#configuring-passwords" id="id216">Configuring Passwords</a></li>
<li><a class="reference internal" href="#user-based-security-with-ldap-authentication" id="id217">User Based Security with LDAP authentication</a></li>
<li><a class="reference internal" href="#selinux-implications-for-http" id="id218">SELinux Implications for HTTP</a></li>
<li><a class="reference internal" href="#important-selinux-contexts" id="id219">Important SELinux Contexts</a></li>
<li><a class="reference internal" href="#firewall-and-selinux-for-httpd" id="id220">Firewall and SELinux for httpd</a></li>
<li><a class="reference internal" href="#very-secure-file-transfer-protocol-daemon" id="id221">Very Secure File Transfer Protocol Daemon</a></li>
<li><a class="reference internal" href="#id2" id="id222">Installation and Basic Configuration</a></li>
<li><a class="reference internal" href="#ftp-documentation" id="id223">FTP Documentation</a></li>
<li><a class="reference internal" href="#investigate-selinux-implications-for-ftp" id="id224">Investigate SELinux implications for FTP</a></li>
<li><a class="reference internal" href="#investigate-firewall-implications-for-ftp" id="id225">Investigate Firewall Implications for FTP</a></li>
<li><a class="reference internal" href="#configuring-a-secure-drop-box-for-anon-upload" id="id226">Configuring a Secure &quot;Drop-box&quot; for Anon Upload</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-10-nfs-and-samba" id="id227">Session 10 NFS and Samba</a><ul>
<li><a class="reference internal" href="#network-file-system-nfs" id="id228">Network File System (NFS)</a></li>
<li><a class="reference internal" href="#packages" id="id229">Packages</a></li>
<li><a class="reference internal" href="#configuration" id="id230">Configuration</a></li>
<li><a class="reference internal" href="#configuring-an-nfs-server-network-file-system" id="id231">Configuring an NFS server (Network File System)</a></li>
<li><a class="reference internal" href="#etc-exports" id="id232">/etc/exports</a></li>
<li><a class="reference internal" href="#commands" id="id233">Commands</a></li>
<li><a class="reference internal" href="#id3" id="id234">SELinux</a></li>
<li><a class="reference internal" href="#mounting" id="id235">Mounting</a></li>
<li><a class="reference internal" href="#automounter" id="id236">Automounter</a></li>
<li><a class="reference internal" href="#auto-master" id="id237">Auto.master</a></li>
<li><a class="reference internal" href="#auto" id="id238">Auto.*</a></li>
<li><a class="reference internal" href="#understanding-automount" id="id239">Understanding Automount</a></li>
<li><a class="reference internal" href="#samba" id="id240">Samba</a></li>
<li><a class="reference internal" href="#accessing-smb-cifs-shares" id="id241">Accessing SMB/CIFS Shares</a></li>
<li><a class="reference internal" href="#samba-packages" id="id242">Samba Packages:</a></li>
<li><a class="reference internal" href="#id4" id="id243">SELinux</a></li>
<li><a class="reference internal" href="#services" id="id244">Services</a></li>
<li><a class="reference internal" href="#etc-samba-smb-conf-global" id="id245">/etc/samba/smb.conf (Global)</a></li>
<li><a class="reference internal" href="#etc-samba-smb-conf-security-types" id="id246">/etc/samba/smb.conf Security Types</a></li>
<li><a class="reference internal" href="#samba-users-and-passwords" id="id247">Samba Users and Passwords</a></li>
<li><a class="reference internal" href="#etc-samba-smb-conf-shares" id="id248">/etc/samba/smb.conf (Shares)</a></li>
<li><a class="reference internal" href="#testing-configuration" id="id249">Testing Configuration</a></li>
<li><a class="reference internal" href="#samba-firewalling-considerations" id="id250">Samba Firewalling Considerations</a></li>
<li><a class="reference internal" href="#howto-enable-home-directory-sharing-via-samba" id="id251">HowTo: Enable Home Directory sharing via Samba</a></li>
<li><a class="reference internal" href="#howto-configure-a-group-share" id="id252">HowTo: Configure a Group Share</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-11-dns-and-smtp" id="id253">Session 11 DNS and SMTP</a><ul>
<li><a class="reference internal" href="#types-of-dns-servers" id="id254">Types of DNS servers</a></li>
<li><a class="reference internal" href="#installing-and-enabling-bind" id="id255">Installing and enabling Bind</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-12-finish-uncompleted-topics-review-or-practice-exam" id="id256">Session 12 Finish uncompleted topics, Review, or Practice Exam</a></li>
<li><a class="reference internal" href="#supplemental-topics" id="id257">Supplemental Topics</a><ul>
<li><a class="reference internal" href="#manage-processes-and-services-schedule-tasks-using-cron" id="id258">Manage Processes and Services: Schedule tasks using cron</a></li>
<li><a class="reference internal" href="#cron" id="id259">Cron</a></li>
<li><a class="reference internal" href="#format-of-a-crontab-file" id="id260">Format of a crontab file</a></li>
<li><a class="reference internal" href="#controlling-cron" id="id261">Controlling Cron</a></li>
<li><a class="reference internal" href="#at-jobs" id="id262">at Jobs</a></li>
<li><a class="reference internal" href="#securing-cron-and-at" id="id263">Securing cron and at</a></li>
<li><a class="reference internal" href="#user-admin-with-config-files" id="id264">User Admin with Config Files</a></li>
<li><a class="reference internal" href="#structure-of-etc-passwd" id="id265">Structure of /etc/passwd</a></li>
<li><a class="reference internal" href="#structure-of-etc-shadow" id="id266">Structure of /etc/shadow</a><ul>
<li><a class="reference internal" href="#sample-contents" id="id267">Sample Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#structure-of-etc-group" id="id268">Structure of /etc/group</a><ul>
<li><a class="reference internal" href="#id5" id="id269">Sample Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#structure-of-etc-gshadow" id="id270">Structure of /etc/gshadow</a><ul>
<li><a class="reference internal" href="#id6" id="id271">Sample Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-admin-with-cli-tools" id="id272">User Admin with CLI tools</a></li>
<li><a class="reference internal" href="#user-admin-with-gui-tools" id="id273">User Admin with GUI tools</a></li>
<li><a class="reference internal" href="#user-environment" id="id274">User environment</a><ul>
<li><a class="reference internal" href="#common-contents" id="id275">Common Contents:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#system-wide-shell-config-files" id="id276">System-wide Shell Config Files</a></li>
<li><a class="reference internal" href="#user-configurable-environment-files" id="id277">User-configurable Environment Files</a></li>
<li><a class="reference internal" href="#cups-printing-system" id="id278">CUPS Printing System</a></li>
<li><a class="reference internal" href="#controlling-jobs-from-the-command-line" id="id279">Controlling Jobs from the Command Line</a></li>
<li><a class="reference internal" href="#cups-web-based-interface" id="id280">CUPS Web-Based Interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting" id="id281">Troubleshooting</a><ul>
<li><a class="reference internal" href="#booting" id="id282">Booting</a></li>
<li><a class="reference internal" href="#booting-mbr" id="id283">Booting - (MBR)</a></li>
<li><a class="reference internal" href="#booting-grub-stage-1-5-driver-to-read-filesystem" id="id284">Booting - GRUB Stage 1.5 (Driver to read filesystem)</a></li>
<li><a class="reference internal" href="#booting-grub-stage-2-menu" id="id285">Booting - GRUB Stage 2 (Menu)</a></li>
<li><a class="reference internal" href="#booting-kernel" id="id286">Booting - Kernel</a></li>
<li><a class="reference internal" href="#booting-initrd-initial-ramdisk" id="id287">Booting - initrd (initial ramdisk)</a></li>
<li><a class="reference internal" href="#booting-init-process" id="id288">Booting - init process</a></li>
<li><a class="reference internal" href="#booting-inittab" id="id289">Booting - inittab</a></li>
<li><a class="reference internal" href="#booting-rc-sysinit" id="id290">Booting - rc.sysinit</a></li>
<li><a class="reference internal" href="#booting-services" id="id291">Booting - services</a></li>
<li><a class="reference internal" href="#networking" id="id292">Networking</a></li>
<li><a class="reference internal" href="#x" id="id293">X</a></li>
<li><a class="reference internal" href="#tcp-wrappers" id="id294">TCP_Wrappers</a></li>
<li><a class="reference internal" href="#which-services-are-protected" id="id295">Which Services are Protected?</a></li>
<li><a class="reference internal" href="#indentifying-protected-services" id="id296">Indentifying Protected Services</a></li>
<li><a class="reference internal" href="#hosts-access-files-syntax" id="id297">Hosts Access Files Syntax</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="session-one-introduction">
<h1><a class="toc-backref" href="#id8">Session One: Introduction</a></h1>
<div class="section" id="introductions-your-instructor">
<h2><a class="toc-backref" href="#id9">Introductions: Your Instructor</a></h2>
<p>Scott Purcell</p>
<p><a class="reference external" href="mailto:scott&#64;texastwister.info">scott&#64;texastwister.info</a></p>
<p><a class="reference external" href="http://www.linkedin.com/in/scottpurcell">http://www.linkedin.com/in/scottpurcell</a></p>
<p><a class="reference external" href="http://twitter.com/texastwister">http://twitter.com/texastwister</a></p>
<p><a class="reference external" href="http://www.facebook.com/Scott.L.Purcell">http://www.facebook.com/Scott.L.Purcell</a></p>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id10">Introductions: Your Instructor</a></h2>
<div class="section" id="qualifications">
<h3><a class="toc-backref" href="#id11">Qualifications:</a></h3>
<ul class="simple">
<li>RHCSA, RHCE #110-008-877 (RHEL6)</li>
<li>Also: CTT+, CLA, CLP, CNI, LPIC1, Linux+</li>
<li>Curriculum Developer and Trainer for a major computer manufacturer for going on 11 years</li>
<li>Linux Enthusiast since 2000</li>
</ul>
</div>
<div class="section" id="personal">
<h3><a class="toc-backref" href="#id12">Personal:</a></h3>
<ul class="simple">
<li>Husband, father, disciple and</li>
<li>Fun: Part-time Balloon Entertainer</li>
</ul>
</div>
</div>
<div class="section" id="introductions-fellow-students">
<h2><a class="toc-backref" href="#id13">Introductions: Fellow Students</a></h2>
<div class="section" id="please-introduce-yourselves">
<h3><a class="toc-backref" href="#id14">Please Introduce Yourselves</a></h3>
<ul class="simple">
<li>Name</li>
<li>Where you work or what you do.</li>
<li>What Linux experience do you already have?</li>
<li>What goals do you have for this class?</li>
<li>Something fun about yourself.</li>
</ul>
</div>
</div>
<div class="section" id="introductions-the-course">
<h2><a class="toc-backref" href="#id15">Introductions: The Course</a></h2>
<div class="section" id="expectations">
<h3><a class="toc-backref" href="#id16">Expectations</a></h3>
<ul>
<li><p class="first">Should I be able to pass the RHCE on this class alone?</p>
<blockquote>
<p>A stunning number of seasoned professionals taking Red Hat's own prep courses fail to pass on first attempt.</p>
</blockquote>
</li>
<li><p class="first">Planning for more than one attempt is prudent.</p>
</li>
<li><p class="first">Maximizing your out-of-class preparation time is prudent.</p>
</li>
</ul>
</div>
<div class="section" id="preparation-recommendations">
<h3><a class="toc-backref" href="#id17">Preparation Recommendations</a></h3>
<ul>
<li><p class="first">Practice/Study Environment</p>
<blockquote>
<ul>
<li><p class="first">2 or 3 systems or VMs, networked together.  Virtualized hosting providers may be an alternative.</p>
</li>
<li><p class="first">RHEL 6 (eval), CENTOS 6 (when available), or Fedora (Fedora 13 will be closest to RHEL 6)</p>
</li>
<li><p class="first">Red Hat docs at:</p>
<blockquote>
<p><a class="reference external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/index.html">http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/index.html</a></p>
</blockquote>
</li>
<li><p class="first">RHCE Objectives and other information at:</p>
<blockquote>
<p><a class="reference external" href="http://www.redhat.com/certification/">http://www.redhat.com/certification/</a></p>
</blockquote>
</li>
<li><p class="first">Take initiative -- form a study group.</p>
</li>
<li><p class="first">Practice, practice, practice!</p>
</li>
</ul>
</blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="red-hat-enterprise-linux">
<h2><a class="toc-backref" href="#id18">Red Hat Enterprise Linux</a></h2>
<ul class="simple">
<li>Overview</li>
<li>Server and Desktop variants</li>
<li>Add-on Functionality</li>
<li>LifeCycle</li>
</ul>
</div>
<div class="section" id="the-red-hat-certification-landscape">
<h2><a class="toc-backref" href="#id19">The Red Hat Certification Landscape</a></h2>
<ul>
<li><p class="first">RHCSA</p>
<blockquote>
<p>RHCSA is new, replacing the RHCT.  It is the &quot;core&quot; sysadmin certification from Red Hat. To earn RHCE and other system administration certs will require first earning the RHCSA.</p>
</blockquote>
</li>
<li><p class="first">RHCE</p>
<blockquote>
<p>RHCE is a senior system administration certification. It is an eligibility requirement for taking any COE exams and is thus a requirement for the upper-level credentials as well.</p>
</blockquote>
</li>
<li><p class="first">Certificates of Expertise</p>
<blockquote>
<p>COEs are incremental credentials demonstrating skills and knowledge in specialized areas. They are worthy credentials in their own right, but also the building blocks of the upper level credentials.</p>
</blockquote>
</li>
<li><p class="first">RHCSS, RHCDS, RHCA</p>
<blockquote>
<p>These upper level credentials recognize those who have achieved expertise in several related specialized areas.  Each one requires multiple COEs.</p>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="rhcsa-objectives">
<h2><a class="toc-backref" href="#id20">RHCSA Objectives</a></h2>
<div class="section" id="rhcsa-objectives-understand-use-essential-tools">
<h3><a class="toc-backref" href="#id21">RHCSA Objectives: Understand &amp; Use Essential Tools</a></h3>
<blockquote>
<ul class="simple">
<li>Access a shell prompt and issue commands with correct syntax</li>
<li>Use input-output redirection (&gt;, &gt;&gt;, <tt class="docutils literal"><span class="pre">|</span></tt>, 2&gt;, etc.)</li>
<li>Use grep and regular expressions to analyze text</li>
<li>Access remote systems using ssh and VNC</li>
<li>Log in and switch users in multi-user runlevels</li>
<li>Archive, compress, unpack and uncompress files using tar, star, gzip, and bzip2</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-essential-tools-cont">
<h3><a class="toc-backref" href="#id22">RHCSA: ...Essential Tools... (cont)</a></h3>
<blockquote>
<ul>
<li><p class="first">Create and edit text files</p>
</li>
<li><p class="first">Create, delete, copy and move files and directories</p>
</li>
<li><p class="first">Create hard and soft links</p>
</li>
<li><p class="first">List, set and change standard ugo/rwx permissions</p>
</li>
<li><p class="first">Locate, read and use system documentation including man, info, and files in /usr/share/doc .</p>
<blockquote>
<p>[Note: Red Hat may use applications during the exam that are not included in Red Hat Enterprise Linux for the purpose of evaluating candidate's abilities to meet this objective.]</p>
</blockquote>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-operate-running-systems">
<h3><a class="toc-backref" href="#id23">RHCSA: Operate Running Systems</a></h3>
<blockquote>
<ul class="simple">
<li>Boot, reboot, and shut down a system normally</li>
<li>Boot systems into different runlevels manually</li>
<li>Use single-user mode to gain access to a system</li>
<li>Identify CPU/memory intensive processes, adjust process priority with renice, and kill processes</li>
<li>Locate and interpret system log files</li>
<li>Access a virtual machine's console</li>
<li>Start and stop virtual machines</li>
<li>Start, stop and check the status of network services</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-configure-local-storage">
<h3><a class="toc-backref" href="#id24">RHCSA: Configure Local Storage</a></h3>
<blockquote>
<ul class="simple">
<li>List, create, delete and set partition type for primary, extended, and logical partitions</li>
<li>Create and remove physical volumes, assign physical volumes to volume groups, create and delete logical volumes</li>
<li>Create and configure LUKS-encrypted partitions and logical volumes to prompt for password and mount a decrypted file system at boot</li>
<li>Configure systems to mount file systems at boot by Universally Unique ID (UUID) or label</li>
<li>Add new partitions, logical volumes and swap to a system non-destructively</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-create-and-configure-file-systems">
<h3><a class="toc-backref" href="#id25">RHCSA: Create and Configure File Systems</a></h3>
<blockquote>
<ul class="simple">
<li>Create, mount, unmount and use ext2, ext3 and ext4 file systems</li>
<li>Mount, unmount and use LUKS-encrypted file systems</li>
<li>Mount and unmount CIFS and NFS network file systems</li>
<li>Configure systems to mount ext4, LUKS-encrypted and network file systems automatically</li>
<li>Extend existing unencrypted ext4-formatted logical volumes</li>
<li>Create and configure set-GID directories for collaboration</li>
<li>Create and manage Access Control Lists (ACLs)</li>
<li>Diagnose and correct file permission problems</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-deploy-configure-maintain">
<h3><a class="toc-backref" href="#id26">RHCSA: Deploy, Configure &amp; Maintain</a></h3>
<blockquote>
<ul class="simple">
<li>Configure networking and hostname resolution statically or dynamically</li>
<li>Schedule tasks using cron</li>
<li>Configure systems to boot into a specific runlevel automatically</li>
<li>Install Red Hat Enterprise Linux automatically using Kickstart</li>
<li>Configure a physical machine to host virtual guests</li>
<li>Install Red Hat Enterprise Linux systems as virtual guests</li>
<li>Configure systems to launch virtual machines at boot</li>
<li>Configure network services to start automatically at boot</li>
<li>Configure a system to run a default configuration HTTP server</li>
<li>Configure a system to run a default configuration FTP server</li>
<li>Install and update software packages from Red Hat Network, a remote repository, or from the local filesystem</li>
<li>Update the kernel package appropriately to ensure a bootable system</li>
<li>Modify the system bootloader</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-manage-users-and-groups">
<h3><a class="toc-backref" href="#id27">RHCSA: Manage Users and Groups</a></h3>
<blockquote>
<ul class="simple">
<li>Create, delete, and modify local user accounts</li>
<li>Change passwords and adjust password aging for local user accounts</li>
<li>Create, delete and modify local groups and group memberships</li>
<li>Configure a system to use an existing LDAP directory service for user and group information</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhcsa-manage-security">
<h3><a class="toc-backref" href="#id28">RHCSA: Manage Security</a></h3>
<blockquote>
<ul class="simple">
<li>Configure firewall settings using system-config-firewall or iptables</li>
<li>Set enforcing and permissive modes for SELinux</li>
<li>List and identify SELinux file and process context</li>
<li>Restore default file contexts</li>
<li>Use boolean settings to modify system SELinux settings</li>
<li>Diagnose and address routine SELinux policy violations</li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="rhce-objectives">
<h2><a class="toc-backref" href="#id29">RHCE Objectives</a></h2>
<div class="section" id="rhce-system-configuration-and-management">
<h3><a class="toc-backref" href="#id30">RHCE: System Configuration and Management</a></h3>
<blockquote>
<ul class="simple">
<li>Route IP traffic and create static routes</li>
<li>Use iptables to implement packet filtering and configure network address translation (NAT)</li>
<li>Use /proc/sys and sysctl to modify and set kernel run-time parameters</li>
<li>Configure system to authenticate using Kerberos</li>
<li>Build a simple RPM that packages a single file</li>
<li>Configure a system as an iSCSI initiator that persistently mounts an iSCSI target</li>
<li>Produce and deliver reports on system utilization (processor, memory, disk, and network)</li>
<li>Use shell scripting to automate system maintenance tasks</li>
<li>Configure a system to log to a remote system</li>
<li>Configure a system to accept logging from a remote system</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-network-services">
<h3><a class="toc-backref" href="#id31">RHCE: Network Services</a></h3>
<p>Network services are an important subset of the exam objectives. RHCE candidates should be capable of meeting the following objectives for each of the network services listed below:</p>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
</ul>
</blockquote>
<p>RHCE candidates should also be capable of meeting the following objectives associated with specific services:</p>
</div>
<div class="section" id="rhce-http-https">
<h3><a class="toc-backref" href="#id32">RHCE: HTTP/HTTPS</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Configure a virtual host</li>
<li>Configure private directories</li>
<li>Deploy a basic CGI application</li>
<li>Configure group-managed content</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-dns">
<h3><a class="toc-backref" href="#id33">RHCE: DNS</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Configure a caching-only name server</li>
<li>Configure a caching-only name server to forward DNS queries</li>
<li>Note: Candidates are not expected to configure master or slave name servers</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-ftp">
<h3><a class="toc-backref" href="#id34">RHCE: FTP</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Configure anonymous-only download</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-nfs">
<h3><a class="toc-backref" href="#id35">RHCE: NFS</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Provide network shares to specific clients</li>
<li>Provide network shares suitable for group collaboration</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-smb">
<h3><a class="toc-backref" href="#id36">RHCE: SMB</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Provide network shares to specific clients</li>
<li>Provide network shares suitable for group collaboration</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-smtp">
<h3><a class="toc-backref" href="#id37">RHCE: SMTP</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Configure a mail transfer agent (MTA) to accept inbound email from other systems</li>
<li>Configure an MTA to forward (relay) email through a smart host</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-ssh">
<h3><a class="toc-backref" href="#id38">RHCE: SSH</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Configure key-based authentication</li>
<li>Configure additional options described in documentation</li>
</ul>
</blockquote>
</div>
<div class="section" id="rhce-ntp">
<h3><a class="toc-backref" href="#id39">RHCE: NTP</a></h3>
<blockquote>
<ul class="simple">
<li>Install the packages needed to provide the service</li>
<li>Configure SELinux to support the service</li>
<li>Configure the service to start when the system is booted</li>
<li>Configure the service for basic operation</li>
<li>Configure host-based and user-based security for the service</li>
<li>Synchronize time using other NTP peers</li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="boot-reboot-shutdown">
<h2><a class="toc-backref" href="#id40">Boot, Reboot, Shutdown</a></h2>
<ul class="simple">
<li>GRUB Menu</li>
<li>Display Manager Screen</li>
<li>Gnome or KDE</li>
<li>Terminal commands: shutdown, halt, poweroff, reboot, init</li>
</ul>
</div>
<div class="section" id="runlevels">
<h2><a class="toc-backref" href="#id41">Runlevels</a></h2>
<ul class="simple">
<li>Default</li>
<li>From GRUB Menu</li>
</ul>
</div>
<div class="section" id="single-user-mode">
<h2><a class="toc-backref" href="#id42">Single User Mode</a></h2>
<ul class="simple">
<li>Password Recovery</li>
</ul>
<p>Note:  SELinux bug prevents password changes while set to &quot;Enforcing&quot;.</p>
</div>
<div class="section" id="log-files">
<h2><a class="toc-backref" href="#id43">Log Files</a></h2>
<p><tt class="docutils literal"><span class="pre">/var/log/*</span></tt></p>
<p>View with <tt class="docutils literal"><span class="pre">cat</span></tt>, <tt class="docutils literal"><span class="pre">less</span></tt> or other tools</p>
<p>Search with <tt class="docutils literal"><span class="pre">grep</span></tt></p>
</div>
<div class="section" id="start-stop-virtual-machines">
<h2><a class="toc-backref" href="#id44">Start/Stop Virtual Machines</a></h2>
<ul class="simple">
<li>Using virt-manager</li>
<li>Using virsh commands</li>
</ul>
</div>
<div class="section" id="virtual-machine-consoles">
<h2><a class="toc-backref" href="#id45">Virtual Machine Consoles</a></h2>
<ul class="simple">
<li>virt-manager</li>
<li>virt-viewer</li>
</ul>
</div>
<div class="section" id="virtual-machine-text-console">
<h2><a class="toc-backref" href="#id46">Virtual Machine Text Console</a></h2>
<p>With libguestfs-tools installed and the VM in question shut-down, from the host:</p>
<pre class="literal-block">
# virt-edit {VMname} /boot/grub/menu.lst
</pre>
<p>There, append to the kernel line:</p>
<pre class="literal-block">
console=tty0 console=ttyS0.
</pre>
<p>After saving, the following commands should allow a console based view of the boot process and a console login:</p>
<pre class="literal-block">
# virsh start {VMname} ; virsh console {VMname}
</pre>
</div>
<div class="section" id="virtual-machine-text-console-caveat">
<h2><a class="toc-backref" href="#id47">Virtual Machine Text Console Caveat</a></h2>
<blockquote>
After this change, some messages that appear only on the default console will be visible only here.  For example, the passphrase prompt to decrypt LUKS-encrypted partitions mounted in /etc/fstab will not be visible when using virt-viewer and the vm will appear to be hung.  Only by using virsh console can the passphrase be entered to allow the boot process to continue.</blockquote>
</div>
<div class="section" id="start-stop-and-check-the-status-of-network-services">
<h2><a class="toc-backref" href="#id48">Start, stop, and check the status of network services</a></h2>
</div>
<div class="section" id="modify-the-system-bootloader">
<h2><a class="toc-backref" href="#id49">Modify the system bootloader</a></h2>
</div>
</div>
<div class="section" id="session-2-storage-and-filesystems">
<h1><a class="toc-backref" href="#id50">Session 2 Storage and filesystems</a></h1>
<div class="section" id="filesystem-disambiguation">
<h2><a class="toc-backref" href="#id51">&quot;Filesystem&quot; - Disambiguation</a></h2>
<p>Several meanings for the term:</p>
<ul class="simple">
<li>The way files are physically written to storage devices, as in  the ext3, Fat-32, NTFS filesystems, or etc.</li>
<li>The unified directory structure which logically organizes files</li>
<li>The standard which defines how directories should be structured and utilized in Linux</li>
</ul>
</div>
<div class="section" id="linux-filesystem-hierarchy">
<h2><a class="toc-backref" href="#id52">Linux Filesystem Hierarchy</a></h2>
<p>The directory structure of a Linux system is standardized through the Filesystem Hierarchy Standard (explained at <a class="reference external" href="http://www.pathname.com/fhs">http://www.pathname.com/fhs</a>)</p>
<p>The Linux Manual system has an abbreviated reference:</p>
<p><tt class="docutils literal"><span class="pre">$</span> <span class="pre">man</span> <span class="pre">7</span> <span class="pre">hier</span></tt></p>
<p>Red Hat has a more complete description, along with RedHat-specific implementation decisions in their <strong>Deployment Guide</strong> at <a class="reference external" href="http://www.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/5/html/Deployment_Guide/ch-filesystem.html">http://www.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/5/html/Deployment_Guide/ch-filesystem.html</a></p>
<!-- for future development, consider expanding this... -->
</div>
<div class="section" id="disk-and-filesystem-tools">
<h2><a class="toc-backref" href="#id53">Disk and Filesystem tools</a></h2>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">fdisk</span></tt> or <tt class="docutils literal"><span class="pre">parted</span></tt> -- Used to partition hard disks or other block devices</li>
<li><tt class="docutils literal"><span class="pre">mkfs</span></tt> and variants -- Used to create filesystems on block devices (actually a front-end for a variety of FS-specific tools)</li>
<li><tt class="docutils literal"><span class="pre">fsck</span></tt> and variants -- Used to run filesystem checks (a front-end to FS specific tools)</li>
<li><tt class="docutils literal"><span class="pre">mount</span></tt> -- Used to mount a filesystem to a specific location in the directory structure</li>
<li><tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> -- Configuration file used to describe the filesystems that should be persistently mounted</li>
<li><tt class="docutils literal"><span class="pre">blkid</span></tt> -- used to identify filesystems or other in-use devices by UUID or filesystem labels.</li>
<li><tt class="docutils literal"><span class="pre">df</span></tt> -- used to display the capacity and utilization % of mounted filesystems.</li>
<li><tt class="docutils literal"><span class="pre">partx</span></tt> -- used to force implementation of a new partition table on an in-use device w/o the need to reboot.</li>
</ul>
</div>
<div class="section" id="working-with-partitions">
<h2><a class="toc-backref" href="#id54">Working with Partitions</a></h2>
<p>Overview of process for using Basic Storage Devices:</p>
<ul class="simple">
<li>Install the device or otherwise make it available to the system.</li>
<li>Partition it with <tt class="docutils literal"><span class="pre">fdisk</span></tt> or <tt class="docutils literal"><span class="pre">parted</span></tt>.</li>
<li>Create a filesystem on the partition with mkfs or other tools.</li>
<li>Choose or create a directory to serve as a mount point.</li>
<li>Mount the partition.</li>
<li>Add an entry to <tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> to make it persistent.</li>
</ul>
<!-- List, create, delete and set partition type for primary, extended, and logical partitions -->
</div>
<div class="section" id="working-with-logical-volume-management">
<h2><a class="toc-backref" href="#id55">Working with Logical Volume Management</a></h2>
<p>Overview of process for using Logical Volume Management:</p>
<ul class="simple">
<li>Install the device or otherwise make it available to the system.</li>
<li>Create a type <tt class="docutils literal"><span class="pre">8e</span></tt> partition with <tt class="docutils literal"><span class="pre">fdisk</span></tt> or <tt class="docutils literal"><span class="pre">parted</span></tt>.</li>
<li>Initialize the partition as a physical volume with <tt class="docutils literal"><span class="pre">pvcreate</span></tt>.</li>
<li>Add the storage of the PV to a volume group with <tt class="docutils literal"><span class="pre">vgcreate</span></tt>.</li>
<li>Allocate storage from the volume group to a logical volume with <tt class="docutils literal"><span class="pre">lvcreate</span></tt>.</li>
<li>Create a filesystem on the logical volume with mkfs or other tools.</li>
<li>Choose or create a directory to serve as a mount point.</li>
<li>Mount the partition.</li>
<li>Add an entry to <tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> to make it persistent.</li>
</ul>
<!-- Create and remove physical volumes, assign physical volumes to volume groups, create and delete logical volumes -->
</div>
<div class="section" id="removing-logical-volume-structures">
<h2><a class="toc-backref" href="#id56">Removing Logical Volume structures</a></h2>
<ul class="simple">
<li>Unmount the lv you want to remove</li>
<li>Edit /etc/fstab to remove its entry</li>
<li>Remove the logical volume: <tt class="docutils literal"><span class="pre">lvremove</span> <span class="pre">/dev/&lt;vg&gt;/&lt;lv&gt;</span></tt></li>
<li>Before removing a VG, ensure there are no more LVs within it.</li>
<li>Remove the volume group: <tt class="docutils literal"><span class="pre">vgremove</span> <span class="pre">/dev/&lt;vg&gt;</span></tt></li>
<li>Remove the LVM signature from the partitions: <tt class="docutils literal"><span class="pre">pvremove</span> <span class="pre">/dev/&lt;part&gt;</span></tt></li>
</ul>
</div>
<div class="section" id="commands-to-know">
<h2><a class="toc-backref" href="#id57">Commands to Know</a></h2>
<p>fdisk</p>
<ul class="simple">
<li>Always use -u and -c for best compatibility with newer storage devices</li>
<li>Can't create partitions &gt;= 2TB, use parted with GPT instead</li>
</ul>
<p>mkfs</p>
<ul class="simple">
<li>Used to create filesystems on devices</li>
<li>Front-end for other filesystem-specific tools (usually named mkfs.&lt;fstype&gt;)</li>
</ul>
<p>blkid</p>
<ul class="simple">
<li>Shows device name, Fileystem Labels, and UUID of detected block devices.</li>
<li>May not show block devices until a filesystem is created on them.</li>
<li>May not show block devices used in non-standard ways (for example, a filesystem on a whole disk instead of on a partition)</li>
</ul>
<p>mount</p>
<ul class="simple">
<li>used to make a new filesystem available</li>
</ul>
</div>
<div class="section" id="working-with-luks-encrypted-storage">
<h2><a class="toc-backref" href="#id58">Working with LUKS encrypted storage</a></h2>
<p>cryptsetup-luks-1.1.2-2.el6.x86_64</p>
<p>Overview of process for using LUKS encryption:</p>
<ul class="simple">
<li>Create a new partition</li>
<li>Encrypt it with <tt class="docutils literal"><span class="pre">cryptsetup</span> <span class="pre">luksFormat</span> <span class="pre">/dev/&lt;partition&gt;</span></tt></li>
<li>Open the encrypted device and assign it a name with <tt class="docutils literal"><span class="pre">cryptsetup</span> <span class="pre">luksOpen</span> <span class="pre">/dev/&lt;partition&gt;</span> <span class="pre">&lt;name&gt;</span></tt></li>
<li>Create a filesystem on the named device (/dev/mapper/&lt;name&gt;)</li>
<li>Create a mountpoint for the device</li>
<li>Mount the device</li>
</ul>
<p>To lock the volume:</p>
<ul class="simple">
<li>unmount it</li>
<li>Use <tt class="docutils literal"><span class="pre">cryptsetup</span> <span class="pre">luksClose</span> <span class="pre">&lt;name&gt;</span></tt> to remove the decryption mapping</li>
</ul>
</div>
<div class="section" id="persistent-mounting-of-luks-devices">
<h2><a class="toc-backref" href="#id59">Persistent mounting of LUKS devices</a></h2>
<p>To persistently mount it</p>
<blockquote>
<ul>
<li><p class="first">Create an entry in /etc/crypttab:</p>
<pre class="literal-block">
&lt;name&gt; /dev/&lt;partition&gt; &lt;password (none|&lt;blank&gt;|&lt;path/to/file/with/password&gt;)&gt;
</pre>
</li>
<li><p class="first">If the password field is &quot;none&quot; or left blank, the system will prompt for a password.</p>
</li>
<li><p class="first">Create an entry in /etc/fstab</p>
</li>
</ul>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">At reboot, the password prompt goes only to the default console.  If console redirection is enabled, as it might be in the case of enabling a virtual machine to accessible through <tt class="docutils literal"><span class="pre">virsh</span> <span class="pre">console</span> <span class="pre">&lt;name&gt;</span></tt>, then the only place where the prompt is seen and the passphrase can be entered is at that redirected console.</p>
</div>
</blockquote>
<!-- Create and configure LUKS-encrypted partitions and logical volumes to prompt for password and mount a decrypted file system at boot -->
</div>
<div class="section" id="working-with-swap">
<h2><a class="toc-backref" href="#id60">Working with SWAP</a></h2>
<p>Overview of process for adding SWAP space using a partition:</p>
<ul>
<li><p class="first">Create a type 82 partition</p>
</li>
<li><p class="first">Initialize as swap with <tt class="docutils literal"><span class="pre">mkswap</span> <span class="pre">/dev/&lt;partition&gt;</span></tt></p>
</li>
<li><p class="first">Identify the UUID with <tt class="docutils literal"><span class="pre">blkid</span></tt></p>
</li>
<li><p class="first">Add an <tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> line:</p>
<pre class="literal-block">
UUID=&lt;UUID&gt; swap swap defaults 0 0
</pre>
</li>
<li><p class="first">Activate the new swap space with: <tt class="docutils literal"><span class="pre">swapon</span> <span class="pre">-a</span></tt></p>
</li>
</ul>
</div>
<div class="section" id="using-a-file-for-swap">
<h2><a class="toc-backref" href="#id61">Using a file for SWAP</a></h2>
<p>Overview of process for adding SWAP space using a file:</p>
<ul>
<li><p class="first">create a pre-allocated file of the desired size:</p>
<pre class="literal-block">
dd if=/dev/zero of=/path/to/&lt;swapfile&gt; bs=1M count=&lt;size in MB&gt;
</pre>
</li>
<li><p class="first">Initialize as swap with <tt class="docutils literal"><span class="pre">mkswap</span> <span class="pre">/path/to/&lt;swapfile&gt;</span></tt></p>
</li>
<li><p class="first">Add an <tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> line:</p>
<pre class="literal-block">
/path/to/&lt;swapfile&gt; swap swap defaults 0 0
</pre>
</li>
<li><p class="first">Activate the new swap space with: <tt class="docutils literal"><span class="pre">swapon</span> <span class="pre">-a</span></tt></p>
</li>
</ul>
</div>
<div class="section" id="mounting-using-uuids-and-filesystem-labels">
<h2><a class="toc-backref" href="#id62">Mounting Using UUIDs and Filesystem Labels</a></h2>
<p>Configure systems to mount file systems at boot by Universally Unique ID (UUID) or label</p>
</div>
<div class="section" id="local-storage-adding-new-storage">
<h2><a class="toc-backref" href="#id63">Local Storage: Adding New Storage</a></h2>
<p>Add new partitions, logical volumes, and swap to a system non-destructively</p>
</div>
<div class="section" id="file-systems-working-with-common-linux-filesystems">
<h2><a class="toc-backref" href="#id64">File systems: Working with Common Linux Filesystems</a></h2>
<p>Create, mount, unmount and use ext2, ext3 and ext4 file systems</p>
<p>Extend existing unencrypted ext4-formatted logical volumes</p>
</div>
<div class="section" id="filesystem-permissions-basic-permissions">
<h2><a class="toc-backref" href="#id65">Filesystem Permissions: Basic Permissions</a></h2>
<p>Linux permissions are organized around:</p>
<ul class="simple">
<li>Three sets of permissions -- User, Group, and Other</li>
<li>Three types of permissions -- Read, Write, and Execute</li>
<li>Three extended attributes -- SUID, SGID, and Stickybit</li>
</ul>
</div>
<div class="section" id="three-sets-of-permissions">
<h2><a class="toc-backref" href="#id66">Three Sets of Permissions:</a></h2>
<p>Any given file or directory can be owned by one (and only one) user and one (and only one) group. Three different sets of permissions can be assigned.</p>
<ul class="simple">
<li>User -- User permissions apply to the individual user who owns the file or directory.</li>
<li>Group -- Group permissions apply to any user who is a member of the group that owns the file or directory.</li>
<li>Other -- Other permissions apply to any user account with access to the system that does not fall into the previous categories.</li>
</ul>
</div>
<div class="section" id="three-types-of-permissions">
<h2><a class="toc-backref" href="#id67">Three Types of Permissions:</a></h2>
<ul>
<li><p class="first">Read (&quot;r&quot;)</p>
<blockquote>
<ul class="simple">
<li>On a file, allows reading</li>
<li>On a directory, allows listing</li>
</ul>
</blockquote>
</li>
<li><p class="first">Write (&quot;w&quot;)</p>
<blockquote>
<ul class="simple">
<li>On a file, allows editing</li>
<li>On a directory, allows creation and deletion of files</li>
</ul>
</blockquote>
</li>
<li><p class="first">Execute (&quot;x&quot;)</p>
<blockquote>
<ul class="simple">
<li>On a file, allows execution if the file is otherwise executable (script or binary)</li>
<li>On a directory, allows entry or traversal (<tt class="docutils literal"><span class="pre">#</span> <span class="pre">cd</span> <span class="pre">{dirname}</span></tt>)</li>
</ul>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="three-extended-attributes">
<h2><a class="toc-backref" href="#id68">Three Extended Attributes:</a></h2>
<ul>
<li><dl class="first docutils">
<dt>SUID (Set User ID)</dt>
<dd><p class="first last">On an executable, runs a process under the UID of the file owner rather than that of the user executing it.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>SGID (Set Group ID)</dt>
<dd><p class="first last">On a directory, causes any files created in the directory to belong to the group owning the directory.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&quot;Stickybit&quot;</dt>
<dd><p class="first last">On a directory, ensures that only the owner of a file or the owner of the directory can delete it, even if all users or other members of a group have write access to the directory.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="viewing-permissions">
<h2><a class="toc-backref" href="#id69">Viewing Permissions</a></h2>
<p>Permissions are displayed with positions 2-10 of a &quot;long&quot; filelisting:</p>
<blockquote>
<img alt="images/permblock.gif" src="images/permblock.gif" style="width: 40%;" />
</blockquote>
</div>
<div class="section" id="setting-permissions">
<h2><a class="toc-backref" href="#id70">Setting Permissions</a></h2>
<p>The <tt class="docutils literal"><span class="pre">chmod</span></tt> command is used to set permissions on both files and directories.  It has two modes -- one using symbolic options and one using octal numbers.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">[option]</span> <span class="pre">[ugoa...][+-=][rwxst]</span> <span class="pre">filename</span></tt></dt>
<dd>where ugo are user, group, other, or all and rwxst are read, write, execute, s{u/g}id, stickybit.</dd>
<dt><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">[option]</span> <span class="pre">XXXX</span> <span class="pre">filename</span></tt></dt>
<dd>where XXXX is a number representing the complete permissions on the file.</dd>
</dl>
</div>
<div class="section" id="setting-permissions-with-numeric-options">
<h2><a class="toc-backref" href="#id71">Setting Permissions with Numeric Options</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">&nbsp;</th>
<th class="head" colspan="3">User</th>
<th class="head" colspan="3">Group</th>
<th class="head" colspan="3">Other</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Permissions</td>
<td>r</td>
<td>w</td>
<td>x</td>
<td>r</td>
<td>w</td>
<td>x</td>
<td>r</td>
<td>w</td>
<td>x</td>
</tr>
<tr><td>Numeric Value</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>4</td>
<td>2</td>
<td>1</td>
</tr>
<tr><td>Sum</td>
<td colspan="3">0-7</td>
<td colspan="3">0-7</td>
<td colspan="3">0-7</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">example.txt</th>
<th class="head" colspan="3">User</th>
<th class="head" colspan="3">Group</th>
<th class="head" colspan="3">Other</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Permissions</td>
<td>r</td>
<td>w</td>
<td>x</td>
<td>r</td>
<td>-</td>
<td>x</td>
<td>-</td>
<td>-</td>
<td>x</td>
</tr>
<tr><td>Numeric Value</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr><td>Sum</td>
<td colspan="3">7</td>
<td colspan="3">5</td>
<td colspan="3">1</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">chmod</span> <span class="pre">751</span> <span class="pre">myfile.txt</span></tt></p>
</div>
<div class="section" id="setting-extended-attributes-with-numeric-options">
<h2><a class="toc-backref" href="#id72">Setting Extended Attributes with Numeric Options</a></h2>
<p>chmod numeric options are actually 4 digits (not three).  Missing digits are assumed to be leading zeroes.</p>
<p>The leftmost place is for extended attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="19%" />
<col width="19%" />
<col width="31%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Attribute</th>
<th class="head">SUID</th>
<th class="head">SGID</th>
<th class="head">Stickybit</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Value</td>
<td>4</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong> <tt class="docutils literal"><span class="pre">$</span> <span class="pre">chmod</span> <span class="pre">3775</span> <span class="pre">MySharedDir</span></tt></p>
</div>
<div class="section" id="setting-extended-attributes-with-symbolic-values">
<h2><a class="toc-backref" href="#id73">Setting Extended Attributes with Symbolic Values:</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">+t</span> <span class="pre">{filename}</span></tt></dt>
<dd>Sets the sticky bit</dd>
<dt><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">u+s</span> <span class="pre">{filename}</span></tt></dt>
<dd>Sets suid</dd>
<dt><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">g+s</span> <span class="pre">{filename}</span></tt></dt>
<dd>Sets sgid</dd>
</dl>
</div>
<div class="section" id="extended-attributes-in-directory-listings">
<h2><a class="toc-backref" href="#id74">Extended Attributes in Directory Listings</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr><td>-rwxrwxrwx</td>
<td>Normal Permissions, All permissions granted</td>
</tr>
<tr><td>-rwSrwxrwx</td>
<td>Indicates SUID set</td>
</tr>
<tr><td>-rwsrwxrwx</td>
<td>Indicates SUID and execute permission set</td>
</tr>
<tr><td>-rwxrwSrwx</td>
<td>Indicates SGID set</td>
</tr>
<tr><td>-rwxrwsrwx</td>
<td>Indicates SGID and execute permission set</td>
</tr>
<tr><td>-rwxrwxrwT</td>
<td>Indicates Stickybit set</td>
</tr>
<tr><td>-rwxrwxrwt</td>
<td>Indicates Stickybit and execute permission set</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="umask">
<h2><a class="toc-backref" href="#id75">Umask</a></h2>
<ul class="simple">
<li>The umask value determines the permissions that will be applied to newly created files and directories.</li>
<li>As a &quot;mask&quot; it is subtractive -- representing the value of the permissions you DO NOT want to grant.</li>
<li>Execute rights are automatically withheld (w/o regard for the umask) for <em>files</em> but not for <em>directories</em>.</li>
<li>Extended attributes are not addressed -- even though a umask is four characters.</li>
<li>The default umask value is set in /etc/bashrc and can be modified (non-persistently!) with the bash built-in command <tt class="docutils literal"><span class="pre">umask</span></tt>.</li>
</ul>
</div>
<div class="section" id="umask-examples">
<h2><a class="toc-backref" href="#id76">Umask Examples</a></h2>
<ul class="simple">
<li>Umask of 0002 yields permissions of 0775 on new directories and 0664 on new files</li>
<li>Umask of 0022 yields permissions of 0755 on new directories and 0644 on new files</li>
</ul>
</div>
<div class="section" id="sgid-and-stickybit-use-case-collaborative-directories">
<h2><a class="toc-backref" href="#id77">SGID and Stickybit Use Case -- Collaborative Directories</a></h2>
<ul class="simple">
<li>Create a Group for Collaboration</li>
<li>Add users to the group</li>
<li>Create a directory for collaboration</li>
<li>Set its group ownership to the intended group</li>
<li>Set its group permissions appropriately</li>
<li>Recursively set the SGID and sticky bits on the directory</li>
</ul>
<p>This ensures that:</p>
<blockquote>
<ol class="arabic simple">
<li>All files created in this directory will be owned by the intended group (SGID effect)</li>
<li>All files created in this directory can only be deleted by the user who owns the file or the user who owns the directory (stickybit effect)</li>
</ol>
</blockquote>
</div>
<div class="section" id="file-access-control-lists">
<h2><a class="toc-backref" href="#id78">File Access Control Lists</a></h2>
<ul class="simple">
<li>Provide more granular control of permissions.</li>
<li>Filesystem must be mounted with the 'acl' option or be compiled with that option by default</li>
</ul>
<p>getfacl</p>
<p>setfacl</p>
</div>
<div class="section" id="getfacl">
<h2><a class="toc-backref" href="#id79">getfacl</a></h2>
<p>Example of &quot;getfacl acldir&quot;</p>
<pre class="literal-block">
# file: acldir
# owner: frank
# group: frank
user::rwx
user:bob:-wx
user:mary:rw-
group::rwx
mask::rwx
other::r-x
</pre>
<p>Example of <tt class="docutils literal"><span class="pre">ls</span> <span class="pre">-l</span> <span class="pre">acldir</span></tt>:</p>
<pre class="literal-block">
drwxrwxr-x+ 2 frank frank 4096 2009-05-27 14:15 acldir
</pre>
<!-- Create and manage File Access Control Lists -->
</div>
<div class="section" id="working-with-cifs-network-file-systems">
<h2><a class="toc-backref" href="#id80">Working with CIFS network file systems</a></h2>
<p>Will be covered in more detail later.</p>
<p>Mount and unmount CIFS network file systems</p>
</div>
<div class="section" id="working-with-nfs-file-systems">
<h2><a class="toc-backref" href="#id81">Working with NFS file systems</a></h2>
<p>Mount and unmount NFS file systems</p>
</div>
<div class="section" id="iscsi-devices">
<h2><a class="toc-backref" href="#id82">iSCSI Devices</a></h2>
<p>Package: iscsi-initiator-utils</p>
<p>Allows a system to access remote storage devices with SCSI commands as though it were a local hard disk.</p>
<p>Terms:</p>
<ul class="simple">
<li>iSCSI initiator: A client requesting access to storage</li>
<li>iSCSI target: Remote storage device presented from an iSCSI server or &quot;target portal&quot;</li>
<li>iSCSI target portal: A server providing targets to the initiator</li>
<li>IQN: &quot;iSCSI Qualified Name&quot; -- a unique name.  Both the initiator and target need such a name to be assigned</li>
</ul>
</div>
<div class="section" id="accessing-iscsi-devices">
<h2><a class="toc-backref" href="#id83">Accessing iSCSI Devices</a></h2>
<ul>
<li><p class="first">Install the iscsi-initiator-utils package</p>
</li>
<li><p class="first">Start the <tt class="docutils literal"><span class="pre">iscsi</span></tt> and <tt class="docutils literal"><span class="pre">iscsid</span></tt> services (and configure them persistently on)</p>
</li>
<li><p class="first">Set the initiator IQN in /etc/iscsi/initiatorname.iscsi</p>
</li>
<li><p class="first">Discover targets with:</p>
<pre class="literal-block">
iscsiadm -m discovery -t st -p &lt;portal IP address&gt;
</pre>
</li>
<li><p class="first">Log in to the target using the name displayed in discovery:</p>
<pre class="literal-block">
iscsiadm -m node -T &lt;IQN&gt; -p &lt;portal IP address&gt; -l
</pre>
</li>
<li><p class="first">Identify the SCSI device name with <tt class="docutils literal"><span class="pre">dmesg</span></tt>, <tt class="docutils literal"><span class="pre">tail</span> <span class="pre">/var/log/messages</span></tt> or <tt class="docutils literal"><span class="pre">ls</span> <span class="pre">-l</span> <span class="pre">/dev/disk/by-path/*iscsi*</span></tt></p>
</li>
<li><p class="first">Use the disk as though it were a local hard disk</p>
</li>
</ul>
<div class="important">
<p class="first admonition-title">Important</p>
<p class="last">Be certain to use UUIDs or labels for persistent mounts in <tt class="docutils literal"><span class="pre">/etc/fstab</span></tt>.  Also, provide <tt class="docutils literal"><span class="pre">_netdev</span></tt> as a mount option so that this device will not be mounted until the network is already up.</p>
</div>
<!-- Configure a system as an iSCSI initiator that persistently mounts an iSCSI target -->
</div>
<div class="section" id="disconnecting-from-iscsi-devices">
<h2><a class="toc-backref" href="#id84">Disconnecting from iSCSI Devices</a></h2>
<ul>
<li><p class="first">Ensure the device is not in use</p>
</li>
<li><p class="first">Unmount the device</p>
</li>
<li><p class="first">Remove its <tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> entry</p>
</li>
<li><p class="first">Logout from the target:</p>
<pre class="literal-block">
iscsiadm -m node -T &lt;IQN&gt; -p &lt;portal IP&gt; -u
</pre>
</li>
<li><p class="first">Delete the local record:</p>
<pre class="literal-block">
iscsiadm -m node -T &lt;IQN&gt; -p &lt;portal IP&gt; -o delete
</pre>
</li>
</ul>
</div>
<div class="section" id="additional-references">
<h2><a class="toc-backref" href="#id85">Additional References</a></h2>
<ul class="simple">
<li>Chapter 4 of the Storage Administration Guide for RHEL6 (<a class="reference external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/index.html">http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/index.html</a>) covers the usage of parted.</li>
<li>Man pages for fdisk(8), fstab(5), mkfs(8), blkid(8), partprobe(8), mount(8), parted(8), cryptsetup(8), and crypttab(5)</li>
</ul>
</div>
</div>
<div class="section" id="session-3-managing-software-processes-kernel-attributes-and-users-and-groups">
<h1><a class="toc-backref" href="#id86">Session 3 Managing software, processes, kernel attributes, and users and groups</a></h1>
<div class="section" id="the-red-hat-network-rhn">
<h2><a class="toc-backref" href="#id87">The Red Hat Network (RHN)</a></h2>
<p>The primary delivery mechanism for installable software, updates, errata and bug fixes and systems management functions for an installation of RHEL 6 is the Red Hat Network or RHN.</p>
<p>The &quot;cost&quot; of RHEL 6 is really a subscription to this support network.</p>
<p>These commands are using in managing an RHN subscription:</p>
<pre class="literal-block">
# man -k rhn
rhn-profile-sync     (8)  - Update system information on Red Hat Network
rhn_check            (8)  - Check for and execute queued actions on RHN
rhn_register         (8)  - Connect to Red Hat Network
rhnplugin            (8)  - Red Hat Network support for yum(8)
rhnplugin.conf [rhnplugin] (5)  - Configuration file for the rhnplugin(8) yum(8) plugin
rhnreg_ks            (8)  - A program for non interactively registering systems to Red Hat Network
rhnsd                (8)  - A program for querying the Red Hat Network for updates and information
</pre>
</div>
<div class="section" id="rhn-subscription-activation">
<h2><a class="toc-backref" href="#id88">RHN Subscription Activation</a></h2>
<p>A new user of RHEL6 should receive information similar to this:</p>
<pre class="literal-block">
Red Hat subscription login:
    Account Number       : *******
    Contract Number      : *******
    Item Description     : Red Hat Enterprise Linux &lt;Edition&gt;
    RHEL Subscription Number : *******************
    Quantity             : #
    Service Dates        : 12-JUN-10 through 11-JUN-11
    Customer Name : *********************************
    Account Number: ************
    Log into the new portal here: access.redhat.com
    Login: *************
    Password: **************
    Email address: ****************************
</pre>
<p>That information can then be used with <tt class="docutils literal"><span class="pre">rhn_register</span></tt> to activate a new subscription</p>
</div>
<div class="section" id="rd-party-yum-repositories">
<h2><a class="toc-backref" href="#id89">3rd Party Yum Repositories</a></h2>
<p>These are other repositories of installable software, updates, or bugfixes.  The <tt class="docutils literal"><span class="pre">yum</span></tt> command can be configured to use them in addition to or instead of the RHN.</p>
<ul class="simple">
<li>Configuration of repositories other than the RHN is accomplished through text configuration files located in the directory: <tt class="docutils literal"><span class="pre">/etc/yum.repos.d/</span></tt></li>
<li>A configuration file for each repository (or group of related repos) should be created in <tt class="docutils literal"><span class="pre">/etc/yum.repos.d/</span></tt></li>
<li>The name of each repo config file should end in &quot;.repo&quot;.</li>
<li>This allows repos to be easily temporarily disabled simply by renaming the file to something like: <tt class="docutils literal"><span class="pre">myrepo.repo.disabled</span></tt></li>
</ul>
</div>
<div class="section" id="yum-repository-mandatory-configuration-items">
<h2><a class="toc-backref" href="#id90">Yum Repository Mandatory Configuration Items</a></h2>
<dl class="docutils">
<dt>Repository ID</dt>
<dd><p class="first">Short name for identifying this repository in reports</p>
<pre class="last literal-block">
[MyRepo]
</pre>
</dd>
<dt>Name</dt>
<dd><p class="first">Longer description of this repository</p>
<pre class="last literal-block">
name=My Custom Repository
</pre>
</dd>
<dt>Baseurl</dt>
<dd><p class="first">Description of protocol and location needed to locate the repo files.</p>
<pre class="last literal-block">
baseurl=ftp://192.168.5.200/pub/rhel6
</pre>
</dd>
</dl>
</div>
<div class="section" id="yum-repository-common-optional-configuration-items">
<h2><a class="toc-backref" href="#id91">Yum Repository Common Optional Configuration Items</a></h2>
<dl class="docutils">
<dt>gpgcheck</dt>
<dd><p class="first">Defines whether yum should attempt to validate package signatures. &quot;0&quot; = &quot;off&quot;, &quot;1&quot; = &quot;on&quot;.</p>
<pre class="last literal-block">
gpgcheck=1
</pre>
</dd>
<dt>gpgkey</dt>
<dd><p class="first">Defines (via URL) where the keys for signature validation are located (typically <tt class="docutils literal"><span class="pre">file:///etc/pki/rpm-gpg/&lt;key</span> <span class="pre">name&gt;</span></tt>)</p>
<pre class="last literal-block">
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
</pre>
</dd>
<dt>enabled</dt>
<dd><p class="first">(Optional) Defines whether this repository should be currently active. &quot;0&quot; = &quot;off&quot;, &quot;1&quot; = &quot;on&quot;.</p>
<pre class="last literal-block">
enabled=1
</pre>
</dd>
</dl>
</div>
<div class="section" id="managing-software-using-yum">
<h2><a class="toc-backref" href="#id92">Managing Software: Using yum</a></h2>
<p>Common commands:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">help</span></tt></dt>
<dd>Displays usage information.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">list</span></tt></dt>
<dd>Lists all available packages and indicates which are installed.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">search</span> <span class="pre">KEYWORD</span></tt></dt>
<dd>Searches for packages with a keyword in the package metadata.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">info</span> <span class="pre">PACKAGENAME</span></tt></dt>
<dd>Displays information about a package taken from the package metadata.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">install</span> <span class="pre">PACKAGENAME</span></tt></dt>
<dd>Installs a package (obtained from the repository) and any required dependencies.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">localinstall</span> <span class="pre">RPMFILENAME</span></tt></dt>
<dd>Installs a local .rpm file, but uses the repository to satisfy dependencies.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">remove</span> <span class="pre">PACKAGENAME</span></tt></dt>
<dd>Uninstalls a package and any other packages dependent upon it.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">update</span> <span class="pre">PACKAGENAME</span></tt></dt>
<dd>Installs a newer version of the package, if available.</dd>
<dt><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">update</span></tt></dt>
<dd>Updates an installed package for which a newer version is available.</dd>
</dl>
</div>
<div class="section" id="yum-related-man-pages">
<h2><a class="toc-backref" href="#id93">Yum-related man pages</a></h2>
<pre class="literal-block">
# man -k yum
qreposync             (1)  - synchronize yum repositories to a local directory
rhnplugin            (8)  - Red Hat Network support for yum(8)
rhnplugin.conf [rhnplugin] (5)  - Configuration file for the rhnplugin(8) yum(8) plugin
yum                  (8)  - Yellowdog Updater Modified
yum [yum-shell]      (8)  - Yellowdog Updater Modified shell
yum-groups-manager   (1)  - create and edit yum's group metadata
yum-utils            (1)  - tools for manipulating repositories and extended package management
yum.conf [yum]       (5)  - Configuration file for yum(8)
</pre>
</div>
<div class="section" id="rpm-architecture">
<h2><a class="toc-backref" href="#id94">RPM Architecture</a></h2>
<p><tt class="docutils literal"><span class="pre">rpm</span></tt> executable</p>
<p>RPM packages -- Files to install + SPEC file (metadata)</p>
<p>Local RPM database -- retains metadata from all installed packages</p>
<blockquote>
Database is kept in /var/lib/rpm</blockquote>
</div>
<div class="section" id="rpm-package-naming">
<h2><a class="toc-backref" href="#id95">RPM Package Naming</a></h2>
<ul>
<li><p class="first">name-version-release.architecture*.rpm</p>
</li>
<li><p class="first">Version is the version of the &quot;upstream&quot; open source code</p>
</li>
<li><p class="first">Release refers to Red Hat internal patches to the source code</p>
</li>
<li><p class="first">Architecture is one of:</p>
<blockquote>
<ul class="simple">
<li>i386,i686 -- 32 bit x86 compatible</li>
<li>x86_64 -- Intel/AMD 64 bit</li>
<li>ppc64 -- Power PC 64 bit</li>
<li>ia64 -- Intel Itanium 64 bit</li>
<li>noarch -- Arch-independent code (scripts, docs, images, etc)</li>
<li>src -- Source code</li>
</ul>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="package-naming-example">
<h2><a class="toc-backref" href="#id96">Package Naming Example</a></h2>
<p>bash-3.2-24.el5.x86_64.rpm</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="40%" />
<col width="28%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Name</th>
<th class="head">Project Version</th>
<th class="head">RH Release</th>
<th class="head">Arch</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>bash</td>
<td>3.2</td>
<td>24.el5</td>
<td>x86_64</td>
</tr>
</tbody>
</table>
<p>This package starts with version 3.2 of bash (from ftp.gnu.org/gnu/bash), applies a RH patch identified as 24.el5 to it, and is then built to run on an Intel/AMD 64 bit processor.</p>
</div>
<div class="section" id="installing-and-upgrading-packages">
<h2><a class="toc-backref" href="#id97">Installing and Upgrading Packages</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-i[v,h]</span> <span class="pre">name-ver-rel.arch.rpm</span></tt></dt>
<dd>Installs a package</dd>
<dt><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-U[v,h]</span> <span class="pre">name-ver-rel.arch.rpm</span></tt></dt>
<dd>Upgrades a package if an older version was previously installed. Otherwise, simply installs the new version.</dd>
<dt><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-F[v,h]</span> <span class="pre">name-ver-rel.arch.rpm</span></tt></dt>
<dd>Upgrades a package if an older version is installed.  Otherwise, does nothing -- <strong>does not install new packages if no older version was installed.</strong></dd>
</dl>
</div>
<div class="section" id="upgrading-a-kernel">
<h2><a class="toc-backref" href="#id98">Upgrading a Kernel</a></h2>
<ul class="simple">
<li>Always use <tt class="docutils literal"><span class="pre">#rpm</span> <span class="pre">-i</span> <span class="pre">...</span></tt></li>
<li>This leaves the previously installed kernel on the system and in the GRUB menu as a fall-back in case the new version has problems.</li>
</ul>
</div>
<div class="section" id="rpm-and-modified-config-files">
<h2><a class="toc-backref" href="#id99">RPM and Modified Config Files</a></h2>
<p>Scenario: niftyapp-1.0-1.el5.rpm uses a config file, <tt class="docutils literal"><span class="pre">/etc/nifty.conf</span></tt>. You tweaked <tt class="docutils literal"><span class="pre">/etc/nifty.conf</span></tt> to fit your system.  Now niftyapp-2.0-1.el5.rpm is available with new features that require changes in the .conf file and provides a new default config file.  What to do?</p>
<ul class="simple">
<li>If the previous version provided a default config file, the changes are detected.  Your modified version of the .conf file is saved as <tt class="docutils literal"><span class="pre">/etc/nifty.conf.rpmsave</span></tt> and the new default config is installed.  You can compare the files and modify as needed.</li>
<li>If the previous version did NOT provide a default config file, your version of the .conf file is saved as <tt class="docutils literal"><span class="pre">/etc/nifty.conf.rpmorig</span></tt> and the new default config is installed.  You can compare the files and modify as needed.</li>
</ul>
</div>
<div class="section" id="uninstalling">
<h2><a class="toc-backref" href="#id100">Uninstalling</a></h2>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-e</span> <span class="pre">name[-ver][-rel]</span></tt></p>
<ul class="simple">
<li>Package removal is never verbose, never shows progress ( -v, -h have not effect)</li>
<li>Package removal only needs the name (or when multiple versions of the same package are installed, sometimes the version or release) but not the architecture or the .rpm extension.</li>
</ul>
</div>
<div class="section" id="rpm-over-a-network">
<h2><a class="toc-backref" href="#id101">RPM over a Network</a></h2>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-ivh</span> <span class="pre">ftp://{Host}/path/to/packagename-ver-rel.arch.rpm</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-ivh</span> <span class="pre">http://{Host}/path/to/packagename-ver-rel.arch.rpm</span></tt></p>
<p>And wildcard &quot;globbing&quot; is allowed:</p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">rpm</span> <span class="pre">-ivh</span> <span class="pre">http://{Host}/path/to/packagename*</span></tt></p>
</div>
<div class="section" id="common-rpm-queries">
<h2><a class="toc-backref" href="#id102">Common RPM Queries</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Query</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>rpm -qa</td>
<td>lists all installed packages.</td>
</tr>
<tr><td>rpm -q pkg</td>
<td>Reports the version of the package.</td>
</tr>
<tr><td>rpm -qf /path/file</td>
<td>Reports which package provided the file.</td>
</tr>
<tr><td>rpm -qc pkg</td>
<td>Lists all configuration files of the package.</td>
</tr>
<tr><td>rpm -qd pkg</td>
<td>Lists all documentation of the package.</td>
</tr>
<tr><td>rpm -qi pkg</td>
<td>Reports a description of the package.</td>
</tr>
<tr><td>rpm -ql pkg</td>
<td>Lists all files contained in the package.</td>
</tr>
<tr><td>rpm -qR pkg</td>
<td>Lists all dependencies.</td>
</tr>
<tr><td>rpm -q --scripts</td>
<td>Lists the scripts that run when installing/removing.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>rpm -q{c|d|i|l|R}p /path/to/packagename-ver-rel-arch.rpm</dt>
<dd>Reports the same info as above, but pulls info from the .rpm file instead of the rpm database.</dd>
</dl>
</div>
<div class="section" id="rpm-verification">
<h2><a class="toc-backref" href="#id103">RPM Verification</a></h2>
<p>The RPM system satisfies two types of security concerns:</p>
<ol class="arabic simple">
<li>Is this package <em>authentic</em>?  How do I know it came from Red Hat?</li>
<li>Has this package retained <em>integrity</em>? How do I know they haven't been modified?</li>
</ol>
<p>Authenticity and integrity of packages can be confirmed prior to installation with GPG signing and MD5 checksums of the RPM packages.</p>
<p>Integrity of files can be confirmed after installation with verification of installed files against the recorded metadata in the package.</p>
</div>
<div class="section" id="validate-package-signatures">
<h2><a class="toc-backref" href="#id104">Validate Package Signatures</a></h2>
<ol class="arabic">
<li><p class="first">Import the Red Hat GPG public key (It can be found on the installation CD or in the /etc/pki/rpm-gpg/ directory):</p>
<pre class="literal-block">
# rpm --import /media/disk/RPM-GPG-KEY-redhat-release
</pre>
</li>
</ol>
<p>or:</p>
<pre class="literal-block">
# rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
</pre>
<ol class="arabic" start="2">
<li><p class="first">Check the signature of the package in question:</p>
<pre class="literal-block">
# rpm --checksig /path/to/package-ver-rel.arch.rpm
</pre>
</li>
</ol>
</div>
<div class="section" id="rpm-checksig-sample-output">
<h2><a class="toc-backref" href="#id105">RPM Checksig Sample Output</a></h2>
<p><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpm</span> <span class="pre">--checksig</span> <span class="pre">ftp://linuxlib.us.dell.com/</span></tt>
<tt class="docutils literal"><span class="pre">pub/Distros/RedHat/RHEL5/5.3/Server/x86_64/</span></tt>
<tt class="docutils literal"><span class="pre">install-x86_64/Server/ImageMagick-6.2.8.0-4</span></tt>
<tt class="docutils literal"><span class="pre">.el5_1.1.i386.rpm</span></tt></p>
<p><tt class="docutils literal"><span class="pre">ftp://linuxlib.us.dell.com/pub/Distros/RedHat</span></tt>
<tt class="docutils literal"><span class="pre">/RHEL5/5.3/Server/x86_64/install-x86_64/Server</span></tt>
<tt class="docutils literal"><span class="pre">/ImageMagick-6.2.8.0-4.el5_1.1.i386.rpm:</span> <span class="pre">(sha1)</span></tt>
<tt class="docutils literal"><span class="pre">dsa</span> <span class="pre">sha1</span> <span class="pre">md5</span> <span class="pre">gpg</span> <span class="pre">OK</span></tt></p>
</div>
<div class="section" id="verify-installed-files">
<h2><a class="toc-backref" href="#id106">Verify Installed Files</a></h2>
<p><tt class="docutils literal"><span class="pre">rpm</span> <span class="pre">-V</span></tt> (or <tt class="docutils literal"><span class="pre">--verify</span></tt>) will compare existing files on the system to their pristine state in the packages they came from.</p>
<p>There are 8 points of comparison as shown in the following table, in the Michael Jang book and in the rpm man page:</p>
</div>
<div class="section" id="change-codes-from-rpm-verify">
<h2><a class="toc-backref" href="#id107">Change Codes from rpm --verify</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Change Code</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>5</td>
<td>MD5 checksum</td>
</tr>
<tr><td>S</td>
<td>File size</td>
</tr>
<tr><td>L</td>
<td>Symbolic Link</td>
</tr>
<tr><td>T</td>
<td>Modification time</td>
</tr>
<tr><td>D</td>
<td>Device</td>
</tr>
<tr><td>U</td>
<td>User</td>
</tr>
<tr><td>G</td>
<td>Group</td>
</tr>
<tr><td>M</td>
<td>Mode</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rpm-verify-sample-output">
<h2><a class="toc-backref" href="#id108">RPM Verify Sample Output</a></h2>
<pre class="literal-block">
#rpm -Va
...

S.5....T  c /etc/ntp.conf
..?.....  c /etc/ntp/keys
S.5....T    /usr/bin/aspell
.......T    /usr/share/ImageMagick-6.2.8/config/magic.xml
.......T  d /usr/share/doc/ImageMagick-6.2.8/images/arc.png
.......T  d /usr/share/doc/ImageMagick-6.2.8/images/background.jpg

...
</pre>
</div>
<div class="section" id="identifying-installed-packages">
<h2><a class="toc-backref" href="#id109">Identifying Installed Packages</a></h2>
<p>View a list of the packages originally installed on the system:</p>
<pre class="literal-block">
# less /root/install.log
</pre>
<p>View a list of the packages installed through yum:</p>
<pre class="literal-block">
# less /var/log/yum.log
</pre>
<p>Query the RPM database for the packages installed right now:</p>
<pre class="literal-block">
# rpm -qa
</pre>
</div>
<div class="section" id="managing-software-building-rpms">
<h2><a class="toc-backref" href="#id110">Managing Software:  Building RPMs</a></h2>
<p>As of this writing, Red Hat is pointing users to the following RPM Guide from the Fedora project for more information on RPM creation:</p>
<p><a class="reference external" href="http://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/">http://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/</a></p>
</div>
<div class="section" id="inside-an-rpm-package">
<h2><a class="toc-backref" href="#id111">Inside an RPM package</a></h2>
<ul class="simple">
<li>files</li>
<li>scripts</li>
<li>metadata</li>
</ul>
<p>The package is defined by a &quot;build specification file&quot; or <em>spec file</em>.</p>
<p>A good example of a spec file can be obtained from the source rpm for redhat-release.</p>
<p><a class="reference external" href="ftp://ftp.redhat.com/pub/redhat/linux/enterprise/6Server/en/os/SRPMS/redhat-release-server-6Server-6.0.0.37.el6.src.rpm">ftp://ftp.redhat.com/pub/redhat/linux/enterprise/6Server/en/os/SRPMS/redhat-release-server-6Server-6.0.0.37.el6.src.rpm</a></p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">Open .spec files in vim for color highlighting</p>
</div>
</div>
<div class="section" id="main-contents-of-a-spec-file">
<h2><a class="toc-backref" href="#id112">Main contents of a .spec file</a></h2>
<ul class="simple">
<li>Introduction or preamble: Contains metadata about the package</li>
<li>Build instructions on how to compile the source code or otherwise prepare the package payload.</li>
<li>Scriptlets that perform the installation, uninstallation, or upgrade.</li>
<li>Manifest of files to be installed, along with their permissions.</li>
<li>Changelog recording the changes made to the package with each revision.</li>
</ul>
</div>
<div class="section" id="preamble-directives">
<h2><a class="toc-backref" href="#id113">Preamble directives</a></h2>
<dl class="docutils">
<dt>Name</dt>
<dd>Name of the package</dd>
<dt>Version</dt>
<dd>Version identifier</dd>
<dt>Release</dt>
<dd>Indicates incremental changes within a version.</dd>
<dt>Group</dt>
<dd>The package group that should include this package. This can come from the list at <tt class="docutils literal"><span class="pre">/usr/share/doc/rpm-*/GROUPS</span></tt> or can be unique to you.  Not related to yum package groups.</dd>
<dt>License</dt>
<dd>Short License Identifier as described at <a class="reference external" href="http://fedoraproject.org/wiki/Packaging/LicensingGuidelines">http://fedoraproject.org/wiki/Packaging/LicensingGuidelines</a></dd>
<dt>Summary</dt>
<dd>Short (&lt;=50 chars) one-line description.</dd>
<dt>Source</dt>
<dd>The file to be used as the source code.  Add'l sources can be specified as Source0, Source1, etc.</dd>
<dt>BuildArch</dt>
<dd>Arch to use when building.  Defaults to the existing system arch.  May also be &quot;noarch&quot; for arch-independent packages.</dd>
<dt>Requires</dt>
<dd>Requirements that this package needs to run. Can be in the form of files or other packages</dd>
<dt>BuildRequires</dt>
<dd>Requirements needed to build this package.</dd>
</dl>
</div>
<div class="section" id="required-spec-file-sections">
<h2><a class="toc-backref" href="#id114">Required Spec file sections</a></h2>
<p>%description</p>
<p>%prep</p>
<p>%build</p>
<p>%install</p>
<p>%clean</p>
<p>%files</p>
<p>%changelog</p>
</div>
<div class="section" id="package-building-tools">
<h2><a class="toc-backref" href="#id115">Package Building Tools</a></h2>
<p>These packages will provide tools for setting up a build environment and the ability to create your own packages.</p>
<ul class="simple">
<li>rpm-build</li>
<li>rpmdevtools</li>
<li>rpmlint</li>
</ul>
</div>
<div class="section" id="setting-up-a-build-environment">
<h2><a class="toc-backref" href="#id116">Setting up a Build Environment</a></h2>
<p>As a non-privileged user, run:</p>
<pre class="literal-block">
$ rpmdev-setuptree
</pre>
<p>This should create the following directory structure in your home directory:</p>
<pre class="literal-block">
 ~/rpmbuild
|-- BUILD
|-- RPMS
|-- SOURCES
|-- SPECS
\-- SRPMS
</pre>
<p>In that structure, your source files (in a tarball) should be placed ~/rpmbuild/SOURCES/ and your .spec file in ~/rpmbuild/SPECS/. The ~/rpmbuild/BUILD/ directory will be a temporary working directory for the build process. And, after the rpmbuild process is complete, the finished binary and source RPMs will be placed in ~/rpmbuild/RPMS/ and ~/rpmbuild/SRPMS/, respectively.</p>
</div>
<div class="section" id="viewing-the-build-environment">
<h2><a class="toc-backref" href="#id117">Viewing the Build Environment</a></h2>
<p>When diagnosing build problems, it is sometimes useful to see what files are actually being created in the build environment in order to identify deviations of actual behavior from expected behavior. The tree utility is useful for that.</p>
<p>Install tree with <tt class="docutils literal"><span class="pre">#</span> <span class="pre">yum</span> <span class="pre">install</span> <span class="pre">tree</span></tt>.</p>
<p>Invoke tree with <tt class="docutils literal"><span class="pre">$</span> <span class="pre">tree</span> <span class="pre">~/rpmbuild</span></tt> to show the contents of the build environment.</p>
</div>
<div class="section" id="building-the-rpm">
<h2><a class="toc-backref" href="#id118">Building the RPM</a></h2>
<p>With the source files in place and a properly configured <tt class="docutils literal"><span class="pre">.spec</span></tt> file written, the <tt class="docutils literal"><span class="pre">rpmbuild</span></tt> command can be used to build the rpm either at once, or (for troubleshooting) in stages</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpmbuild</span> <span class="pre">-bp</span> <span class="pre">&lt;spec</span> <span class="pre">file&gt;</span></tt></dt>
<dd>Builds through the <tt class="docutils literal"><span class="pre">%prep</span></tt> section -- unpacks sources and applies patches.</dd>
<dt><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpmbuild</span> <span class="pre">-bc</span> <span class="pre">&lt;spec</span> <span class="pre">file&gt;</span></tt></dt>
<dd>Builds through compile -- processes the <tt class="docutils literal"><span class="pre">%prep</span></tt> and <tt class="docutils literal"><span class="pre">%build</span></tt> sections.</dd>
<dt><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpmbuild</span> <span class="pre">-bi</span> <span class="pre">&lt;spec</span> <span class="pre">file&gt;</span></tt></dt>
<dd>Builds through <tt class="docutils literal"><span class="pre">%install</span></tt> -- processes <tt class="docutils literal"><span class="pre">%prep</span></tt>, <tt class="docutils literal"><span class="pre">%build</span></tt>, and <tt class="docutils literal"><span class="pre">%install</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpmbuild</span> <span class="pre">-bb</span> <span class="pre">&lt;spec</span> <span class="pre">file&gt;</span></tt></dt>
<dd>Builds only the binary rpm file.</dd>
<dt><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpmbuild</span> <span class="pre">-bs</span> <span class="pre">&lt;spec</span> <span class="pre">file&gt;</span></tt></dt>
<dd>Builds only the source rpm file.</dd>
<dt><tt class="docutils literal"><span class="pre">$</span> <span class="pre">rpmbuild</span> <span class="pre">-ba</span> <span class="pre">&lt;spec</span> <span class="pre">file&gt;</span></tt></dt>
<dd>Builds both the binary and source rpm files.</dd>
</dl>
<p>Use <tt class="docutils literal"><span class="pre">rpmbuild</span> <span class="pre">--help</span></tt> or <tt class="docutils literal"><span class="pre">man</span> <span class="pre">rpmbuild</span></tt> for other options.</p>
</div>
<div class="section" id="rpm-building-exercise">
<h2><a class="toc-backref" href="#id119">RPM Building Exercise</a></h2>
<p>As root, install rpm-build, rpmlint, rpmdevtools:</p>
<pre class="literal-block">
# yum -y install rpmbuild rpmdevtools rpmlint
</pre>
<p>As a non-privileged user, create a project directory:</p>
<pre class="literal-block">
$ mkdir ~/hello-1.0
</pre>
<!--  -->
<blockquote>
Name this according to the convention: &lt;projname&gt;-&lt;majorver&gt;.&lt;minorver&gt;</blockquote>
<p>Create bash script: ~/hello-1.0/hello.sh</p>
<pre class="literal-block">
#!/bin/bash
# hello.sh
echo 'hello'
exit 0
</pre>
<p>Create a tarball of the project directory:</p>
<pre class="literal-block">
$ tar cvzf hello-1.0.tar.gz ~/hello-1.0/
</pre>
<p>Create an rpm development environment:</p>
<pre class="literal-block">
$ rpmdev-setuptree
</pre>
<p>Move the tarball to the SOURCES directory</p>
<p>Create a .spec file in the SPECS directory:</p>
<pre class="literal-block">
$ vim pkgname.spec
</pre>
<p>or:</p>
<pre class="literal-block">
$ rpmdev-newspec -o pkgname.spec
</pre>
<p>Insert a name (Match the pkgname on the tarball and direcotory)</p>
<p>Insert a version (Match the version)</p>
<p>Leave the release alone</p>
<p>Insert a summary (one line)</p>
<p>Insert a group (package group)</p>
<p>Insert a license</p>
<p>Insert a URL or delete the line</p>
<p>Insert on the Source0 line, the name of your tarball</p>
<p>Leave the BuildRoot line alone</p>
<p>Unless your package has prerequisites needed before it can be compiled, delete the BuildRequires line</p>
<p>Unless your package has prerequisites needed before it can work, delete the Requires line</p>
<p>On a blank line below %description, insert a brief description of your package</p>
<p>Leave the %prep and %setup lines alone</p>
<p>If your package does not need to be &quot;built&quot; (compiled), delete the %build, %configure, and make lines.</p>
<p>Leave the %install section header alone.</p>
<p>Under the %install section, leave the rm line alone.</p>
<p>If your package does not need to be built, modify the make install line to something like this:</p>
<pre class="literal-block">
install -D myfile $RPM_BUILD_ROOT/path/to/install/dest/myfile
</pre>
<p>Leave the %clean and the rm -rf lines alone.</p>
<p>Under %files, use the following syntax to list each of the files your package will place on the target system:</p>
<pre class="literal-block">
%attr(770,owner,group)/path/to/file
</pre>
<p>Use the following syntax to list each of the directories you package will place on the target system:</p>
<pre class="literal-block">
%dir /root/bin
</pre>
<p>The changelog section can be deleted or left alone.</p>
<!-- + Build a simple RPM that packages a single file -->
</div>
<div class="section" id="signing-your-rpms">
<h2><a class="toc-backref" href="#id120">Signing Your RPMs</a></h2>
<p>Your RPMs can be digitally signed to protect users from the possibility of forged packages (any RPM package can execute scripts w/ root privileges when installed!). To implement this, first generate and identify a gpg key:</p>
<pre class="literal-block">
$ gpg --gen-key
gpg (GnuPG) 2.0.14; Copyright (C) 2009 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection?
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0)
Key does not expire at all
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: Scott Purcell
Email address: scott&#64;texastwister.info
Comment:
You selected this USER-ID:
    &quot;Scott Purcell &lt;scott&#64;texastwister.info&gt;&quot;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: key B9AED1DE marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
pub   2048R/B9AED1DE 2011-02-22
      Key fingerprint = 9987 B276 A24A 1210 13A7  4D05 9F3F 8934 B9AE D1DE
uid                  Scott Purcell &lt;scott&#64;texastwister.info&gt;
sub   2048R/0DA4CCE9 2011-02-22

[scott&#64;Client1 rhel6]$
</pre>
<p>The key ID can be seen in the output above, or can be found with gpg --fingerprint</p>
<p>Export the key to a file:</p>
<pre class="literal-block">
$ gpg --armor --output ~/RPM-GPG-KEY-ScottPurcell --export B9AED1DE
</pre>
<!--  -->
<blockquote>
<p>[<a class="reference external" href="mailto:scott&#64;Client1">scott&#64;Client1</a> ~]$ cat RPM-GPG-KEY-ScottPurcell
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.0.14 (GNU/Linux)</p>
<p>mQENBE1jVagBCADVDTOvRl3Z5xPZb6AAl2D3bM/H4kEhyJ+yk1pbVPmu8yu0Cbsl
. . .
R+J9rjvN8rNpQwm40Gx6RpM7qtP/LodzD46dNfbr87lJ4F+4A3U=
=f4Gq
-----END PGP PUBLIC KEY BLOCK-----</p>
</blockquote>
<p>Configure rpm-related tools to use your signature:</p>
<pre class="literal-block">
$ echo '%_gpg_name Scott Purcell'&gt;&gt; ~/.rpmmacros
</pre>
<p>or:</p>
<pre class="literal-block">
$ echo '%_gpg_name B9AED1DE'&gt;&gt; ~/.rpmmacros
</pre>
<p>Now packages can be created and signed at the same time with rpmbuild using the --sign option. Or existing packages can be retroactively signed with rpm using the --addsign or --resign options.</p>
<p>With a signed package in place, the user intending to install it now needs to import the key:</p>
<pre class="literal-block">
# rpm --import /home/scott/RPM-GPG-KEY-ScottPurcell
</pre>
<p>And with the key imported, the package can be verified:</p>
<pre class="literal-block">
$ rpm -K rpmbuild/RPMS/x86_64/rhel6rhce-0.5-1.el6.x86_64.rpm
rpmbuild/RPMS/x86_64/rhel6rhce-0.5-1.el6.x86_64.rpm: rsa sha1 (md5) pgp md5 OK
</pre>
</div>
<div class="section" id="create-a-repo-with-your-files">
<h2><a class="toc-backref" href="#id121">Create a Repo with your files</a></h2>
<p>(Assumes httpd already installed)</p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">yum</span> <span class="pre">-y</span> <span class="pre">install</span> <span class="pre">createrepo</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">mkdir</span> <span class="pre">-p</span> <span class="pre">/var/www/html/repo/Packages</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">cp</span> <span class="pre">MyPackage.rpm</span> <span class="pre">/var/www/html/repo/Packages</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">createrepo</span> <span class="pre">-v</span> <span class="pre">/var/www/html/repo</span></tt></p>
<p><tt class="docutils literal"><span class="pre">#</span> <span class="pre">cp</span> <span class="pre">/home/me/RPM-GPG-KEY-me</span> <span class="pre">/var/www/html/repo</span></tt></p>
</div>
<div class="section" id="rpm-packaging-other-documentation">
<h2><a class="toc-backref" href="#id122">RPM Packaging, Other Documentation:</a></h2>
<p>Red Hat Enterprise Linux Deployment Guide, section on &quot;Querying RPM&quot;</p>
<p>Man Pages:</p>
<blockquote>
<ul class="simple">
<li>rpm (8)</li>
<li>rpm2cpio (8)</li>
<li>cpio (1)</li>
</ul>
</blockquote>
</div>
<div class="section" id="manage-processes-and-services">
<h2><a class="toc-backref" href="#id123">Manage Processes and Services</a></h2>
<dl class="docutils">
<dt>Start a service:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">service</span> <span class="pre">&lt;servicename&gt;</span> <span class="pre">start</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/etc/init.d/&lt;servicescript&gt;</span> <span class="pre">start</span></tt></li>
</ul>
</dd>
<dt>Stop a service:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">service</span> <span class="pre">&lt;servicename&gt;</span> <span class="pre">stop</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/etc/init.d/&lt;servicescript&gt;</span> <span class="pre">stop</span></tt></li>
</ul>
</dd>
<dt>Check status of a service:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">service</span> <span class="pre">&lt;servicename&gt;</span> <span class="pre">status</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/etc/init.d/&lt;servicescript&gt;</span> <span class="pre">status</span></tt></li>
</ul>
</dd>
<dt>Reload a service's config:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">service</span> <span class="pre">&lt;servicename&gt;</span> <span class="pre">reload</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/etc/init.d/&lt;servicescript&gt;</span> <span class="pre">reload</span></tt></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="persistent-configuration-of-services">
<h2><a class="toc-backref" href="#id124">Persistent Configuration of Services</a></h2>
<dl class="docutils">
<dt>Configure a service to start at boot:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">chkconfig</span> <span class="pre">&lt;servicename&gt;</span> <span class="pre">on</span></tt></li>
<li><tt class="docutils literal"><span class="pre">system-config-services</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ntsysv</span></tt></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="manage-processes-and-services-configure-systems-to-boot-into-a-specific-runlevel-automatically">
<h2><a class="toc-backref" href="#id125">Manage Processes and Services: Configure systems to boot into a specific runlevel automatically</a></h2>
<p><tt class="docutils literal"><span class="pre">/etc/inittab</span></tt></p>
</div>
<div class="section" id="monitoring-processes">
<h2><a class="toc-backref" href="#id126">Monitoring Processes</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">ps</span></tt></dt>
<dd>Highly configurable command to list running processes</dd>
<dt><tt class="docutils literal"><span class="pre">top</span></tt></dt>
<dd>Command to provide realtime reports of the most active running processes</dd>
</dl>
</div>
<div class="section" id="killing-processes">
<h2><a class="toc-backref" href="#id127">Killing Processes</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">kill</span></tt></dt>
<dd>kills a process by PID.  Optionally sends &quot;signals&quot; other than &quot;kill&quot;.</dd>
<dt><tt class="docutils literal"><span class="pre">kill-all</span></tt></dt>
<dd>Kills a process by name.  Use care not to match names you don't intend to kill.</dd>
<dt><tt class="docutils literal"><span class="pre">pkill</span></tt></dt>
<dd>Also kills processes by name.  Use care not to match names you don't intend to kill.</dd>
<dt><tt class="docutils literal"><span class="pre">pgrep</span></tt></dt>
<dd>Searches processes by name. Useful for verifying which processes would be killed by pkill.</dd>
</dl>
</div>
<div class="section" id="prioritizing-processes">
<h2><a class="toc-backref" href="#id128">Prioritizing Processes</a></h2>
<p>The kernel calculates the priority of each process through a variety of factors.  One input into that calculation is a user-modifiable value called &quot;niceness&quot;.</p>
<ul class="simple">
<li>A process with higher niceness has lower priority and is thus more willing to share resources with other processes.</li>
<li>niceness can range from -20 (highest priority) to 19 (lowest priority).</li>
</ul>
</div>
<div class="section" id="nice-and-renice-commands">
<h2><a class="toc-backref" href="#id129"><tt class="docutils literal"><span class="pre">nice</span></tt> and <tt class="docutils literal"><span class="pre">renice</span></tt> commands</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nice</span></tt></dt>
<dd><p class="first">Launches commands with a specified &quot;niceness&quot; value affecting process priority.</p>
<ul class="last simple">
<li>Default niceness is &quot;0&quot;.</li>
<li>Root can set any value.</li>
<li>Non-privileged users can only use positive values.</li>
</ul>
</dd>
<dt><tt class="docutils literal"><span class="pre">renice</span></tt></dt>
<dd><p class="first">Modifies the niceness of an already-running process.</p>
<ul class="last simple">
<li>Root can modify the niceness of any process in either direction.</li>
<li>Non-privileged users can only modify their own processes and by increasing niceness (lowering priority)</li>
</ul>
</dd>
</dl>
<!-- Identify CPU/memory intensive processes, adjust process priority with renice, and kill processes -->
</div>
<div class="section" id="manage-system-performance">
<h2><a class="toc-backref" href="#id130">Manage system performance</a></h2>
<ul class="simple">
<li>Use /proc/sys and sysctl to modify and set kernel run-time parameters</li>
<li>Produce and deliver reports on system utilization (processor, memory, disk, and network)</li>
<li>Use iostat and vmstat to report on system performance</li>
<li>Use shell scripting to automate system maintenance tasks</li>
</ul>
</div>
<div class="section" id="manage-users-and-groups">
<h2><a class="toc-backref" href="#id131">Manage Users and Groups</a></h2>
<ul class="simple">
<li>Create, delete, and modify local user accounts</li>
<li>Change passwords and adjust password aging for local user accounts</li>
<li>Create, delete and modify local groups and group memberships</li>
<li>Configure a system to use an existing LDAP directory service for user and group information</li>
<li>Configure system to authenticate using Kerberos</li>
</ul>
</div>
</div>
<div class="section" id="session-4-networking-and-routing">
<h1><a class="toc-backref" href="#id132">Session 4 Networking and Routing</a></h1>
<div class="section" id="network-configuration-and-troubleshooting">
<h2><a class="toc-backref" href="#id133">Network Configuration and Troubleshooting</a></h2>
<p>Class discussion -- Populate a table explaining for each of the following aspects of network configuration: 1) How to view or verify the existing configuration, and 2) How to change the configuration.</p>
<ul class="simple">
<li>IP Address and Subnet Mask</li>
<li>Routing and Default Gateway</li>
<li>Hostname</li>
<li>Name Resolution</li>
</ul>
</div>
<div class="section" id="ip-address-and-subnet-mask">
<h2><a class="toc-backref" href="#id134">IP Address and Subnet Mask</a></h2>
<ul>
<li><p class="first">Verifying configuration</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">ip</span> <span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">ifconfig</span></tt></p>
</blockquote>
</li>
<li><p class="first">Changing configuration</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">nm_applet</span></tt>, <tt class="docutils literal"><span class="pre">system-config-network</span></tt>, manual editing of interface config files</p>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="routing-and-default-gateway">
<h2><a class="toc-backref" href="#id135">Routing and Default Gateway</a></h2>
<ul>
<li><p class="first">Verifying configuration</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">route</span></tt>, <tt class="docutils literal"><span class="pre">ip</span> <span class="pre">r</span></tt></p>
</blockquote>
</li>
<li><p class="first">Changing configuration</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">route</span></tt>, <tt class="docutils literal"><span class="pre">ip</span> <span class="pre">r</span></tt>, manual editing of route config files,</p>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="hostname">
<h2><a class="toc-backref" href="#id136">Hostname</a></h2>
<ul class="simple">
<li>Verifying configuration</li>
<li>Changing configuration</li>
</ul>
</div>
<div class="section" id="name-resolution">
<h2><a class="toc-backref" href="#id137">Name Resolution</a></h2>
<ul class="simple">
<li>Verifying configuration</li>
<li>Changing configuration</li>
</ul>
</div>
<div class="section" id="two-controlling-services">
<h2><a class="toc-backref" href="#id138">Two Controlling Services</a></h2>
<p><strong>NetworkManager</strong></p>
<ul class="simple">
<li>RHEL6 default</li>
<li>Ideal for client systems and systems with dynamic network conditions</li>
<li>No support for bonding/bridging/aliases, etc.</li>
</ul>
<p><strong>network</strong></p>
<ul class="simple">
<li>RHEL5 and earlier default</li>
<li>Ideal for systems with static network conditions</li>
<li>Bonding/bridging/aliases supported.</li>
</ul>
</div>
<div class="section" id="switching-between-controlling-services">
<h2><a class="toc-backref" href="#id139">Switching between Controlling Services</a></h2>
<p>To disable NetworkManager and enable network:</p>
<pre class="literal-block">
# service NetworkManager stop; chkconfig NetworkManager off
# service network start; chkconfig network start
</pre>
<p>To disable network and enable NetworkManager:</p>
<pre class="literal-block">
# service network stop; chkconfig network off
# service NetworkManager start; chkconfig NetworkManager on
</pre>
<p>To exempt a particular interface from control by NetworkManager, but leave it in control of other interfaces:</p>
<ul>
<li><p class="first">In the interface configuration file of the interface to be exempted, insert the line:</p>
<pre class="literal-block">
NM_CONTROLLED=no
</pre>
</li>
<li><p class="first">Ensure both services are configured on and running.</p>
</li>
<li><p class="first">Configured interfaces can be brought up with <tt class="docutils literal"><span class="pre">ifup</span> <span class="pre">eth&lt;x&gt;</span></tt> or down with <tt class="docutils literal"><span class="pre">ifdown</span> <span class="pre">eth&lt;x&gt;</span></tt> regardless of whether they are managed by NetworkManager or not.</p>
</li>
</ul>
</div>
<div class="section" id="network-configuration-files">
<h2><a class="toc-backref" href="#id140">Network Configuration Files</a></h2>
<dl class="docutils">
<dt>/etc/hosts</dt>
<dd>Static hostname-to-IP resolution.</dd>
<dt>/etc/resolv.conf</dt>
<dd>Client configuration for DNS.</dd>
<dt>/etc/sysconfig/network</dt>
<dd>Main system networking config file.  Enables/disables networking in general, sets the hostname, and configures routing.</dd>
<dt>/etc/sysconfig/network-scripts/ifcfg-&lt;ifname&gt;</dt>
<dd>Config file for each configured interface.</dd>
<dt>/etc/sysconfig/network-scripts/route-&lt;name&gt;</dt>
<dd>Config file for static routes (where needed)</dd>
</dl>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">/etc/sysconfig/networking/ is used by system-config-network and should not be manually edited.</p>
</div>
</div>
<div class="section" id="reference">
<h2><a class="toc-backref" href="#id141">Reference</a></h2>
<p>/usr/share/doc/initscripts-9.03.17/sysconfig.txt</p>
</div>
<div class="section" id="future-near-network-device-naming-scheme">
<h2><a class="toc-backref" href="#id142">Future (Near!) Network Device Naming Scheme</a></h2>
<p><a class="reference external" href="http://linux.dell.com/files/whitepapers/consistent_network_device_naming_in_linux.pdf">http://linux.dell.com/files/whitepapers/consistent_network_device_naming_in_linux.pdf</a></p>
</div>
<div class="section" id="troubleshooting-toolkit">
<h2><a class="toc-backref" href="#id143">Troubleshooting Toolkit</a></h2>
<!-- + *  Configure networking and hostname resolution statically or dynamically -->
<!-- + *  Route IP traffic and create static routes -->
</div>
</div>
<div class="section" id="session-5-firewalls-and-selinux">
<h1><a class="toc-backref" href="#id144">Session 5 Firewalls and SELinux</a></h1>
<div class="section" id="firewalling-in-rhel6">
<h2><a class="toc-backref" href="#id145">Firewalling in RHEL6</a></h2>
<p>RHEL6 implements a packet filtering firewall called iptables. You should know several key terms:</p>
<dl class="docutils">
<dt>rule</dt>
<dd>A one-line rule defining a packet type and how it should be handled.</dd>
<dt>chain</dt>
<dd>A list  of rules.</dd>
<dt>table</dt>
<dd>A list of rules aggregating all of the chains and rules taking a particular path through the network stack.</dd>
<dt>policy</dt>
<dd>A default rule that applies in the absence of other rules.</dd>
</dl>
</div>
<div class="section" id="iptables-built-in-chains">
<h2><a class="toc-backref" href="#id146">iptables Built-in Chains</a></h2>
<dl class="docutils">
<dt>INPUT</dt>
<dd>Applies to traffic with your server as the destination.</dd>
<dt>OUTPUT</dt>
<dd>Applies to traffic origination on your server as the source.</dd>
<dt>FORWARD</dt>
<dd>Applies to traffic being routed by your system from one network to another</dd>
</dl>
</div>
<div class="section" id="iptables-targets">
<h2><a class="toc-backref" href="#id147">iptables Targets</a></h2>
<dl class="docutils">
<dt>ACCEPT</dt>
<dd>Allows the packet to proceed to its destination.</dd>
<dt>DROP</dt>
<dd>Silently drop the packet.</dd>
<dt>REJECT</dt>
<dd>Drop the packet with a rejection message</dd>
<dt>LOG</dt>
<dd>Log the packet and move to next rule in the chain (which may then accept, drop, or reject)</dd>
</dl>
</div>
<div class="section" id="connection-tracking-states">
<h2><a class="toc-backref" href="#id148">Connection Tracking States</a></h2>
<p>Iptables can filter packets based on their relationship with previous traffic.</p>
<dl class="docutils">
<dt>NEW</dt>
<dd>The packet has started a new connection.</dd>
<dt>ESTABLISHED</dt>
<dd>Applies to packets that are part of an established TCP connection (packets have already been delivered in both directions).</dd>
<dt>RELATED</dt>
<dd>The packet is starting a new connection, but associated with an existing connection.</dd>
<dt>INVALID</dt>
<dd>The packet is associated with no known connection.</dd>
</dl>
</div>
<div class="section" id="iptables-command-options">
<h2><a class="toc-backref" href="#id149">Iptables Command Options</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">-vnl</span> <span class="pre">--line-numbers</span></tt></dt>
<dd>List all rules with line numbering</dd>
<dt><tt class="docutils literal"><span class="pre">-A</span> <span class="pre">&lt;chain&gt;</span> <span class="pre">&lt;rule&gt;</span> <span class="pre">-j</span> <span class="pre">&lt;target&gt;</span></tt></dt>
<dd>Adds a rule to the end of the chain</dd>
<dt><tt class="docutils literal"><span class="pre">-D</span> <span class="pre">&lt;chain&gt;</span> <span class="pre">&lt;rule#&gt;</span></tt></dt>
<dd>Deletes a rule by number</dd>
<dt><tt class="docutils literal"><span class="pre">-F</span> <span class="pre">&lt;chain&gt;</span></tt></dt>
<dd>Flushes all rules from the chain</dd>
</dl>
</div>
<div class="section" id="matching-packets">
<h2><a class="toc-backref" href="#id150">Matching packets</a></h2>
<p>A source IP or network:</p>
<pre class="literal-block">
-s 192.0.2.0/24
</pre>
<p>A destination IP or network:</p>
<pre class="literal-block">
-d 10.0.0.1
</pre>
<p>UDP/TCP and ports:</p>
<pre class="literal-block">
-p udp --sport 68 --dport 67
</pre>
<p>ICMP and types:</p>
<pre class="literal-block">
-p icmp --icmp-type echo-reply
</pre>
<p>Inbound network interface:</p>
<pre class="literal-block">
-i ETH0
</pre>
<p>Outbound network interface:</p>
<pre class="literal-block">
-o ETH0
</pre>
<p>State tracking:</p>
<pre class="literal-block">
-m state --state ESTABLISHED,RELATED
</pre>
</div>
<div class="section" id="iptables-tips">
<h2><a class="toc-backref" href="#id151">Iptables Tips</a></h2>
<p>Use <tt class="docutils literal"><span class="pre">system-config-firewall</span></tt> to enable and select FTP and SSH to generate a sample set of rules and load the connection tracking module.</p>
<p>Show connections being accepted or rejected in realtime:</p>
<pre class="literal-block">
# watch -d -n 2 `iptables -nvL`
</pre>
<!-- o IPTables -->
<!-- + * Configure firewall settings using system-config-firewall or iptables -->
</div>
<div class="section" id="selinux">
<h2><a class="toc-backref" href="#id152">SELinux</a></h2>
<p>SELinux is a set of security rules that determine which processes can access which files, directories, ports, and other system resources.</p>
<p>Purposes:</p>
<ul class="simple">
<li>Provide another method of securing a system.</li>
<li>Implement Mandatory Access Control policies (required in some institutional contexts).</li>
<li>Protect the system and its data from system services that have been compromised.</li>
</ul>
</div>
<div class="section" id="selinux-in-action">
<h2><a class="toc-backref" href="#id153">SELinux in Action</a></h2>
<ul class="simple">
<li>httpd allows remote anonymous access.</li>
<li>This allows the possibility of attempts to compromise the httpd daemon with security exploits.</li>
<li>httpd runs with the identity of the user &quot;apache&quot; and the group &quot;apache&quot; -- a successful exploit gains system access with the permissions granted to that user and group.</li>
<li>In addition to the filesystem areas needed to run a webserver, the apache user and group also have access to other &quot;world-readable&quot; and &quot;world-writeable&quot; location such as <tt class="docutils literal"><span class="pre">/tmp</span></tt>.</li>
<li>SELinux ensures that a compromised service cannot gain access to these filesystem location where it should not need access in the normal course of events.</li>
</ul>
</div>
<div class="section" id="selinux-enforcement-modes">
<h2><a class="toc-backref" href="#id154">SELinux Enforcement Modes</a></h2>
<dl class="docutils">
<dt>Disabled</dt>
<dd>No rules are enforced and the SELinux filesystem contexts are stripped away. Moving to or from this mode to one of the others requires a reboot -- during which the entire filesystem will be processed to add or remove the SELinux filesystem context labels.</dd>
<dt>Permissive</dt>
<dd>Rules are in place, violations are logged, but access is permitted (rules not enforced). Useful for troubleshooting.</dd>
<dt>Enforcing</dt>
<dd>Rules are in place and enforced.  Attempted violations are logged and access is denied.</dd>
</dl>
</div>
<div class="section" id="important-selinux-filesystem-locations">
<h2><a class="toc-backref" href="#id155">Important SELinux Filesystem locations</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">/etc/sysconfig/selinux</span></tt></dt>
<dd>Used to set enforcement mode and policy set.</dd>
<dt><tt class="docutils literal"><span class="pre">/var/log/audit/audit.log</span></tt></dt>
<dd>Extensive log of SELinux messages</dd>
<dt><tt class="docutils literal"><span class="pre">/var/log/messages</span></tt></dt>
<dd>Contains short summaries of SELinux messages when <tt class="docutils literal"><span class="pre">setroubleshoot-server</span></tt> is installed and active</dd>
</dl>
<ul class="simple">
<li>Watch for &quot;AVC&quot; (Access Vector Cache) in log messages.</li>
</ul>
</div>
<div class="section" id="related-packages">
<h2><a class="toc-backref" href="#id156">Related Packages</a></h2>
<dl class="docutils">
<dt>coreutils</dt>
<dd>Always installed.  Provides some default elements of SELinux.</dd>
<dt>policycoreutils</dt>
<dd>Provides <tt class="docutils literal"><span class="pre">restorecon</span></tt>, <tt class="docutils literal"><span class="pre">secon</span></tt>, <tt class="docutils literal"><span class="pre">setfiles</span></tt>, et al.</dd>
<dt>libselinux-utils</dt>
<dd>Provides <tt class="docutils literal"><span class="pre">getenforce</span></tt>, <tt class="docutils literal"><span class="pre">setenforce</span></tt>, <tt class="docutils literal"><span class="pre">getsebool</span></tt>, <tt class="docutils literal"><span class="pre">setsebool</span></tt>, et al.</dd>
<dt>policycoreutils-gui</dt>
<dd>Provides <tt class="docutils literal"><span class="pre">system-config-selinux</span></tt> and <tt class="docutils literal"><span class="pre">sepolgen</span></tt>, et al.</dd>
<dt>policycoreutils-python</dt>
<dd>Provides <tt class="docutils literal"><span class="pre">semanage</span></tt>, <tt class="docutils literal"><span class="pre">audit2allow</span></tt>, <tt class="docutils literal"><span class="pre">audit2why</span></tt>, et al.</dd>
<dt>setroubleshoot</dt>
<dd>Provides <tt class="docutils literal"><span class="pre">seapplet</span></tt></dd>
<dt>setroubleshoot-server</dt>
<dd>Provides <tt class="docutils literal"><span class="pre">sealert</span></tt>, <tt class="docutils literal"><span class="pre">sedispatch</span></tt>, <tt class="docutils literal"><span class="pre">setroubleshootd</span></tt>, et al.</dd>
</dl>
</div>
<div class="section" id="useful-commands">
<h2><a class="toc-backref" href="#id157">Useful Commands</a></h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">sestatus</span></tt></dt>
<dd>Displays information about the current SELinux parameters.</dd>
<dt><tt class="docutils literal"><span class="pre">chcon</span></tt></dt>
<dd>Changes context labels on files (but non-persistently! Use with <tt class="docutils literal"><span class="pre">semanage</span></tt> for persistent changes.</dd>
<dt><tt class="docutils literal"><span class="pre">semanage</span></tt></dt>
<dd>Modifies SELinux contexts persistently.</dd>
</dl>
</div>
<div class="section" id="additional-documentation">
<h2><a class="toc-backref" href="#id158">Additional Documentation</a></h2>
<p><a class="reference external" href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/index.html">http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/index.html</a></p>
</div>
<div class="section" id="setting-the-selinux-enforcement-mode">
<h2><a class="toc-backref" href="#id159">Setting the SELinux Enforcement Mode</a></h2>
<p>View the current setting:</p>
<pre class="literal-block">
# getenforce
Enforcing
</pre>
<p>Change the current setting:</p>
<pre class="literal-block">
# setenforce &lt;mode&gt;
</pre>
<p>To make persistent changes, edit <tt class="docutils literal"><span class="pre">/etc/sysconfig/selinux</span></tt></p>
</div>
<div class="section" id="selinux-policy-types">
<h2><a class="toc-backref" href="#id160">SELinux Policy Types</a></h2>
<dl class="docutils">
<dt>Targeted (default)</dt>
<dd>Default policy set that aims to protect the most high-risk system services.</dd>
<dt>Strict</dt>
<dd>(Deprecated? Unable to find RHEL6 information about this policy type. Replaced by MLS?)</dd>
<dt>MLS</dt>
<dd>Implements Multi-Level Security policies -- a much stricter policy set than the default</dd>
<dt>Minimum</dt>
<dd>A less intrusive implementation of minimal aspects of SELinux</dd>
</dl>
<p>The RHCE exam will likely only be concerned with the default &quot;Targeted&quot; policy set.</p>
</div>
<div class="section" id="selinux-contexts">
<h2><a class="toc-backref" href="#id161">SELinux Contexts</a></h2>
<p>When SELinux is not disabled, every file, directory, and process has an SELinux context label.  These labels are used to determine which protected service(s) can operate in this location.</p>
<p>View SELinux contexts of processes:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">ps</span> <span class="pre">-eZ</span></tt>, <tt class="docutils literal"><span class="pre">ps</span> <span class="pre">-axZ</span></tt>, <tt class="docutils literal"><span class="pre">ps</span> <span class="pre">-Zc</span> <span class="pre">&lt;process</span> <span class="pre">name&gt;</span></tt>, etc.</blockquote>
<p>View SELinux contexts of files and directories:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">ls</span> <span class="pre">-Zd</span> <span class="pre">/path/to/dir/</span></tt>, <tt class="docutils literal"><span class="pre">ls</span> <span class="pre">-Z</span> <span class="pre">/path/to/file</span></tt>, etc.</blockquote>
<p>View SELinux contexts of users:</p>
<blockquote>
<tt class="docutils literal"><span class="pre">id</span> <span class="pre">-Z</span></tt></blockquote>
<!-- + * Set enforcing and permissive modes for SELinux -->
<!-- + * List and identify SELinux file and process context -->
<!-- + * Restore default file contexts -->
<!-- + * Use boolean settings to modify system SELinux settings -->
<!-- + * Diagnose and address routine SELinux policy violations -->
</div>
<div class="section" id="setting-selinux-file-contexts">
<h2><a class="toc-backref" href="#id162">Setting SELinux file contexts</a></h2>
<p>The initial contexts are created based on a set of rules, which are also used by <tt class="docutils literal"><span class="pre">restorecon</span></tt> to restore contexts to the default. When using the default &quot;targeted&quot; policy, these rules are stored in <tt class="docutils literal"><span class="pre">/etc/selinux/targeted/contexts/files/file_contexts</span></tt>. New customized rules are stored in <tt class="docutils literal"><span class="pre">/etc/selinux/targeted/contexts/files/file_contexts.local</span></tt>.</p>
<p>View these rules with:</p>
<pre class="literal-block">
# semanage fcontext -l
</pre>
<p>Or search for a specific service or path:</p>
<pre class="literal-block">
# semanage fcontext -l | grep &quot;/var/ftp&quot;
/var/ftp(/.*)?                                     all files           system_u:object_r:public_content_t:s0
/var/ftp/bin(/.*)?                                 all files          system_u:object_r:bin_t:s0
/var/ftp/etc(/.*)?                                 all files          system_u:object_r:etc_t:s0
/var/ftp/lib(64)?(/.*)?                            all files          system_u:object_r:lib_t:s0
/var/ftp/lib(64)?/ld[^/]*\.so(\.[^/]*)*            regular file       system_u:object_r:ld_so_t:s0
</pre>
<p>In these rules the regular expression <tt class="docutils literal"><span class="pre">(/.*)?</span></tt> is a match for the preceding directory and everything within it, recursively.</p>
<p>Add/delete/modify rules with:</p>
<pre class="literal-block">
#semanage fcontext -[a|d|m] -f &lt;ftype&gt; -t &lt;context&gt; '&lt;regex&gt;'
</pre>
</div>
<div class="section" id="selinux-booleans">
<h2><a class="toc-backref" href="#id163">SELinux Booleans</a></h2>
<p>SELinux uses a collection of boolean variables to allow users to change SELinux policy in pre-defined ways without the need to reload or recompile SELinux policies.</p>
<p>Show all booleans and their current values:</p>
<pre class="literal-block">
# getsebool -a
</pre>
<p>Show all booleans with current values and meanings:</p>
<pre class="literal-block">
# semanage boolean -l
</pre>
<p>Show a specific boolean value:</p>
<pre class="literal-block">
# getsebool &lt;boolean-name&gt;
</pre>
</div>
<div class="section" id="modifying-selinux-booleans">
<h2><a class="toc-backref" href="#id164">Modifying SELinux Booleans</a></h2>
<p>Modify a boolean non-persistently (for testing, or temporary use):</p>
<pre class="literal-block">
# setsebool &lt;variablename&gt; &lt;value&gt;
</pre>
<p>Modify a boolean persistently:</p>
<pre class="literal-block">
# setsebool -P &lt;variablename&gt; &lt;value&gt;
</pre>
<p>Use the graphical tool: <tt class="docutils literal"><span class="pre">system-config-selinux</span></tt></p>
</div>
<div class="section" id="help-for-selinux-with-regard-to-specific-services">
<h2><a class="toc-backref" href="#id165">Help for SELinux with regard to specific services</a></h2>
<p>Many targeted services have specialised man pages dealing with SELinux configuration.</p>
<p>Display these pages with:</p>
<pre class="literal-block">
# man -k '_selinux'
ftpd_selinux         (8)  - Security-Enhanced Linux policy for ftp daemons
httpd_selinux        (8)  - Security Enhanced Linux Policy for the httpd daemon
kerberos_selinux     (8)  - Security Enhanced Linux Policy for Kerberos
named_selinux        (8)  - Security Enhanced Linux Policy for the Internet Name server (named) daemon
nfs_selinux          (8)  - Security Enhanced Linux Policy for NFS
pam_selinux          (8)  - PAM module to set the default security context
rsync_selinux        (8)  - Security Enhanced Linux Policy for the rsync daemon
samba_selinux        (8)  - Security Enhanced Linux Policy for Samba
ypbind_selinux       (8)  - Security Enhanced Linux Policy for NIS
</pre>
</div>
<div class="section" id="monitor-selinux-violations">
<h2><a class="toc-backref" href="#id166">Monitor SELinux Violations</a></h2>
<p>Installing <tt class="docutils literal"><span class="pre">setroubleshoot-server</span></tt> sends SELinux error messages to <tt class="docutils literal"><span class="pre">/var/log/messages</span></tt>.  These can be further parsed with <tt class="docutils literal"><span class="pre">sealert</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">audit2why</span></tt> and <tt class="docutils literal"><span class="pre">audit2allow</span></tt> can be used to parse the messages in /var/log/audit/audit.log and explain why access was denied, and how to modify your configuration to allow it.</p>
</div>
</div>
<div class="section" id="session-6-virtualization">
<h1><a class="toc-backref" href="#id167">Session 6 Virtualization</a></h1>
<div class="section" id="virtualization-terms">
<h2><a class="toc-backref" href="#id168">Virtualization Terms</a></h2>
<dl class="docutils">
<dt>Physical Machine</dt>
<dd>The actual physical machine with RAM, disk space, etc.</dd>
<dt>Virtual Machine</dt>
<dd>A logical construct provided by hardware and/or software capabilities that can run an independent OS and perform work as though it were a physical machine.</dd>
<dt>Hypervisor</dt>
<dd>A specialized OS that provides virtual machines.</dd>
<dt>Xen</dt>
<dd>A hypervisor previously available on Red Hat operating systems that was implemented as a modified version of the Linux kernel.</dd>
<dt>KVM</dt>
<dd>Kernel Virtual Machine, the hypervisor Red Hat currently supports on RHEL6. It is implemented within (as a set of kernel modules) the mainstream Linux kernel.</dd>
<dt>Guest</dt>
<dd>The operating system that runs on a virtual machine.</dd>
<dt>Host</dt>
<dd>The operating system that runs on a physical machine hosting virtual machines (i.e. the hypervisor).</dd>
</dl>
</div>
<div class="section" id="rhel6-kvm-requirements">
<h2><a class="toc-backref" href="#id169">RHEL6 KVM requirements</a></h2>
<ul>
<li><p class="first">64-bit Intel or AMD processor</p>
<blockquote>
<p>To confirm, search <tt class="docutils literal"><span class="pre">/proc/cpuinfo</span></tt> for the string <tt class="docutils literal"><span class="pre">lm</span></tt> on the flags line.</p>
</blockquote>
</li>
<li><p class="first">CPU Hardware assisted virtualization extensions (enabled in BIOS)</p>
<blockquote>
<p>To confirm, search <tt class="docutils literal"><span class="pre">/proc/cpuinfo</span></tt> for the string <tt class="docutils literal"><span class="pre">vmx</span></tt> (for Intel) or <tt class="docutils literal"><span class="pre">svm</span></tt> (for AMD)</p>
</blockquote>
</li>
<li><p class="first">64-bit version of RHEL6</p>
<blockquote>
<p>To confirm, look for <tt class="docutils literal"><span class="pre">x86_64</span></tt> in the output of <tt class="docutils literal"><span class="pre">uname</span> <span class="pre">-m</span></tt>.</p>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="kvm-virtualization-components">
<h2><a class="toc-backref" href="#id170">KVM Virtualization Components</a></h2>
<ul class="simple">
<li>KVM kernel modules</li>
<li>libvirt</li>
<li><tt class="docutils literal"><span class="pre">virsh</span></tt> virtualization shell</li>
<li><tt class="docutils literal"><span class="pre">virt-manager</span></tt></li>
</ul>
</div>
<div class="section" id="installing-virtualization-capabilities">
<h2><a class="toc-backref" href="#id171">Installing Virtualization Capabilities</a></h2>
<dl class="docutils">
<dt>At OS Installation:</dt>
<dd>Select the <tt class="docutils literal"><span class="pre">Virtual</span> <span class="pre">Host</span></tt> server role --or-- customize packages and select the <tt class="docutils literal"><span class="pre">Virtualization</span></tt> package group. In a kickstart file, these packages can be installed as a group with the <tt class="docutils literal"><span class="pre">&#64;kvm</span></tt> group name.</dd>
<dt>After Installation:</dt>
<dd>With entitlement to the Virtualization packages, or access to them through a 3rd party repository,: <tt class="docutils literal"><span class="pre">yum</span> <span class="pre">install</span> <span class="pre">kvm</span></tt></dd>
</dl>
<p>Other recommended packages:</p>
<blockquote>
<ul class="simple">
<li>python-virtinst</li>
<li>libvirt</li>
<li>libvirt-python</li>
<li>virt-manager</li>
<li>libvirt-client</li>
</ul>
</blockquote>
</div>
<div class="section" id="virsh-commands">
<h2><a class="toc-backref" href="#id172">Virsh Commands</a></h2>
<p>Power on a virtual machine:</p>
<pre class="literal-block">
virsh start &lt;vm name&gt;
</pre>
<p>Gracefully shut down a virtual machine:</p>
<pre class="literal-block">
virsh shutdown &lt;vm name or id&gt;
</pre>
<p>Power off a virtual machine:</p>
<pre class="literal-block">
virsh destroy &lt;vm name or id&gt;
</pre>
<p>Connect to a virtual machine console (requires guest configuration):</p>
<pre class="literal-block">
virsh console &lt;vm name or id&gt;
</pre>
<p>Disconnect from a console of a virtual machine:</p>
<pre class="literal-block">
^]  ( &quot;ctrl + ]&quot; )
</pre>
<p>Set a VM to start at boot:</p>
<pre class="literal-block">
virsh autostart &lt;vm name or id&gt;
</pre>
</div>
<div class="section" id="creating-virtual-machines-with-virt-manager">
<h2><a class="toc-backref" href="#id173">Creating Virtual Machines with Virt-Manager</a></h2>
<p>Demonstrated and practiced in the classroom.</p>
</div>
<div class="section" id="creating-virtual-machines-with-virt-install">
<h2><a class="toc-backref" href="#id174">Creating Virtual Machines with virt-install</a></h2>
<p><tt class="docutils literal"><span class="pre">virt-install</span></tt> is a command-line tool used to create virtual machines.</p>
<p>See the syntax with <tt class="docutils literal"><span class="pre">man</span> <span class="pre">virt-install</span></tt> or <tt class="docutils literal"><span class="pre">virt-install</span> <span class="pre">--help</span></tt>.</p>
<p>Sample command:</p>
<pre class="literal-block">
# virt-install --name StXVM3 --ram 768 \
--disk path=/var/lib/libvirt/images/StXVM3disk1.img,size=8\
--network network=default --cdrom /dev/cdrom
</pre>
</div>
<div class="section" id="selinux-considerations">
<h2><a class="toc-backref" href="#id175">SELinux considerations</a></h2>
<ul class="simple">
<li>SELinux expects file-based guest images to be stored in <tt class="docutils literal"><span class="pre">/var/lib/libvirt/images/</span></tt>. Use of other locations with SELinux enforcing will require adding the location to the SELinux policies.</li>
</ul>
<ol class="arabic">
<li><p class="first">Find the context applied to the expected location:</p>
<pre class="literal-block">
# ll -Z /var/lib/libvirt/

drwx--x--x. root root system_u:object_r:virt_image_t:s0 images
</pre>
</li>
<li><p class="first">Add a new context policy:</p>
<pre class="literal-block">
# semanage fcontext -a -t virt_image_t &quot;/virtstorage(/.*)?&quot;
</pre>
</li>
<li><p class="first">Set the context to match the newly created policy:</p>
<pre class="literal-block">
# restorecon -R -v /virtstorage/
restorecon reset /virtstorage context unconfined_u:object_r:
default_t:s0-&gt;system_u:object_r:virt_image_t:s0
</pre>
</li>
</ol>
<!-- o KVM Virtualization -->
<!-- + * Configure a physical machine to host virtual guests -->
<!-- + * Install Red Hat Enterprise Linux systems as virtual guests -->
<!-- + * Configure systems to launch virtual machines at boot -->
<!-- + * Install Red Hat Enterprise Linux automatically using Kickstart -->
</div>
</div>
<div class="section" id="session-7-logging-and-remote-access">
<h1><a class="toc-backref" href="#id176">Session 7 Logging and remote access</a></h1>
<div class="section" id="rhel-6-logging-with-rsyslog">
<h2><a class="toc-backref" href="#id177">RHEL 6 Logging with Rsyslog</a></h2>
<p>Red Hat uses <tt class="docutils literal"><span class="pre">rsyslog</span></tt> for its logging facility.  <tt class="docutils literal"><span class="pre">rsyslog</span></tt> can be configured to for local logging only, to send log messages to a remote destination as well, and to recieve log messages from other systems as well.</p>
<p><strong>Terms</strong></p>
<dl class="docutils">
<dt>facility</dt>
<dd>A name that indicates what the message concerns or from what service it originates.</dd>
<dt>priority</dt>
<dd>A name that indicates the importance of the messages in that category.</dd>
</dl>
<p>The man pages for logger(1) and syslog(3) have more information.</p>
<p><tt class="docutils literal"><span class="pre">rsyslog</span></tt> is configured in <tt class="docutils literal"><span class="pre">/etc/rsyslog.conf</span></tt> and defaults to using port 514 (TCP or UDP) to send and receive messages.</p>
</div>
<div class="section" id="accepting-remote-logs">
<h2><a class="toc-backref" href="#id178">Accepting Remote Logs</a></h2>
<p>By default, <tt class="docutils literal"><span class="pre">rsyslog</span></tt> is configured for only local logging.  To enable it to receive log messages from other systems, uncomment one of the following groups of lines in the config file (depending on which transport protocol, tcp or udp, you prefer to use):</p>
<p>For UDP (more widely supported but less reliable):</p>
<pre class="literal-block">
# Provides UDP syslog reception
#$ModLoad imudp.so
#$UDPServerRun 514
</pre>
<p>For TCP (less widely supported but more reliable):</p>
<pre class="literal-block">
# Provides TCP syslog reception
#$ModLoad imtcp.so
#$InputTCPServerRun 514
</pre>
<p>After changing the appropriate lines, restart the service.</p>
</div>
<div class="section" id="rsyslog-configuration-message-selection">
<h2><a class="toc-backref" href="#id179">Rsyslog Configuration: Message Selection</a></h2>
<p>In <tt class="docutils literal"><span class="pre">/etc/rsyslog.conf</span></tt> in the &quot;RULES&quot; section, ensure that a rule exists (or write one) for the kind of messages you want to send.  The format is:</p>
<pre class="literal-block">
&lt;facility&gt;.&lt;priority&gt;        &lt;action&gt;
</pre>
<dl class="docutils">
<dt>facility</dt>
<dd>One of: auth, authpriv, cron, daemon, kern, lpr, mail, news, syslog, user, uucp, local0-7, or &quot;*&quot;</dd>
<dt>priority</dt>
<dd>One of (in ascending priority): debug, info, notice, warning (warn), err (error), crit, alert, emerg (panic), none, or &quot;*&quot;</dd>
</dl>
<ul>
<li><p class="first">Multiple facilities can be specified with the same priority with the use of a comma.</p>
<blockquote>
<pre class="literal-block">
uucp,news.crit       /var/log/spooler
</pre>
</blockquote>
</li>
<li><p class="first">Multiple selectors (facility/priority pairs) can be specified for the same action with the use of a semicolon.</p>
<blockquote>
<pre class="literal-block">
*.info;mail.none;authpriv.none;cron.none   /var/log/messages
</pre>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="rsyslog-configuration-actions">
<h2><a class="toc-backref" href="#id180">Rsyslog Configuration: Actions</a></h2>
<dl class="docutils">
<dt>action</dt>
<dd><p class="first">One of the following:</p>
<blockquote class="last">
<ul class="simple">
<li>A file, specified with a full path name.</li>
<li>A named pipe (fifo)</li>
<li>A terminal (tty) or console</li>
<li>A remote machine's IP or hostname, prefaced with &quot;&#64;&quot; (for UDP), &quot;&#64;&#64;&quot; (for TCP), or &quot;:omrelp:&quot; for the RELP protocol.</li>
<li>A list of users (comma-delimited). This notifies them via console message if they are logged in. An asterisk (*) includes all logged-in users</li>
<li>A tilde, to indicate that these messages should be discarded.</li>
<li>See the documentation for others.</li>
</ul>
</blockquote>
</dd>
</dl>
</div>
<div class="section" id="practice">
<h2><a class="toc-backref" href="#id181">Practice</a></h2>
<p>Configure one system to receive remote log messages.  Configure the other to log only a particular facility or priority to the remote syslog server.</p>
<p>Use <tt class="docutils literal"><span class="pre">logger</span></tt> to generate test messages.</p>
<p>Remember to investigate firewall and SELinux considerations.</p>
<!-- o + - Remote Logging -->
<!-- + *..  Configure a system to log to a remote system -->
<!-- + * Configure a system to accept logging from a remote system -->
<!-- o + - Remote Access -->
<!-- iptables -I INPUT {x} -p udp -m udp - -dport 514 -j ACCEPT -->
</div>
<div class="section" id="remote-access-via-ssh">
<h2><a class="toc-backref" href="#id182">Remote Access via SSH</a></h2>
<p>RedHat installs by default both the OpenSSH client package (openssh) and the server package (openssh-server)</p>
<p>Client behavior is configured in <tt class="docutils literal"><span class="pre">/etc/ssh/ssh_config</span></tt></p>
<p>Server behavior is configured in <tt class="docutils literal"><span class="pre">/etc/ssh/sshd_config</span></tt></p>
<p>Start the service:</p>
<pre class="literal-block">
# service sshd start
</pre>
<p>Configure it persistently on:</p>
<pre class="literal-block">
# chkconfig sshd on
</pre>
</div>
<div class="section" id="investigate-selinux-implications-for-ssh">
<h2><a class="toc-backref" href="#id183">Investigate SELinux implications for SSH</a></h2>
<p>Find SELinux Filesystem contexts that might affect ssh:</p>
<pre class="literal-block">
semanage fcontext -l | grep &quot;ssh&quot;
</pre>
<p>Find SELinux port contexts that might affect ssh:</p>
<pre class="literal-block">
semanage port -l | grep &quot;ssh&quot;
</pre>
<p>Find SELinux booleans that might affect ssh:</p>
<pre class="literal-block">
getsebool -a | grep ssh
</pre>
</div>
<div class="section" id="ssh-key-based-authentication">
<h2><a class="toc-backref" href="#id184">SSH key-based authentication</a></h2>
<p>Generate a key with <tt class="docutils literal"><span class="pre">ssh-keygen</span></tt></p>
<p>Transmit a key to a remote system with <tt class="docutils literal"><span class="pre">ssh-copy-id</span></tt></p>
<blockquote>
<ul class="simple">
<li>The key you want is usually named <tt class="docutils literal"><span class="pre">~/.ssh/id_rsa.pub</span></tt>.  Be certain to use the .pub version of the key instead of the private key!</li>
</ul>
</blockquote>
</div>
<div class="section" id="ssh-security-considerations">
<h2><a class="toc-backref" href="#id185">SSH Security Considerations</a></h2>
<dl class="docutils">
<dt>Allow root logins?</dt>
<dd>Disallow with <tt class="docutils literal"><span class="pre">PermitRootLogin</span> <span class="pre">no</span></tt> in <tt class="docutils literal"><span class="pre">/etc/ssh/sshd_config</span></tt></dd>
<dt>Listen on specific interfaces?</dt>
<dd>Specify with <tt class="docutils literal"><span class="pre">ListenAddress</span> <span class="pre">x.x.x.x</span></tt> in <tt class="docutils literal"><span class="pre">/etc/ssh/sshd_config</span></tt></dd>
<dt>Allow legacy versions?</dt>
<dd>Specify allowed versions of the protocol in <tt class="docutils literal"><span class="pre">/etc/ssh/sshd_config</span></tt> (read comments).</dd>
<dt>Allow X11 forwarding?</dt>
<dd>Configure with <tt class="docutils literal"><span class="pre">X11Forwarding</span> <span class="pre">yes|no</span></tt> in <tt class="docutils literal"><span class="pre">/etc/ssh/sshd_config</span></tt></dd>
<dt>Specify alternate port?</dt>
<dd>Configure with <tt class="docutils literal"><span class="pre">Port</span> <span class="pre">xx</span></tt> in <tt class="docutils literal"><span class="pre">/etc/ssh/sshd_config</span></tt>. Multiple ports on multiple lines accepted. Don't forget firewall and SELinux implications though!</dd>
</dl>
<!-- # * Install the packages needed to provide the service -->
<!-- # * Configure SELinux to support the service -->
<!-- # * Configure the service to start when the system is booted -->
<!-- # * Configure the service for basic operation -->
<!-- # * Configure host-based and user-based security for the service -->
<!-- # * Configure key-based authentication -->
<!-- # * Configure additional SSH options described in documentation -->
</div>
<div class="section" id="remote-access-via-vnc">
<h2><a class="toc-backref" href="#id186">Remote Access via VNC</a></h2>
<p>For remote management when a GUI is desired or required, Red Hat provides VNC services through tigervnc.</p>
<p>Install the package with <tt class="docutils literal"><span class="pre">yum</span> <span class="pre">-y</span> <span class="pre">install</span> <span class="pre">tigervnc-server</span></tt>.</p>
<p>Configure the service at /etc/sysconfig/vncservers</p>
<p>Start the service:</p>
<pre class="literal-block">
# service vncserver start
</pre>
<p>Configure it persistently on:</p>
<pre class="literal-block">
# chkconfig vncserver on
</pre>
</div>
<div class="section" id="configuring-a-vnc-remote-display">
<h2><a class="toc-backref" href="#id187">Configuring a VNC remote display</a></h2>
<p>In <tt class="docutils literal"><span class="pre">/etc/sysconfig/vncservers</span></tt> uncomment and modify the lines below:</p>
<pre class="literal-block">
# VNCSERVERS=&quot;2:myusername&quot;
# VNCSERVERARGS[2]=&quot;-geometry 800x600 -nolisten tcp -localhost&quot;
</pre>
<!-- Multiple VNC servers can be configured on the same line, space-delimited, but each one requires its own set of vncserverargs on a separate line. -->
<p>As the user who will connect, set a VNC password with <tt class="docutils literal"><span class="pre">vncpasswd</span></tt>.</p>
<p>Start or restart the service.</p>
<p>Connect to the remote system using a vnc client with the <tt class="docutils literal"><span class="pre">-via</span></tt> option:</p>
<pre class="literal-block">
vncviewer localhost:&lt;x&gt; -via y.y.y.y
</pre>
<!--  -->
<blockquote>
Where X is the display number and y.y.y.y is the IP address of the remote machine.</blockquote>
</div>
<div class="section" id="investigate-selinux-implications-for-vnc">
<h2><a class="toc-backref" href="#id188">Investigate SELinux implications for VNC</a></h2>
<p>Find SELinux Filesystem contexts that might affect vnc:</p>
<pre class="literal-block">
# semanage fcontext -l | grep &quot;vnc&quot;
</pre>
<p>Find SELinux port contexts that might affect vnc:</p>
<pre class="literal-block">
# semanage port -l | grep &quot;vnc&quot;
</pre>
<p>Find SELinux booleans that might affect vnc:</p>
<pre class="literal-block">
# getsebool -a | grep vnc
</pre>
<!-- # * Install the packages needed to provide the service -->
<!-- # * Configure SELinux to support the service -->
<!-- # * Configure the service to start when the system is booted -->
<!-- # * Configure the service for basic operation -->
<!-- # * Configure host-based and user-based security for the service -->
</div>
</div>
<div class="section" id="session-8-network-time-protocol-and-system-performance-reports">
<h1><a class="toc-backref" href="#id189">Session 8 Network Time Protocol and System Performance Reports</a></h1>
<div class="section" id="ntp-overview">
<h2><a class="toc-backref" href="#id190">NTP Overview</a></h2>
<p>NTP (Network Time Protocol) provides a standardized way for systems to provide and obtain correct time over the network.</p>
<p>This service is increasingly critical for today's networking environments.  Synchronized time information is required for accurate handling of email, for clustering, for cloud computing, and for virtualization (just to name a few).</p>
</div>
<div class="section" id="ntp-packages">
<h2><a class="toc-backref" href="#id191">NTP Packages</a></h2>
<dl class="docutils">
<dt>ntp</dt>
<dd>Provides the daemon and utilities</dd>
<dt>system-config-date</dt>
<dd>Provides a graphical interface for changing the time and configuring an NTP client.</dd>
<dt>ntpdate</dt>
<dd>Provides a command line utility for setting the date and time with NTP</dd>
</dl>
</div>
<div class="section" id="ntp-documentation">
<h2><a class="toc-backref" href="#id192">NTP Documentation</a></h2>
<p>Many man pages:</p>
<blockquote>
<p>ntp.conf (5)</p>
<p>ntp_misc (5)</p>
<p>ntp_acc (5)</p>
<p>ntp_auth (5)</p>
<p>ntp_clock (5)</p>
<p>ntp_mon (5)</p>
<p>ntpd (8)</p>
</blockquote>
</div>
<div class="section" id="installing-starting-and-configuring-persistence">
<h2><a class="toc-backref" href="#id193">Installing, Starting, and Configuring Persistence</a></h2>
<p>Install the service (likely already installed):</p>
<pre class="literal-block">
# yum -y install ntp
</pre>
<p>Starting the service:</p>
<pre class="literal-block">
# service ntpd start
</pre>
<p>Configuring it to be on persistently:</p>
<pre class="literal-block">
# chkconfig ntpd on
</pre>
</div>
<div class="section" id="defining-ntp-terms">
<h2><a class="toc-backref" href="#id194">Defining NTP Terms</a></h2>
<dl class="docutils">
<dt>Stratum0</dt>
<dd>A clock device such as an atomic, radio, or GPS clock device. Not usually attached to the network but connected to a server.</dd>
<dt>Stratum1</dt>
<dd>A server attached to a high accuracy time device that also allows queries for its time information.</dd>
<dt>Stratum{2..16}</dt>
<dd>Servers that acquire time information from servers above them in the hierarchy and share that information with peers or clients.</dd>
<dt>Server (in ntp.conf)</dt>
<dd>A time server that is a more authoritative time-source (higher stratum) than the system being configured, and from which this system obtains time information.</dd>
<dt>Peer (in ntp.conf)</dt>
<dd>A time server that is considered equally authoritative (same stratum) with the system being configured, and with which this system shares time information.</dd>
</dl>
</div>
<div class="section" id="configuration-of-ntp">
<h2><a class="toc-backref" href="#id195">Configuration of NTP</a></h2>
<p>Configured in <tt class="docutils literal"><span class="pre">/etc/ntp.conf</span></tt></p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">restrict</span></tt> lines</dt>
<dd>Define the access to be allowed or restricted for other hosts that communicate with this service. Each server or peer configured must be included in a <tt class="docutils literal"><span class="pre">restrict</span></tt> line.</dd>
<dt><tt class="docutils literal"><span class="pre">server</span></tt> lines</dt>
<dd>Define a host to be queried as a more authoritative time source.</dd>
<dt><tt class="docutils literal"><span class="pre">peer</span></tt> lines</dt>
<dd>Define a host to be queried as an equally authoritative time source.</dd>
<dt><tt class="docutils literal"><span class="pre">broadcast</span></tt> or <tt class="docutils literal"><span class="pre">multicast</span></tt> lines</dt>
<dd>Define ways to obtain or provide time information apart from unicast queries.</dd>
</dl>
</div>
<div class="section" id="ntp-restrict-options">
<h2><a class="toc-backref" href="#id196">NTP &quot;restrict&quot; options</a></h2>
<pre class="literal-block">
restrict &lt;address&gt; [mask &lt;subnet mask&gt; ] [flag] [flag] ...
</pre>
<dl class="docutils">
<dt>address and optional mask</dt>
<dd>The address, in dotted-quad notation, of the host or network to be restricted. Alternatively, the address can be a valid DNS name.</dd>
<dt>ignore (flag)</dt>
<dd>Disallows all packets</dd>
<dt>kod (flag)</dt>
<dd>Sends a &quot;kiss of death&quot; packet to misbehaving (usually fire-walled) clients.</dd>
<dt>nomodify (flag)</dt>
<dd>Allows queries for information, but denies attempts to modify the time.</dd>
<dt>noquery (flag)</dt>
<dd>Deny ntpq and ntpdc queries. The time service is unaffected.</dd>
<dt>nopeer (flag)</dt>
<dd>Deny packets related to peering</dd>
<dt>notrap  (flag)</dt>
<dd>Deny &quot;trap&quot; messages (used in logging).</dd>
</dl>
</div>
<div class="section" id="configure-as-a-client">
<h2><a class="toc-backref" href="#id197">Configure as a Client</a></h2>
<ol class="arabic">
<li><p class="first">Include at least one server (three are preferred) in <tt class="docutils literal"><span class="pre">/etc/ntp.conf</span></tt>:</p>
<pre class="literal-block">
server &lt;server1 IP&gt; iburst
server &lt;server2 IP&gt; iburst
</pre>
</li>
<li><p class="first">With the ntp service stopped, synchronize time with ntpdate:</p>
<pre class="literal-block">
# ntpdate -v &lt;IP of ntp server&gt;
</pre>
</li>
<li><p class="first">Start the ntp service.</p>
</li>
<li><p class="first">Verify that the service sees the configured servers (this may take a few minutes):</p>
<pre class="literal-block">
# ntpq -p
</pre>
</li>
</ol>
</div>
<div class="section" id="configure-as-a-server">
<h2><a class="toc-backref" href="#id198">Configure as a Server</a></h2>
<ol class="arabic">
<li><p class="first">Follow the steps for Client Configuration.</p>
</li>
<li><p class="first">Add one or more restrict lines to allow appropriate access from those systems that will be clients (or peers):</p>
<pre class="literal-block">
restrict 10.37.112.0 mask 255.255.240.0 nomodify notrap
restrict 10.37.112.13
</pre>
</li>
<li><p class="first">Restart the service after making changes.</p>
</li>
</ol>
</div>
<div class="section" id="configure-as-a-peer">
<h2><a class="toc-backref" href="#id199">Configure as a Peer</a></h2>
<ol class="arabic">
<li><p class="first">Follow the steps for Client Configuration</p>
</li>
<li><p class="first">Add one or more restrict lines to allow appropriate access from those systems that will be clients (or peers):</p>
<pre class="literal-block">
restrict 10.37.112.0 mask 255.255.240.0 nomodify notrap
restrict 10.37.112.13
</pre>
</li>
<li><p class="first">Add one or more peer lines:</p>
<pre class="literal-block">
peer &lt;peer IP or hostname&gt; [options]
</pre>
</li>
<li><p class="first">Restart the service after making changes.</p>
</li>
<li><p class="first">Verify that the service sees the configured peers and servers (this may take a few minutes):</p>
<pre class="literal-block">
# ntpq -p
</pre>
</li>
</ol>
</div>
<div class="section" id="investigate-selinux-implications-for-ntp">
<h2><a class="toc-backref" href="#id200">Investigate SELinux implications for NTP</a></h2>
<p>Find SELinux Filesystem contexts that might affect NTP:</p>
<pre class="literal-block">
# semanage fcontext -l | grep &quot;ntp&quot;
</pre>
<p>Find SELinux port contexts that might affect NTP:</p>
<pre class="literal-block">
# semanage port -l | grep &quot;ntp&quot;
</pre>
<p>Find SELinux booleans that might affect NTP:</p>
<pre class="literal-block">
# semanage boolean -l | grep ntp
</pre>
</div>
<div class="section" id="investigate-firewall-implications-for-ntp">
<h2><a class="toc-backref" href="#id201">Investigate Firewall Implications for NTP</a></h2>
<p>Find ports that may need to be opened for NTP:</p>
<pre class="literal-block">
# grep ntp /etc/services
</pre>
<p>Rules to open up the required ports:</p>
<pre class="literal-block">
-A INPUT -m state --state NEW -m tcp -p tcp --dport 123 -j ACCEPT
-A INPUT -m state --state NEW -m udp -p udp --dport 123 -j ACCEPT
</pre>
<!-- NTP -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service.. -->
</div>
<div class="section" id="reporting-on-system-performance">
<h2><a class="toc-backref" href="#id202">Reporting on System Performance</a></h2>
<p>One of the more vague of the RHCE Objectives says: &quot;Produce and deliver reports on system utilization (processor, memory, disk, and network).&quot;</p>
<p>This loosely defined objective can be very wide-ranging -- this section will cover some of the tools that might be useful in meeting it.</p>
</div>
<div class="section" id="tools-for-system-utilization-reporting">
<h2><a class="toc-backref" href="#id203">Tools for System Utilization Reporting</a></h2>
<dl class="docutils">
<dt>df</dt>
<dd>&quot;diskfree&quot;, reports on disk space utilization for all mounted filesystems. Part of the coreutils package.</dd>
<dt>iostat</dt>
<dd>Provided by the sysstat package.</dd>
<dt>vmstat</dt>
<dd>Provided by the procps package.</dd>
<dt>top</dt>
<dd>Provided by the procps package.</dd>
</dl>
<p>Explore the man pages for these utilities and be prepared to use them with scripting to write reports to a file.</p>
</div>
</div>
<div class="section" id="session-9-http-and-ftp">
<h1><a class="toc-backref" href="#id204">Session 9 HTTP and FTP</a></h1>
<div class="section" id="apache-web-server">
<h2><a class="toc-backref" href="#id205">Apache Web Server</a></h2>
<p>Service name: httpd</p>
<p>Package name: httpd-{ver}.{arch}.rpm</p>
<p>Main config: /etc/httpd/conf/httpd.conf</p>
<p>Module config: /etc/httpd/conf.d</p>
<p>Default DocRoot: /var/www/html</p>
</div>
<div class="section" id="installation-and-basic-configuration">
<h2><a class="toc-backref" href="#id206">Installation and Basic Configuration</a></h2>
<ol class="arabic">
<li><p class="first">Install the <tt class="docutils literal"><span class="pre">web-server</span></tt> package group:</p>
<blockquote>
<pre class="literal-block">
# yum groupinstall web-server
</pre>
<!--  -->
<p>Note that this install several packages including the Apache Manual which is then locally accessible at <a class="reference external" href="http://localhost/manual">http://localhost/manual</a></p>
</blockquote>
</li>
<li><p class="first">Install the <tt class="docutils literal"><span class="pre">mod_ssl</span></tt> package:</p>
<pre class="literal-block">
# yum install mod_ssl
</pre>
</li>
<li><p class="first">Start and configure persistence:</p>
<pre class="literal-block">
# service httpd start; chkconfig httpd on
</pre>
</li>
</ol>
<!--  -->
<blockquote>
In this default configuration, you can create an <tt class="docutils literal"><span class="pre">index.html</span></tt> page in <tt class="docutils literal"><span class="pre">/var/www/html/</span></tt> and it will be served out as your home page. Additionally, you can use <a class="reference external" href="https://">https://</a> to connect securely to your webserver, but you will have to manually accept a self-signed certificate.</blockquote>
</div>
<div class="section" id="installing-a-signed-ssl-certificate">
<h2><a class="toc-backref" href="#id207">Installing a Signed SSL Certificate</a></h2>
<ol class="arabic">
<li><p class="first">Place the certificate and private key in the appropriate locations in <tt class="docutils literal"><span class="pre">/etc/pki/tls/</span></tt>.</p>
</li>
<li><p class="first">Ensure that both files have the <tt class="docutils literal"><span class="pre">cert_t</span></tt> SELinux file context and that the private key is readable only by root.</p>
</li>
<li><p class="first">Modify <tt class="docutils literal"><span class="pre">/etc/httpd/conf.d/ssl.conf</span></tt>:</p>
<blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">SSLCertificateFile</span></tt> points to your newly installed certificate.</li>
<li><tt class="docutils literal"><span class="pre">SSLCertificateKeyFile</span></tt> points to the corresponding private key.</li>
</ul>
</blockquote>
</li>
<li><p class="first">Restart the service.</p>
<blockquote>
<p>Now your website will present a certificate signed by an accepted CA.</p>
</blockquote>
</li>
</ol>
</div>
<div class="section" id="virtual-host-configuration">
<h2><a class="toc-backref" href="#id208">Virtual Host Configuration</a></h2>
<p>&quot;Virtual Hosts&quot; come in two forms:</p>
<blockquote>
<dl class="docutils">
<dt>Standard Virtual Hosts</dt>
<dd>Exist on hosts that have been assigned multiple IP addresses. Queries for each separate IP address are served pages from a particular virtual host.</dd>
<dt>Name Virtual Hosts</dt>
<dd>Exist on hosts with multiple names aliased to one IP address (usually through DNS aliases, but can also be accomplished with <tt class="docutils literal"><span class="pre">/etc/hosts</span></tt>). Queries for each separate name (regardless of IP address) are served as different virtual hosts.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="name-virtual-host-configuration">
<h2><a class="toc-backref" href="#id209">Name Virtual Host Configuration</a></h2>
<p>Near the end of httpd.conf, uncomment the line:</p>
<pre class="literal-block">
#NameVirtualHost *:80
</pre>
<p>Create a section for each vhost:</p>
<pre class="literal-block">
#&lt;VirtualHost *:80&gt;
#    ServerAdmin webmaster&#64;dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
#&lt;/VirtualHost&gt;
</pre>
<ul class="simple">
<li>Uncomment the first and last lines in that block.  Uncomment and modify the lines for ServerName, DocumentRoot, and others that you want to customize.</li>
<li>Include a Vhost stanza for your default server instance and for each alternate name.</li>
</ul>
</div>
<div class="section" id="example-virtual-host-configuration">
<h2><a class="toc-backref" href="#id210">Example Virtual Host Configuration</a></h2>
<img alt="images/VirtHostConf.png" src="images/VirtHostConf.png" style="width: 90%;" />
</div>
<div class="section" id="configuring-for-cgi-bin-scripts">
<h2><a class="toc-backref" href="#id211">Configuring for CGI-BIN scripts</a></h2>
<p>Refer to the Apache Manual (package: httpd-manual) for full details and a tutorial on <em>CGI: Dynamic Content</em>.</p>
<p>The <tt class="docutils literal"><span class="pre">ScriptAlias</span></tt> line in <tt class="docutils literal"><span class="pre">httpd.conf</span></tt> designates the directory in which Apache expects to find CGI scripts.</p>
<p>CGI scripts can be implemented in directories <strong>outside</strong> of the <tt class="docutils literal"><span class="pre">DocumentRoot</span></tt> path -- but this will require modification of the <tt class="docutils literal"><span class="pre">ScriptAlias</span></tt> line and the fcontext rules for SELinux.</p>
</div>
<div class="section" id="apache-access-control">
<h2><a class="toc-backref" href="#id212">Apache Access Control</a></h2>
<p>Per-directory options (example):</p>
<pre class="literal-block">
&lt;Directory /var/www/&gt;
    Order Deny,Allow
    Deny from all
    Allow from dev.example.com
&lt;/Directory&gt;
</pre>
<ul>
<li><p class="first">Three-pass access control:</p>
<blockquote>
<ol class="arabic simple">
<li>Parse all statements of type specified first.</li>
<li>Parse all statements of type specified second. Matches overrides matches of previous type.</li>
<li>Process requests which matched nothing.</li>
</ol>
</blockquote>
</li>
<li><p class="first">In <tt class="docutils literal"><span class="pre">Order</span></tt> statements, whichever directive comes <strong>last</strong> is the default in case of no match.</p>
</li>
</ul>
</div>
<div class="section" id="host-based-security-directive-formats">
<h2><a class="toc-backref" href="#id213">Host Based Security directive formats</a></h2>
<p><tt class="docutils literal"><span class="pre">Deny</span> <span class="pre">from</span> <span class="pre">example.com</span></tt></p>
<p><tt class="docutils literal"><span class="pre">Allow</span> <span class="pre">from</span> <span class="pre">192.168.0.15</span></tt></p>
<p><tt class="docutils literal"><span class="pre">Deny</span> <span class="pre">from</span> <span class="pre">192.168.0.0/255.255.255.0</span></tt></p>
<p><tt class="docutils literal"><span class="pre">Deny</span> <span class="pre">from</span> <span class="pre">192.168.1.0/24</span></tt></p>
</div>
<div class="section" id="access-control-with-htaccess-files">
<h2><a class="toc-backref" href="#id214">Access Control with .htaccess files</a></h2>
<p>If permitted by httpd.conf, access may be controlled on a per-directory basis with <tt class="docutils literal"><span class="pre">.htaccess</span></tt> files in the directories where the content needs to be protected:</p>
<pre class="literal-block">
&lt;Files ~ &quot;^\.ht&quot;&gt;
    Order allow,deny
    Allow from 192.168.5.200
    Deny from all
&lt;/Files&gt;
</pre>
</div>
<div class="section" id="user-based-security-with-htpasswd-flat-file">
<h2><a class="toc-backref" href="#id215">User Based Security with htpasswd flat file</a></h2>
<pre class="literal-block">
&lt;Directory &quot;/var/www/html/site&quot;&gt;
  AuthType Basic
  AuthName &quot;Password Protected&quot;
  AuthUserFile /etc/httpd/.htpasswd
  Require valid-user
&lt;/Directory&gt;
</pre>
</div>
<div class="section" id="configuring-passwords">
<h2><a class="toc-backref" href="#id216">Configuring Passwords</a></h2>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">htpasswd</span> <span class="pre">-cm</span> <span class="pre">/etc/httpd/.htpasswd</span> <span class="pre">good_user</span></tt></li>
<li><tt class="docutils literal"><span class="pre">htpasswd</span> <span class="pre">-m</span> <span class="pre">/etc/httpd/.htpasswd</span> <span class="pre">another_user</span></tt></li>
</ul>
</div>
<div class="section" id="user-based-security-with-ldap-authentication">
<h2><a class="toc-backref" href="#id217">User Based Security with LDAP authentication</a></h2>
<ol class="arabic">
<li><p class="first">Obtain the LDAP certificate.</p>
</li>
<li><p class="first">Add a line to your http.conf (usually in your Vhost definition):</p>
<pre class="literal-block">
LDAPTrustedGlobalCert CA_BASE64 /path/to/cert
</pre>
</li>
<li><p class="first">Configure a Directory Block:</p>
<pre class="literal-block">
&lt;Directory /var/www/html/private&gt;
    AuthName &quot;Private with LDAP access&quot;
    AuthType  basic
    AuthBasicProvider ldap
    AuthLDAPUrl &quot;ldap://fqdn/prefix&quot; TLS
    Require valid-user
&lt;/Directory&gt;
</pre>
</li>
</ol>
<!--  -->
<blockquote>
Modify the cert path, and the FQDN and prefix of the LDAP Server to match your infrastructure.</blockquote>
</div>
<div class="section" id="selinux-implications-for-http">
<h2><a class="toc-backref" href="#id218">SELinux Implications for HTTP</a></h2>
<p>Find SELinux Filesystem contexts that might affect HTTP:</p>
<pre class="literal-block">
# semanage fcontext -l | grep &quot;http&quot;
</pre>
<p>Find SELinux port contexts that might affect HTTP:</p>
<pre class="literal-block">
# semanage port -l | grep &quot;http&quot;
</pre>
<p>Find SELinux booleans that might affect HTTP:</p>
<pre class="literal-block">
# semanage boolean -l | grep http
</pre>
<p>Read the man page <tt class="docutils literal"><span class="pre">httpd_selinux</span> <span class="pre">(8)</span></tt></p>
<p>Make SELinux more verbose:</p>
<pre class="literal-block">
# semanage dontaudit off
</pre>
<!--  -->
<blockquote>
This disables setroubleshoot-server, sealert, and the issuing of SELinux messages into <tt class="docutils literal"><span class="pre">/var/log/messages</span></tt> -- so you'll need to view the messages in <tt class="docutils literal"><span class="pre">/var/log/audit/audit.log</span></tt>.</blockquote>
<!-- # sealert -a /var/log/audit/audit.log -H > audit.html -->
</div>
<div class="section" id="important-selinux-contexts">
<h2><a class="toc-backref" href="#id219">Important SELinux Contexts</a></h2>
<dl class="docutils">
<dt>httpd_sys_content_t</dt>
<dd>For general files and directories to be served by httpd.</dd>
<dt>httpd_sys_script_exec_t</dt>
<dd>For scripts (CGI) to be executed by the web server.</dd>
<dt>public_content_t</dt>
<dd>For files that are to be shared with other SELinux protected services</dd>
</dl>
</div>
<div class="section" id="firewall-and-selinux-for-httpd">
<h2><a class="toc-backref" href="#id220">Firewall and SELinux for httpd</a></h2>
<!-- o HTTP(s) -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service -->
<!-- + * Configure a virtual host -->
<!-- + * Configure private directories -->
<!-- + * Deploy a basic CGI application -->
<!-- + * Configure group-managed content -->
</div>
<div class="section" id="very-secure-file-transfer-protocol-daemon">
<h2><a class="toc-backref" href="#id221">Very Secure File Transfer Protocol Daemon</a></h2>
<p><tt class="docutils literal"><span class="pre">vsftpd</span></tt> is Red Hat's preferred FTP daemon.  The &quot;Very Secure&quot; descriptor refers to the daemon and not to the protocol!</p>
<p>The only mention of FTP in the RHCSA objectives is concerned with enabling a default configuration</p>
<p>The only mention of FTP in the RHCE objectives is concerned with securely configuring anonymous access.</p>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id222">Installation and Basic Configuration</a></h2>
<p>Package: vsftpd</p>
<p>Install:</p>
<pre class="literal-block">
# yum -y install vsftpd
</pre>
<p>Start and Configure Persistence:</p>
<pre class="literal-block">
# service vsftpd start; chkconfig vsftpd on
</pre>
<p>In this default configuration, anonymous downloads are allowed from <tt class="docutils literal"><span class="pre">/pub</span></tt> (as shown to the client) and are placed in <tt class="docutils literal"><span class="pre">/var/ftp/pub/</span></tt> (as viewed on the server). Additionally, system users are able to login by username and password and access their home directories with read/write permissions. No anonymous uploads are permitted by default.</p>
</div>
<div class="section" id="ftp-documentation">
<h2><a class="toc-backref" href="#id223">FTP Documentation</a></h2>
<p>Man Pages:</p>
<blockquote>
<ul class="simple">
<li>vsftpd.conf (5)</li>
<li>ftpd_selinux (8)</li>
</ul>
</blockquote>
</div>
<div class="section" id="investigate-selinux-implications-for-ftp">
<h2><a class="toc-backref" href="#id224">Investigate SELinux implications for FTP</a></h2>
<p>Find SELinux Filesystem contexts that might affect FTP:</p>
<pre class="literal-block">
# semanage fcontext -l | grep &quot;ftp&quot;
</pre>
<p>Find SELinux port contexts that might affect FTP:</p>
<pre class="literal-block">
# semanage port -l | grep &quot;ftp&quot;
</pre>
<p>Find SELinux booleans that might affect FTP:</p>
<pre class="literal-block">
# semanage boolean -l | grep ftp
</pre>
</div>
<div class="section" id="investigate-firewall-implications-for-ftp">
<h2><a class="toc-backref" href="#id225">Investigate Firewall Implications for FTP</a></h2>
<p>Find ports that may need to be opened for FTP:</p>
<pre class="literal-block">
# grep ftp /etc/services
</pre>
</div>
<div class="section" id="configuring-a-secure-drop-box-for-anon-upload">
<h2><a class="toc-backref" href="#id226">Configuring a Secure &quot;Drop-box&quot; for Anon Upload</a></h2>
<ol class="arabic">
<li><p class="first">Create an upload directory owned by <tt class="docutils literal"><span class="pre">root.ftp</span></tt> and with 730 permissions:</p>
<pre class="literal-block">
cd /var/ftp
mkdir incoming
chgrp ftp incoming
chmod 730 incoming
</pre>
</li>
<li><p class="first">Modify SELinux</p>
<blockquote>
<ul>
<li><p class="first">Set context of <tt class="docutils literal"><span class="pre">public_content_rw_t</span></tt> on the upload directory:</p>
<pre class="literal-block">
semanage fcontext -a -t public_content_rw_t '/var/ftp/incoming(/.*)?'
restorecon -rvv /var/ftp/
</pre>
</li>
<li><p class="first">Enable the <tt class="docutils literal"><span class="pre">allow_ftp_anon_write</span></tt> boolean:</p>
<pre class="literal-block">
setsebool -P allow_ftpd_anon_write on
</pre>
</li>
</ul>
</blockquote>
</li>
<li><p class="first">Modify <tt class="docutils literal"><span class="pre">/etc/vsftpd/vsftpd.conf</span></tt> as follows:</p>
<pre class="literal-block">
anonymous_enable=YES
local_enable=NO
write_enable=YES
anon_upload_enable=YES
chown_uploads=YES
chown_username=daemon
anon_umask = 077
</pre>
</li>
<li><p class="first">Modify iptables for inbound ftp</p>
<blockquote>
<ul>
<li><p class="first">in <tt class="docutils literal"><span class="pre">/etc/sysconfig/iptables-config</span></tt>:</p>
<pre class="literal-block">
IPTABLES_MODULES=&quot;nf_conntrack_ftp nf_nat_ftp&quot;
</pre>
</li>
<li><p class="first">Set rules:</p>
<pre class="literal-block">
# iptables -A INPUT -p tcp --dport 21 -j ALLOW
# iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ALLOW
</pre>
</li>
</ul>
</blockquote>
</li>
</ol>
<!-- o FTP -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service -->
<!-- + * Configure anonymous-only download -->
</div>
</div>
<div class="section" id="session-10-nfs-and-samba">
<h1><a class="toc-backref" href="#id227">Session 10 NFS and Samba</a></h1>
<div class="section" id="network-file-system-nfs">
<h2><a class="toc-backref" href="#id228">Network File System (NFS)</a></h2>
<p>Three available versions:</p>
<ul class="simple">
<li>NFS v2 -- Original public NFS.</li>
<li>NFS v3 -- Extensions and enhancements to v2.</li>
<li>NFS v4 -- Complete redesign, Red Hat default, preferred except where backward compatibility is required.</li>
</ul>
</div>
<div class="section" id="packages">
<h2><a class="toc-backref" href="#id229">Packages</a></h2>
<p>Group: nfs-file-server</p>
<p>Packages:</p>
<blockquote>
<p>nfs-utils</p>
<p>nfs4-acl-tools</p>
</blockquote>
</div>
<div class="section" id="configuration">
<h2><a class="toc-backref" href="#id230">Configuration</a></h2>
<p>/etc/sysconfig/nfs</p>
<p>/etc/exports</p>
</div>
<div class="section" id="configuring-an-nfs-server-network-file-system">
<h2><a class="toc-backref" href="#id231">Configuring an NFS server (Network File System)</a></h2>
<p>service nfs start</p>
<p>chkconfig nfs on</p>
</div>
<div class="section" id="etc-exports">
<h2><a class="toc-backref" href="#id232">/etc/exports</a></h2>
<pre class="literal-block">
/home 192.168.0.0/24(rw,root_squash) server1.example.com(rw,no_root_squash)
/pub  *(ro,root_squash)
</pre>
<ul class="simple">
<li>Note: There is no space between the host or subnet and the options defined between the parentheses ().</li>
<li>If you put a space between them, then you will get a global export.</li>
</ul>
</div>
<div class="section" id="commands">
<h2><a class="toc-backref" href="#id233">Commands</a></h2>
<p>exportfs -a</p>
<p>exportfs -r</p>
<p>exportfs -u</p>
<p>showmount -e server</p>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id234">SELinux</a></h2>
</div>
<div class="section" id="mounting">
<h2><a class="toc-backref" href="#id235">Mounting</a></h2>
<p>mount nfsserv:/home /mnt/homes</p>
<!-- o NFS -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service -->
<!-- + * Provide network shares to specific clients -->
<!-- + * Provide network shares suitable for group collaboration -->
<!-- o Samba -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service -->
<!-- + * Provide network shares to specific clients -->
<!-- + * Provide network shares suitable for group collaboration -->
</div>
<div class="section" id="automounter">
<h2><a class="toc-backref" href="#id236">Automounter</a></h2>
<p>Automatically mounts a directory when it is accessed.</p>
<p>Unmounts the directory after a specified idle time.</p>
<p>Autofs service controls this behavior.</p>
<dl class="docutils">
<dt>A master configuration file called.</dt>
<dd>/etc/auto.master</dd>
<dt>Sub configuration files</dt>
<dd>Usually called /etc/auto.*</dd>
</dl>
</div>
<div class="section" id="auto-master">
<h2><a class="toc-backref" href="#id237">Auto.master</a></h2>
<p>Specifies directories to mount under when accessed.</p>
<p>Specifies the auto.* file to use for the directories.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><dl class="first docutils">
<dt>/etc/auto.master</dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">/misc</span></kbd></td>
<td>/etc/auto.misc</td></tr>
<tr><td class="option-group">
<kbd><span class="option">/data</span></kbd></td>
<td>/etc/auto.data</td></tr>
</tbody>
</table>
</dd>
</dl>
<p>When a directory under /misc is accessed, the /etc/auto.misc file indicates how to mount it.</p>
<p class="last">When a directory under /data is accessed, the /etc/auto.data file indicates how to mount it.</p>
</dd>
</dl>
</div>
<div class="section" id="auto">
<h2><a class="toc-backref" href="#id238">Auto.*</a></h2>
<p>Specifies directory name.</p>
<p>Specifies options to use when mounting.</p>
<p>Specifies what to mount.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><dl class="first last docutils">
<dt>/etc/auto.data</dt>
<dd>pictures       -rw,soft,intr    nfs.example.com:/export/pics
mp3s           -ro              /dev/sdd1</dd>
</dl>
</dd>
</dl>
<p>When the /data/pictures directory is accessed, the system will mount the nfs export /export/pics on nfs.example.com.</p>
<p>When the /data/mp3s directory is accessed, the system will mount the local
partition /dev/sdd1.</p>
</div>
<div class="section" id="understanding-automount">
<h2><a class="toc-backref" href="#id239">Understanding Automount</a></h2>
<dl class="docutils">
<dt>You must access the destination directory in order for it to automount.</dt>
<dd><p class="first">If nothing is automounted and you run &quot;ls /data&quot; then you will get no files listed.</p>
<p class="last">If you run &quot;ls /data/mpp3&quot;, you will get a listing.  You can now run &quot;ls /data&quot; and you will see the mp3s directory listed.  At least until the idle timeout is reached.</p>
</dd>
</dl>
<p>Some commands will cause the directory to be mounted when ran but they do not
produce any results.  In this case, you may need to run the command a second
time.</p>
</div>
<div class="section" id="samba">
<h2><a class="toc-backref" href="#id240">Samba</a></h2>
<p>Samba is a project providing software capable of utilizing the SMB (Server Message Block) and CIFS (Common Internet File System) protocols to interoperate with systems using MS-Windows-style file and printer sharing.</p>
<p>Linux systems can use Samba to:</p>
<ul class="simple">
<li>Act as a client to SMB/CIFS servers</li>
<li>Provide file and printer sharing services to clients</li>
<li>Provide domain controller functionality in a limited subset of possible configurations.</li>
</ul>
</div>
<div class="section" id="accessing-smb-cifs-shares">
<h2><a class="toc-backref" href="#id241">Accessing SMB/CIFS Shares</a></h2>
<ul>
<li><p class="first">Graphically, using Nautilus:</p>
<blockquote>
<p>Use <strong>Places | Connect to Server</strong>, choose <tt class="docutils literal"><span class="pre">Windows</span> <span class="pre">share</span></tt> as the <strong>Service Type</strong>  and provide the required credentials.</p>
</blockquote>
</li>
<li><p class="first">Occasional, FTP-like access from the command line:</p>
<pre class="literal-block">
# smbclient //server/share/ -U username -W [domain or workgroup]
</pre>
</li>
<li><p class="first">Through filesystem mounts:</p>
<pre class="literal-block">
# mount -t cifs //server1/tmp /mnt/share -o credentials=/root/credentials
</pre>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">/etc/fstab</span></tt> entry:</p>
<pre class="literal-block">
# //server/share /mnt/point cifs credentials=/root/credentials 0 0
</pre>
</li>
<li><p class="first">Credentials File contents:</p>
<pre class="literal-block">
user=&lt;username&gt;
pass=&lt;password&gt;
domain=&lt;domainname&gt;
</pre>
</li>
</ul>
</div>
<div class="section" id="samba-packages">
<h2><a class="toc-backref" href="#id242">Samba Packages:</a></h2>
<ul class="simple">
<li>samba</li>
<li>samba-client</li>
<li>samba-common</li>
<li>samba-windbind</li>
<li>samba-domainjoin-gui (Optional Repository)</li>
</ul>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id243">SELinux</a></h2>
<p>SELinux notes are at the top of the config file (<tt class="docutils literal"><span class="pre">/etc/samba/smb.conf</span></tt>) and the man page samba_selinux (8).</p>
<p>SELinux Port Settings for Samba:</p>
<pre class="literal-block">
# semanage port -l  |grep smb
smbd_port_t                    tcp      137-139, 445
</pre>
<p>SELinux Booleans for Samba:</p>
<pre class="literal-block">
# semanage boolean -l  |grep &quot;smb\|samba&quot;
</pre>
<p>SELinux fcontexts for Samba:</p>
<pre class="literal-block">
# semanage fcontext -l  |grep &quot;smb\|samba&quot;
</pre>
</div>
<div class="section" id="services">
<h2><a class="toc-backref" href="#id244">Services</a></h2>
<p>service smb start</p>
<p>chkconfig smb on</p>
</div>
<div class="section" id="etc-samba-smb-conf-global">
<h2><a class="toc-backref" href="#id245">/etc/samba/smb.conf (Global)</a></h2>
<dl class="docutils">
<dt>workgroup</dt>
<dd>Specifies a shared Windows Workgroup or Domain name.</dd>
<dt>server string</dt>
<dd>Provides a description of the server.</dd>
<dt>netbios name</dt>
<dd>Specifies a name for the server for in implementations where NetBIOS is still used.</dd>
<dt>Interfaces</dt>
<dd>Used to bind the service only to particular network adapters or IP addresses.</dd>
<dt>Hosts Allow</dt>
<dd>Used for host-based access control.</dd>
</dl>
</div>
<div class="section" id="etc-samba-smb-conf-security-types">
<h2><a class="toc-backref" href="#id246">/etc/samba/smb.conf Security Types</a></h2>
<p>The security line establishes the security model for the server.  This would be one of the following:</p>
<blockquote>
<dl class="docutils">
<dt>user</dt>
<dd>Indicates that user credentials are held on the local server.</dd>
<dt>share</dt>
<dd>Indicates that credentials are not kept globally on an individual basis.  All who report membership in the same workgroup are permitted access to the server and user authentication in configured in the share settings.</dd>
<dt>domain</dt>
<dd>Used when the Samba Server has been added to a Windows NT Domain.  User access is authenticated through a primary or secondary domain controller.</dd>
<dt>server</dt>
<dd>User access is authenticated through a peer server that is not a domain controller.</dd>
<dt>ads</dt>
<dd>User access is authenticated through an Active Directory controller. Kerberos must be installed and configured to authenticate this machine's membership in the Domain.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="samba-users-and-passwords">
<h2><a class="toc-backref" href="#id247">Samba Users and Passwords</a></h2>
<p>When the security model set to <tt class="docutils literal"><span class="pre">user</span></tt>, local Samba users and passwords must be created.  Typically, these accounts use the same user names as those configured on the local system.  <tt class="docutils literal"><span class="pre">smbpasswd</span></tt> is the command used:</p>
<pre class="literal-block">
# smbpasswd -a winuser
</pre>
</div>
<div class="section" id="etc-samba-smb-conf-shares">
<h2><a class="toc-backref" href="#id248">/etc/samba/smb.conf (Shares)</a></h2>
<pre class="literal-block">
[public]
  comment = Public Share
  path = /var/ftp/public
  browsable = yes
  writable = yes
</pre>
<p>Path must have appropriate filesystem permissions.</p>
</div>
<div class="section" id="testing-configuration">
<h2><a class="toc-backref" href="#id249">Testing Configuration</a></h2>
<p>Syntax of the smb.conf file can be tested before restarting the service:</p>
<pre class="literal-block">
# testparm
</pre>
</div>
<div class="section" id="samba-firewalling-considerations">
<h2><a class="toc-backref" href="#id250">Samba Firewalling Considerations</a></h2>
<p>Samba, in its latest version, uses TCP port 445.</p>
<p>For backwards compatibility, UDP ports 137 and 138 and TCP port 139 may also need to be opened in some instances.</p>
</div>
<div class="section" id="howto-enable-home-directory-sharing-via-samba">
<h2><a class="toc-backref" href="#id251">HowTo: Enable Home Directory sharing via Samba</a></h2>
<ol class="arabic simple">
<li>Install the appropriate packages.</li>
<li>Start and enable the service.</li>
<li>Configure the workgroup name in smb.conf.</li>
<li>Create the required Samba users and passwords.</li>
<li>Enable the SELinux boolean permitting home directory access.</li>
<li>Configure the firewall.</li>
<li>Restart the service.</li>
<li>Test from another system.</li>
</ol>
</div>
<div class="section" id="howto-configure-a-group-share">
<h2><a class="toc-backref" href="#id252">HowTo: Configure a Group Share</a></h2>
<ol class="arabic">
<li><p class="first">Create the appropriate group if required.</p>
</li>
<li><p class="first">Create a collaborative directory.</p>
</li>
<li><p class="first">Set the SELinux contexts on the shared directory.</p>
</li>
<li><p class="first">Define the share in smb.conf.</p>
<blockquote>
<p>Set the following values:</p>
<pre class="literal-block">
valid users = &#64;groupname
writeable = yes
</pre>
<!--  -->
<blockquote>
<p>(Ensure that the directory permissions are 2770.)</p>
</blockquote>
<p>or, to allow broader read-only permission:</p>
<pre class="literal-block">
writeable = no
write list = &#64;groupname
</pre>
<!--  -->
<blockquote>
<p>(And relax the directory permissions to 2775.)</p>
</blockquote>
</blockquote>
</li>
<li><p class="first">Restart the service.</p>
</li>
<li><p class="first">Test from another system.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="session-11-dns-and-smtp">
<h1><a class="toc-backref" href="#id253">Session 11 DNS and SMTP</a></h1>
<div class="section" id="types-of-dns-servers">
<h2><a class="toc-backref" href="#id254">Types of DNS servers</a></h2>
<p>Authoritative</p>
<ul class="simple">
<li>Master (primary)</li>
<li>Slave (secondary)</li>
</ul>
<p>Non-authoritative</p>
<ul class="simple">
<li>Caching-only</li>
</ul>
<p>Current RHCE Objectives only require ability to configure a few behaviors of a caching-only name server. The default configuration is now a caching-only nameserver listening only to localhost.</p>
</div>
<div class="section" id="installing-and-enabling-bind">
<h2><a class="toc-backref" href="#id255">Installing and enabling Bind</a></h2>
<pre class="literal-block">
# yum -y install bind

# service named start

# chkconfig named on
</pre>
<!-- o DNS -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service -->
<!-- + * Configure a caching-only name server -->
<!-- + * Configure a caching-only name server to forward DNS queries -->
<!-- + * Note: Candidates are not expected to configure master or slave name servers -->
<!-- o SMTP -->
<!-- + * Install the packages needed to provide the service -->
<!-- + * Configure SELinux to support the service -->
<!-- + * Configure the service to start when the system is booted -->
<!-- + * Configure the service for basic operation -->
<!-- + * Configure host-based and user-based security for the service -->
<!-- + * Configure a mail transfer agent (MTA) to accept inbound email from other systems -->
<!-- + * Configure an MTA to forward (relay) email through a smart host -->
</div>
</div>
<div class="section" id="session-12-finish-uncompleted-topics-review-or-practice-exam">
<h1><a class="toc-backref" href="#id256">Session 12 Finish uncompleted topics, Review, or Practice Exam</a></h1>
</div>
<div class="section" id="supplemental-topics">
<h1><a class="toc-backref" href="#id257">Supplemental Topics</a></h1>
<div class="section" id="manage-processes-and-services-schedule-tasks-using-cron">
<h2><a class="toc-backref" href="#id258">Manage Processes and Services: Schedule tasks using cron</a></h2>
</div>
<div class="section" id="cron">
<h2><a class="toc-backref" href="#id259">Cron</a></h2>
<p>Scheduler</p>
<p>man 5 crontab</p>
<p>anacron</p>
<p>crond</p>
<p>/etc/cron.*</p>
<p>/var/spool/cron</p>
</div>
<div class="section" id="format-of-a-crontab-file">
<h2><a class="toc-backref" href="#id260">Format of a crontab file</a></h2>
<p>variable=value
variable2=value</p>
<p>minute hour dayofmonth month dayofweek  command</p>
<p>example:</p>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">*/5</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">cleanup</span></tt></dt>
<dd>Runs cleanup every 5 minutes</dd>
<dt><tt class="docutils literal"><span class="pre">1</span> <span class="pre">23</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">0</span> <span class="pre">cleanup</span></tt></dt>
<dd>Runs cleanup 11:01 pm every Sunday</dd>
<dt><tt class="docutils literal"><span class="pre">1</span> <span class="pre">23</span> <span class="pre">5</span> <span class="pre">*</span> <span class="pre">0</span> <span class="pre">cleanup</span></tt></dt>
<dd>Runs cleanup at 11:01 on the 5th of each month, but only if it falls on a Sunday.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="controlling-cron">
<h2><a class="toc-backref" href="#id261">Controlling Cron</a></h2>
<p>cron -u username</p>
<p>cron -l</p>
<p>cron -r</p>
<p>cron -e</p>
</div>
<div class="section" id="at-jobs">
<h2><a class="toc-backref" href="#id262">at Jobs</a></h2>
<p>Runs job once at specified time.</p>
<p>Understands now, midnight, noon, teatime, minutes, hours, day, week</p>
<p>Examples:</p>
<pre class="literal-block">
echo &quot;/sbin/init 6&quot; | at now + 10 minutes
</pre>
<p>or</p>
<pre class="literal-block">
at now + 10 minutes
at&gt; /sbin/init 6
at&gt; &lt;CTRL-D&gt;
</pre>
<p>atq</p>
<p>atrm</p>
</div>
<div class="section" id="securing-cron-and-at">
<h2><a class="toc-backref" href="#id263">Securing cron and at</a></h2>
<p>/etc/cron.allow</p>
<p>/etc/cron.deny</p>
<p>/etc/at.allow</p>
<p>/etc/at.deny</p>
</div>
<div class="section" id="user-admin-with-config-files">
<h2><a class="toc-backref" href="#id264">User Admin with Config Files</a></h2>
<dl class="docutils">
<dt>/etc/passwd</dt>
<dd>World-readable file of user information</dd>
<dt>/etc/shadow</dt>
<dd>Restricted-access file with password and expiry info.</dd>
<dt>/etc/group</dt>
<dd>World-readable file of group information</dd>
<dt>/etc/gshadow</dt>
<dd>Restricted-access group password, admin, membership info</dd>
</dl>
<p>If editing directly, <tt class="docutils literal"><span class="pre">vipw</span></tt> and <tt class="docutils literal"><span class="pre">vigr</span></tt> should be used.</p>
</div>
<div class="section" id="structure-of-etc-passwd">
<h2><a class="toc-backref" href="#id265">Structure of /etc/passwd</a></h2>
<p><tt class="docutils literal"><span class="pre">Name:Password:UID:GID:Comments:Homedir:Shell</span></tt></p>
<p>Sample Contents
________________________________________________-</p>
<pre class="literal-block">
$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
ntp:x:38:38::/etc/ntp:/sbin/nologin
gdm:x:42:42::/var/gdm:/sbin/nologin
scott:x:500:500:Scott Purcell:/home/scott:/bin/bash
</pre>
</div>
<div class="section" id="structure-of-etc-shadow">
<h2><a class="toc-backref" href="#id266">Structure of /etc/shadow</a></h2>
<p><tt class="docutils literal"><span class="pre">Name:Password:Lstchg:May:Must:Warn:Disable:Expire</span></tt></p>
<div class="section" id="sample-contents">
<h3><a class="toc-backref" href="#id267">Sample Contents</a></h3>
<pre class="literal-block">
# cat /etc/shadow
root:$1$IyApEyOS$dZ5SMuC7Yw9/PDMyWi1H11:14373:0:99999:7:::
sshd:!!:14373:0:99999:7:::
ntp:!!:14373:0:99999:7:::
gdm:!!:14373:0:99999:7:::
scott:$1${...}:14374:0:99999:7:::
bob:$1${...}:14398:7:30:7:7:14457:
</pre>
</div>
</div>
<div class="section" id="structure-of-etc-group">
<h2><a class="toc-backref" href="#id268">Structure of /etc/group</a></h2>
<p><tt class="docutils literal"><span class="pre">Name:Password:GID:Users</span></tt></p>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id269">Sample Contents</a></h3>
<pre class="literal-block">
# cat /etc/group
root:x:0:root
scott:x:500:
bob:x:501:
mary:x:502:
sales:x:503:bob,mary
training:x:504:scott
</pre>
</div>
</div>
<div class="section" id="structure-of-etc-gshadow">
<h2><a class="toc-backref" href="#id270">Structure of /etc/gshadow</a></h2>
<p><tt class="docutils literal"><span class="pre">Name:Password:Admins:Members</span></tt></p>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id271">Sample Contents</a></h3>
<pre class="literal-block">
# cat /etc/gshadow
root:::root
scott:!!::
bob:!::
mary:!::
sales:!::bob,mary
training:!::scott
</pre>
</div>
</div>
<div class="section" id="user-admin-with-cli-tools">
<h2><a class="toc-backref" href="#id272">User Admin with CLI tools</a></h2>
<dl class="docutils">
<dt>useradd, usermod, userdel</dt>
<dd>Create, delete, and modify user accounts</dd>
<dt>groupadd, groupmod, groupdel</dt>
<dd>Create, delete, and modify group accounts</dd>
<dt>chage</dt>
<dd>Modify password aging and expiration</dd>
</dl>
</div>
<div class="section" id="user-admin-with-gui-tools">
<h2><a class="toc-backref" href="#id273">User Admin with GUI tools</a></h2>
<p>The GUI tool for managing users and groups is the Red Hat User Manager. It can be launched from the menu at <strong>System | Administration | Users and Groups</strong> or from the CLI as <tt class="docutils literal"><span class="pre">system-config-users</span></tt>.</p>
<blockquote>
<img alt="images/UserMgr.png" src="images/UserMgr.png" style="width: 80%;" />
</blockquote>
</div>
<div class="section" id="user-environment">
<h2><a class="toc-backref" href="#id274">User environment</a></h2>
<dl class="docutils">
<dt>Home directories</dt>
<dd>/home/{user}/ or /root/</dd>
<dt>/etc/skel</dt>
<dd>Contents copied to home directory of each new user.</dd>
</dl>
<div class="section" id="common-contents">
<h3><a class="toc-backref" href="#id275">Common Contents:</a></h3>
<blockquote>
<p>.bashrc</p>
<p>.bash_logout</p>
<p>.bash_profile</p>
</blockquote>
</div>
</div>
<div class="section" id="system-wide-shell-config-files">
<h2><a class="toc-backref" href="#id276">System-wide Shell Config Files</a></h2>
<dl class="docutils">
<dt>/etc/profile</dt>
<dd>Executed with each user login. Sets paths, variables, etc. Runs scripts in <tt class="docutils literal"><span class="pre">/etc/profile.d</span></tt>.</dd>
<dt>/etc/profile.d</dt>
<dd>Scripts that extend /etc/profile, usually added by applications.</dd>
<dt>/etc/bashrc</dt>
<dd>System-wide functions and aliases</dd>
</dl>
</div>
<div class="section" id="user-configurable-environment-files">
<h2><a class="toc-backref" href="#id277">User-configurable Environment Files</a></h2>
<dl class="docutils">
<dt>~/.bashrc</dt>
<dd>User aliases and functions</dd>
<dt>~/.bash_profile</dt>
<dd>User paths, variables, and environment settings</dd>
</dl>
</div>
<div class="section" id="cups-printing-system">
<h2><a class="toc-backref" href="#id278">CUPS Printing System</a></h2>
<p>uses IPP</p>
<blockquote>
Do not firewall port 631 udp/tcp from localhost or you will not print even to local printers.</blockquote>
<p>system-config-printer</p>
<blockquote>
Use it. Requires X.</blockquote>
</div>
<div class="section" id="controlling-jobs-from-the-command-line">
<h2><a class="toc-backref" href="#id279">Controlling Jobs from the Command Line</a></h2>
<p>lpr</p>
<blockquote>
send a job to a printer</blockquote>
<p>lpq</p>
<blockquote>
See what is in the print queue.</blockquote>
<p>lprm</p>
<blockquote>
Remove a job from the print queue.</blockquote>
<p>lpc</p>
<blockquote>
Check the status of the queues. &quot;lpc status&quot;</blockquote>
</div>
<div class="section" id="cups-web-based-interface">
<h2><a class="toc-backref" href="#id280">CUPS Web-Based Interface</a></h2>
<p><a class="reference external" href="http://localhost:631">http://localhost:631</a></p>
</div>
</div>
<div class="section" id="troubleshooting">
<h1><a class="toc-backref" href="#id281">Troubleshooting</a></h1>
<p>Read the entire error or message and read it carefully.</p>
<blockquote>
<ul class="simple">
<li>Pay attention to what it says.</li>
</ul>
</blockquote>
<p>Look at the logs.</p>
<blockquote>
<ul class="simple">
<li>/var/log/messages</li>
<li>/var/log/secure</li>
</ul>
</blockquote>
<dl class="docutils">
<dt>Look for typos in the command line or configuration file.</dt>
<dd><ul class="first last simple">
<li>A simple missing semicolon (;) or a dot (.) instead of a dash (-) could be the issue.</li>
</ul>
</dd>
</dl>
<p>Break the problem down into smaller parts and troubleshoot them.</p>
<div class="section" id="booting">
<h2><a class="toc-backref" href="#id282">Booting</a></h2>
<p>Think about the boot process and at which point you are failing.</p>
<blockquote>
<ul class="simple">
<li>MBR (GRUB Stage 1)</li>
<li>GRUB Stage 1.5 (Driver to read filesystem)</li>
<li>GRUB Stage 2 (Menu)<ul>
<li>Kernel</li>
<li>initrd (initial ramdisk)</li>
</ul>
</li>
<li>init process<ul>
<li>inittab</li>
</ul>
</li>
<li>rc.sysinit</li>
<li>services</li>
</ul>
</blockquote>
</div>
<div class="section" id="booting-mbr">
<h2><a class="toc-backref" href="#id283">Booting - (MBR)</a></h2>
<p>The MBR boots the system and loads the next GRUB Stage.</p>
<p>If MBR is on a partition, is it marked bootable according to fdisk ?</p>
</div>
<div class="section" id="booting-grub-stage-1-5-driver-to-read-filesystem">
<h2><a class="toc-backref" href="#id284">Booting - GRUB Stage 1.5 (Driver to read filesystem)</a></h2>
<p>If this does not exist or is corrupt, then Stage 2 may not be able to be loaded.</p>
</div>
<div class="section" id="booting-grub-stage-2-menu">
<h2><a class="toc-backref" href="#id285">Booting - GRUB Stage 2 (Menu)</a></h2>
<p>This stage reads the grub.conf and displays the grub menu.</p>
<p>Tells GRUB where and which kernel and initial ramdisk to load.</p>
<p>Passes extra boot optons to the kernel.</p>
<p>root (hd0,0) indicates the files from /boot are located on the first partition of the first drive.</p>
<blockquote>
<ul class="simple">
<li>The kernel and initial ramdisk are loaded from this partition.</li>
<li>The paths should begin / and not /boot.</li>
</ul>
</blockquote>
</div>
<div class="section" id="booting-kernel">
<h2><a class="toc-backref" href="#id286">Booting - Kernel</a></h2>
<p>Be careful to not create a typo when specifying the kernel.</p>
<blockquote>
<ul class="simple">
<li>A common typo is a dash instead of a period.</li>
<li>Make sure the &quot;root=&quot; specifies the correct locatation of the device containing root (/).</li>
</ul>
</blockquote>
</div>
<div class="section" id="booting-initrd-initial-ramdisk">
<h2><a class="toc-backref" href="#id287">Booting - initrd (initial ramdisk)</a></h2>
<p>Be careful to not create a typo when specifying the kernel.</p>
<blockquote>
<ul class="simple">
<li>A common typo is a dash instead of a period.</li>
</ul>
</blockquote>
<p>The initial ramdisk NEEDS ALL DRIVERS needed for loading the filesystem.</p>
<blockquote>
<ul class="simple">
<li>That means storage drivers must be in it.</li>
<li>That means network drivers must be in it for booting across the network.</li>
</ul>
</blockquote>
</div>
<div class="section" id="booting-init-process">
<h2><a class="toc-backref" href="#id288">Booting - init process</a></h2>
<p>/sbin/init needs to exist and be executable.</p>
<p>Its the parent of all processes.</p>
</div>
<div class="section" id="booting-inittab">
<h2><a class="toc-backref" href="#id289">Booting - inittab</a></h2>
<p>This is inits configuration file.</p>
<p>It calls rc.sysinit.</p>
<p>It runs services for the appropriate run levels.</p>
<p>This is a very important and very easy file to corrupt.</p>
<p>If you get &quot;Process spawning too rapidly&quot; during boot, check this file or check to see if the commands it calls are there.</p>
</div>
<div class="section" id="booting-rc-sysinit">
<h2><a class="toc-backref" href="#id290">Booting - rc.sysinit</a></h2>
<p>Sets hostname</p>
<p>Runs filesystem checks if needed</p>
<p>Mounts file systems in fstab</p>
<p>remounts / as read/write</p>
</div>
<div class="section" id="booting-services">
<h2><a class="toc-backref" href="#id291">Booting - services</a></h2>
<p>Maybe the boot issue is caused by a service.</p>
<p>Boot into run level 1 and see if it boots.</p>
<blockquote>
<ul class="simple">
<li>Run level 1 runs rc.sysinit and a couple of services.</li>
</ul>
</blockquote>
<p>Boot into runlevel S.</p>
<blockquote>
<ul class="simple">
<li>Run level S does not start any services and does not run rc.sysinit.</li>
</ul>
</blockquote>
</div>
<div class="section" id="networking">
<h2><a class="toc-backref" href="#id292">Networking</a></h2>
<p>/etc/resolv.conf</p>
<blockquote>
<ul class="simple">
<li>dns resolution</li>
</ul>
</blockquote>
<p>/etc/nsswitch</p>
<p>/etc/sysconfig/network</p>
<p>/etc/sysconfig/network-scripts/ifcfg-eth*</p>
</div>
<div class="section" id="x">
<h2><a class="toc-backref" href="#id293">X</a></h2>
<p>system-config-display --reconfig --noui</p>
</div>
<div class="section" id="tcp-wrappers">
<h2><a class="toc-backref" href="#id294">TCP_Wrappers</a></h2>
<p>tcp_wrappers is an easy-to-configure security mechanism that protects some (but not all!) services using the hosts access files, /etc/hosts.allow and /etc/hosts.deny.</p>
<ul class="simple">
<li>hosts.allow is processed first, then hosts.deny.</li>
<li>Each file is read from top down and the first matching rule is applied -- all subsequent rules are ignored.</li>
<li>If no matching rule is found, <strong>access is granted!</strong></li>
<li>Changes take immediate effect -- no services need restarting.</li>
</ul>
<!-- each can contain both allow and deny statements - - RedHat recommends use one or the other, not both. -->
<!-- specific first, then general -->
<!-- "deny all all" as last rule. -->
</div>
<div class="section" id="which-services-are-protected">
<h2><a class="toc-backref" href="#id295">Which Services are Protected?</a></h2>
<ul>
<li><p class="first"><strong>ALL</strong> services managed by xinetd</p>
<blockquote>
<ul class="simple">
<li>telnetd</li>
<li>tftpd</li>
</ul>
</blockquote>
</li>
<li><p class="first">Other services compiled against the libwrap.a library</p>
<blockquote>
<ul class="simple">
<li>sshd</li>
<li>sendmail</li>
<li>vsftpd</li>
</ul>
</blockquote>
</li>
<li><p class="first">Notably <strong>NOT</strong> included: httpd</p>
</li>
</ul>
</div>
<div class="section" id="indentifying-protected-services">
<h2><a class="toc-backref" href="#id296">Indentifying Protected Services</a></h2>
<ul>
<li><p class="first">Identify the binary used by the service in question:</p>
<pre class="literal-block">
# which sendmail
/usr/sbin/sendmail
</pre>
</li>
<li><p class="first">Run <tt class="docutils literal"><span class="pre">ldd</span></tt> and <tt class="docutils literal"><span class="pre">strings</span></tt> against the binary and examine the output for &quot;libwrap&quot;:</p>
<pre class="literal-block">
# strings `which sendmail` |grep libwrap
# ldd `which sendmail` |grep libwrap
libwrap.so.0 =&gt; /lib64/libwrap.so.0 ...
</pre>
</li>
<li><p class="first">Nul output confirms the service does NOT use tcp_wrappers:</p>
<pre class="literal-block">
# ldd `which httpd` |grep libwrap
#
</pre>
</li>
</ul>
</div>
<div class="section" id="hosts-access-files-syntax">
<h2><a class="toc-backref" href="#id297">Hosts Access Files Syntax</a></h2>
<p>Basic format:  <tt class="docutils literal"><span class="pre">&lt;daemon</span> <span class="pre">list&gt;:</span> <span class="pre">&lt;client</span> <span class="pre">list&gt;</span> <span class="pre">[:</span> <span class="pre">&lt;option&gt;:</span> <span class="pre">&lt;option&gt;:</span> <span class="pre">...]</span></tt></p>
<ul>
<li><p class="first">Lists are comma-separated.</p>
</li>
<li><p class="first">The daemon list uses process names -- not always the same as the name of the service or daemon.  Wild cards and operators are available.</p>
</li>
<li><p class="first">The client list is hostnames, IP addresses, patterns or wildcards</p>
</li>
<li><p class="first">More details in <tt class="docutils literal"><span class="pre">man</span> <span class="pre">hosts_options</span></tt></p>
<blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Info:</th><td class="field-body">See &lt;<a class="reference external" href="https://github.com/texastwister/OpenRHCE">https://github.com/texastwister/OpenRHCE</a>&gt; for the latest version of this doc.</td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Scott Purcell &lt;<a class="reference external" href="mailto:scott&#64;texastwister.info">scott&#64;texastwister.info</a>&gt;</td>
</tr>
<tr class="field"><th class="field-name">Date:</th><td class="field-body">Wednesday, May 18, 2011</td>
</tr>
</tbody>
</table>
</blockquote>
</li>
</ul>
</div>
</div>
</div>
<div class="footer">
<hr class="footer" />
Copyright © 2011, Scott Purcell, CC BY-NC-SA 3.0
</div>
</body>
</html>
